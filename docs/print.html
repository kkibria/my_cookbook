<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>My Development Cookbook</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">My Development Cookbook</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="a-few-words"><a class="header" href="#a-few-words">A Few Words</a></h1>
<p>This <em>Software Development Cookbook</em> is mostly a collection of notes I took from
my own experience
and many others that I collected over the years and still collecting.</p>
<p>This is disorganized and work in progress. Many things are probably outdated
and need update. Someday I will find time and energy to
clean this up and this may yield into one or more
of finished books, who knows?</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="project-in-github-or-gitlab"><a class="header" href="#project-in-github-or-gitlab">Project in github or gitlab</a></h1>
<h2 id="github"><a class="header" href="#github">github</a></h2>
<p>Create a new repository.</p>
<p>Create a new folder <code>prj_dir</code> and <code>README.md</code> file,</p>
<pre><code class="language-bash">cd prj_dir
git init
git add .
git commit -m "first commit"
git remote add origin https://github.com/USERNAME/REPOSITORY.git
git push -u origin master
</code></pre>
<p>Push an existing folder maintained with git,</p>
<pre><code class="language-bash">git remote add origin https://github.com/USERNAME/REPOSITORY.git
git push -u origin master
</code></pre>
<blockquote>
<p>Note: vscode now provides gui interface to create a repository in github directly
from a local repo with push of a button.</p>
</blockquote>
<h2 id="gitlab"><a class="header" href="#gitlab">gitlab</a></h2>
<p>Create a local project directory. In this example we will use <code>prj_dir` as the directory name. Now populate the </code>prj_dir`` with all the files and folders that will be used for initial commit.</p>
<pre><code class="language-bash">cd prj_dir
git init
git add .
git commit -m "initial commit"
git push --set-upstream https://gitlab.com/USERNAME/REPOSITORY.git master
git remote add origin https://gitlab.com/USERNAME/REPOSITORY.git
git pull
</code></pre>
<p>I created a convenience npm module that will execute the above commands without typing them individually. You can clone from <a href="https://gitlab.com/kkibria/gitlab.git">https://gitlab.com/kkibria/gitlab.git</a>, build the npm module and install.</p>
<h2 id="changing-a-remotes-url"><a class="header" href="#changing-a-remotes-url">Changing a remote's URL</a></h2>
<p>The <code>git remote set-url</code> command changes an existing remote repository URL.</p>
<pre><code class="language-bash">$ git remote -v
&gt; origin  https://github.com/USERNAME/REPOSITORY1.git (fetch)
&gt; origin  https://github.com/USERNAME/REPOSITORY1.git (push)
# Change remote's URL,
$ git remote set-url origin https://github.com/USERNAME/REPOSITORY2.git
# Verify
$ git remote -v
&gt; origin  https://github.com/USERNAME/REPOSITORY2.git (fetch)
&gt; origin  https://github.com/USERNAME/REPOSITORY2.git (push)
</code></pre>
<h2 id="setting-up-your-own-git-server"><a class="header" href="#setting-up-your-own-git-server">Setting up your own git server</a></h2>
<ul>
<li><a href="https://medium.com/@kevalpatel2106/create-your-own-git-server-using-raspberry-pi-and-gitlab-f64475901a66">https://medium.com/@kevalpatel2106/create-your-own-git-server-using-raspberry-pi-and-gitlab-f64475901a66</a></li>
<li><a href="https://about.gitlab.com/install/#raspberry-pi-os">Install self-managed GitLab</a>. They have a version for raspberry pi.</li>
</ul>
<h2 id="git-workflow"><a class="header" href="#git-workflow">Git Workflow</a></h2>
<ul>
<li><a href="https://musescore.org/en/handbook/developers-handbook/finding-your-way-around/git-workflow">https://musescore.org/en/handbook/developers-handbook/finding-your-way-around/git-workflow</a>.
Describes git workflow for their project,
but a great page to consider for any project using git.</li>
</ul>
<h2 id="remove-tags"><a class="header" href="#remove-tags">Remove tags</a></h2>
<p>little python script will create a powershell command,</p>
<pre><code class="language-python">import subprocess
import re

proc = subprocess.Popen('git tag', stdout=subprocess.PIPE)
tags = proc.stdout.read().decode("utf-8").split()

file1 = open("tagremove.ps1","w")
for tag in tags:
    found = re.match(r"^v\d+", tag)
    if found:
        continue
    file1.write("git tag -d {tag}\ngit push --delete origin {tag}\n".format(tag=tag))
file1.close()
</code></pre>
<h2 id="autogenerate-binaries-using-github-action"><a class="header" href="#autogenerate-binaries-using-github-action">Autogenerate binaries using github action</a></h2>
<p>Github action yaml file that builds binary on a tag push.</p>
<pre><code class="language-yaml"># This workflow will install Python dependencies, run tests and lint with a single version of Python
# For more information see: https://help.github.com/actions/language-and-framework-guides/using-python-with-github-actions

name: Binary release

on:
  push:
    tags:
      - 'v*' # Push events to matching v*, i.e. v1.0, v20.15.10

jobs:
  build-windows:
    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v2
    - name: Set up Python 3.9
      uses: actions/setup-python@v2
      with:
        python-version: 3.9
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install wxPython
        pip install pyinstaller

    - name: build executable
      run: |
        pyinstaller -F --add-data "./source/datafile.txt;." "./source/myapp.py"

    - uses: actions/upload-artifact@v2
      with:
        name: myapp-windows
        path: dist/

  build-macos:
    runs-on: macos-latest

    steps:
    - uses: actions/checkout@v2
    - name: Set up Python 3.9
      uses: actions/setup-python@v2
      with:
        python-version: 3.9
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install wxPython
        pip install pyinstaller

    - name: build executable
      run: |
        pyinstaller -F --add-data "./source/datafile.txt:." "./source/myapp.py"

    - uses: actions/upload-artifact@v2
      with:
        name: myapp-macos
        path: dist/

  build-ubuntu:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Set up Python 3.9
      uses: actions/setup-python@v2
      with:
        python-version: 3.9
    - name: Install dependencies
      run: |
        sudo apt-get install build-essential libgtk-3-dev
        URL=https://extras.wxpython.org/wxPython4/extras/linux/gtk3/ubuntu-20.04
        python -m pip install --upgrade pip
        pip install -U -f $URL wxPython
        pip install pyinstaller

    - name: build executable
      run: |
        pyinstaller -F --add-data "./source/datafile.txt:." "./source/myapp.py"

    - uses: actions/upload-artifact@v2
      with:
        name: myapp-ubuntu
        path: dist/
        
  create-release:
    needs: [build-windows, build-macos, build-ubuntu]
    runs-on: windows-latest

    steps:
    - name: Create Release
      id: create_release
      uses: actions/create-release@v1
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        tag_name: ${{ github.ref }}
        release_name: Release ${{ github.ref }}
        draft: false
        prerelease: false

    - name: get windows artifact
      uses: actions/download-artifact@v2
      with:
        name: myapp-windows
        path: windows/

    - uses: papeloto/action-zip@v1
      with:
        files: windows/
        dest: myapp-windows-exe.zip

    - name: Upload Windows Asset
      uses: actions/upload-release-asset@v1
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }} # This pulls from the CREATE RELEASE step above, referencing it's ID to get its outputs object, which include a `upload_url`. See this blog post for more info: https://jasonet.co/posts/new-features-of-github-actions/#passing-data-to-future-steps 
        asset_path: ./myapp-windows-exe.zip
        asset_name: windows-exe.zip
        asset_content_type: application/zip

    - name: get macos artifact
      uses: actions/download-artifact@v2
      with:
        name: myapp-macos
        path: macos/

    - uses: papeloto/action-zip@v1
      with:
        files: macos/
        dest: myapp-macos-exe.zip

    - name: Upload macos Asset
      uses: actions/upload-release-asset@v1
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }} 
        asset_path: ./myapp-macos-exe.zip
        asset_name: macos-exe.zip
        asset_content_type: application/zip

    - name: get ubuntu artifact
      uses: actions/download-artifact@v2
      with:
        name: myapp-ubuntu
        path: ubuntu/

    - uses: papeloto/action-zip@v1
      with:
        files: ubuntu/
        dest: myapp-ubuntu-exe.zip

    - name: Upload ubuntu Asset
      uses: actions/upload-release-asset@v1
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }} 
        asset_path: ./myapp-ubuntu-exe.zip
        asset_name: ubuntu-exe.zip
        asset_content_type: application/zip
</code></pre>
<h2 id="remove-all-local-and-remote-tags"><a class="header" href="#remove-all-local-and-remote-tags">Remove all local and remote tags</a></h2>
<pre><code># Clear All local tags
git tag -d $(git tag -l)

# Fetch remote All tags
git fetch

# Delete All remote tags
git push origin --delete $(git tag -l)

# Clear All local tags again
git tag -d $(git tag -l)
</code></pre>
<h2 id="create-and-push-a-specific-tag"><a class="header" href="#create-and-push-a-specific-tag">create and push a specific tag</a></h2>
<pre><code># create a tag
git tag test123

# list all local tags
git tag -l     

# push a specific tag to remote named 'origin'
git push origin tag test123
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="using-vscode"><a class="header" href="#using-vscode">Using vscode</a></h1>
<h2 id="install-vscode-in-ubuntu"><a class="header" href="#install-vscode-in-ubuntu">Install vscode in ubuntu</a></h2>
<p>First, update the packages index and install the dependencies by typing:</p>
<pre><code class="language-bash">sudo apt update
sudo apt install software-properties-common apt-transport-https wget git
</code></pre>
<p>Next, import the Microsoft GPG key using the following wget command:</p>
<pre><code class="language-bash">wget -q https://packages.microsoft.com/keys/microsoft.asc -O- | sudo apt-key add -
</code></pre>
<p>And enable the Visual Studio Code repository by typing:</p>
<pre><code class="language-bash">sudo add-apt-repository "deb [arch=amd64] https://packages.microsoft.com/repos/vscode stable main"
</code></pre>
<p>Once the apt repository is enabled, install the latest version of Visual Studio Code with:</p>
<pre><code class="language-bash">sudo apt update
sudo apt install code
</code></pre>
<p>Visual Studio Code has been installed on your Ubuntu desktop and you can start using it. Next, ubuntu specific Setup credential cache so that you don't have to keep typing origin usercode and password.</p>
<pre><code class="language-bash">git config --global credential.helper store
</code></pre>
<h2 id="cpp-setup"><a class="header" href="#cpp-setup">cpp setup</a></h2>
<ul>
<li><a href="https://github.com/Microsoft/vscode-cpptools/blob/master/Documentation/LanguageServer/MinGW.md">https://github.com/Microsoft/vscode-cpptools/blob/master/Documentation/LanguageServer/MinGW.md</a></li>
<li><a href="https://youtu.be/dSGW-DLMnUc">https://youtu.be/dSGW-DLMnUc</a></li>
</ul>
<p>To get include path
gcc -v -E -x c++ -</p>
<p>Debugging
g++ -ggdb <files></p>
<p>To strip debugging symbol use -s option at release build.
g++ -ggdb -s <files></p>
<p>Vscode requires xterm, so install, sudo apt install xterm</p>
<h2 id="powershell-setup"><a class="header" href="#powershell-setup">Powershell setup</a></h2>
<p>When powershell starts, it looks for startup script using the path
stored in the <code>$profile</code> variable.</p>
<p>You can view and edit this file by typing <code>code $profile</code> in the powershell.
Probably simplest strategy here is to look for a script in the project root
folder called <code>.psrc.ps1</code> and if it exists, execute the script.</p>
<p>Add the following to the opened startup script,</p>
<pre><code class="language-bash">$rc = ".psrc.ps1"
if (Test-Path -Path $rc -PathType Leaf) {
    &amp; $rc
}
</code></pre>
<p>This way you can put project specific startup commands in <code>.psrc.ps1</code>.
One common usage of this is would be to add or modify path variable.</p>
<pre><code class="language-bash">$env:Path = "SomeRandomPath";             (replaces existing path) 
$env:Path += ";SomeRandomPath"            (appends to existing path)
</code></pre>
<h2 id="hard-wrap-for-editing-comments"><a class="header" href="#hard-wrap-for-editing-comments">Hard wrap for editing comments</a></h2>
<p>Check <a href="topics/text-content.html#vs-code-to-edit-markdown-files">VS code to edit markdown
files</a> section to edit comments
in your source files.</p>
<h2 id="using-jupyter-notebook-in-vscode"><a class="header" href="#using-jupyter-notebook-in-vscode">Using jupyter notebook in vscode</a></h2>
<p>Check <a href="topics/jupyter.html#connect-a-vscode-notebook-as-client">Connect a vscode notebook as client</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="windows-msi-installer"><a class="header" href="#windows-msi-installer">Windows MSI installer</a></h1>
<ul>
<li><a href="https://docs.microsoft.com/en-us/windows/win32/msi/windows-installer-examples">https://docs.microsoft.com/en-us/windows/win32/msi/windows-installer-examples</a></li>
<li><a href="https://willpittman.net:8080/index.php?title=Msi">https://willpittman.net:8080/index.php?title=Msi</a></li>
<li><a href="https://willpittman.net:8080/index.php?title=Python_msilib_basics">https://willpittman.net:8080/index.php?title=Python_msilib_basics</a></li>
</ul>
<h2 id="wix-tutorial"><a class="header" href="#wix-tutorial">wix tutorial</a></h2>
<p>The wix tutorial explains lot of core concepts about msi. A good reading material.</p>
<ul>
<li><a href="https://www.firegiant.com/wix/tutorial/">https://www.firegiant.com/wix/tutorial/</a></li>
<li><a href="https://weblogs.sqlteam.com/mladenp/tags/wix-windows-installer-xml-toolset/">https://weblogs.sqlteam.com/mladenp/tags/wix-windows-installer-xml-toolset/</a></li>
<li><a href="https://youtu.be/usOh3NQO9Ms">https://youtu.be/usOh3NQO9Ms</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="jupyter-notebook"><a class="header" href="#jupyter-notebook">Jupyter Notebook</a></h1>
<h2 id="running-jupyter-ipykernel-locally"><a class="header" href="#running-jupyter-ipykernel-locally">Running jupyter ipykernel locally</a></h2>
<p>Create or open a new terminal for the project. Activate the
virtual environment.</p>
<h3 id="get-the-jupyter-installed"><a class="header" href="#get-the-jupyter-installed">Get the jupyter installed</a></h3>
<p>Install if you haven't already in your virtual environment.</p>
<pre><code>pip install jupyter notebook
</code></pre>
<h3 id="start-the-server"><a class="header" href="#start-the-server">Start the server</a></h3>
<pre><code>python -m jupyter notebook --no-browser
</code></pre>
<p>This will start the server. It will print the url of the
server with a random token, usually looks something like,</p>
<pre><code>http://localhost:8888/tree?token=25e02d584db26b33f9171302057b32e19f6b32e6227b48d7
</code></pre>
<p>Copy the url.</p>
<h3 id="connect-a-vscode-notebook-as-client"><a class="header" href="#connect-a-vscode-notebook-as-client">Connect a vscode notebook as client</a></h3>
<p>There is many benefits using vscode as a client. Editing
source with intellisense is always beneficial. Follow the
steps for vscode to connect to the server.</p>
<ol>
<li>Open the <code>.ipynb</code> file. This will ask you to select a
kernel. Select an <code>existing kernel</code>.</li>
<li>It will ask for url, type url you copied, hit enter.</li>
<li>Type a display name so that you can identify later,
project name is a good idea, hit enter.</li>
</ol>
<p>It will connect and now you can use it. For other <code>.ipynb</code>
files in the same project you can select the same display
name.</p>
<h3 id="debug-mode"><a class="header" href="#debug-mode">Debug mode</a></h3>
<p>To run in debug mode,</p>
<pre><code>python -m jupyter notebook --debug --no-browser
</code></pre>
<p>This will produce lot of messages to diagnose problems.</p>
<h2 id="custom-visualization"><a class="header" href="#custom-visualization">Custom visualization</a></h2>
<ul>
<li><a href="https://www.stefaanlippens.net/jupyter-custom-d3-visualization.html">https://www.stefaanlippens.net/jupyter-custom-d3-visualization.html</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="frontend-code-development"><a class="header" href="#frontend-code-development">Frontend code development</a></h1>
<h2 id="code-editing-sandboxes"><a class="header" href="#code-editing-sandboxes">Code editing sandboxes</a></h2>
<ul>
<li><a href="https://codesandbox.io/">https://codesandbox.io/</a>.</li>
<li><a href="https://codepen.io/">https://codepen.io/</a>.</li>
<li><a href="https://jsfiddle.net/">https://jsfiddle.net/</a>.</li>
<li><a href="https://replit.com/">https://replit.com/</a></li>
<li>A review of sandboxes: <a href="https://geekflare.com/online-code-editors/">9 Best Online Code Editors for Web Applications</a>.</li>
</ul>
<h2 id="css-framework"><a class="header" href="#css-framework">CSS framework</a></h2>
<ul>
<li><a href="https://tailwind.run/">Tailwind</a> uses a concept of utility functions as
a building block of css style.</li>
<li><a href="https://css-tricks.com/fun-viewport-units/">Fun with Viewport Units</a>.</li>
</ul>
<h2 id="css-articles"><a class="header" href="#css-articles">CSS Articles</a></h2>
<ul>
<li><a href="https://css-tricks.com/complete-guide-to-css-functions/">A Complete Guide to CSS Functions</a>.</li>
<li><a href="https://dev.to/ziizium/the-beauty-of-css-3fle">The Beauty of CSS</a>.</li>
<li><a href="https://css-tricks.com/absolute-relative-fixed-positioining-how-do-they-differ/">Absolute, Relative, Fixed Positioning: How Do They Differ?</a></li>
</ul>
<h2 id="d3js-javascript-svg-and-css-to-create-graphical-widgets-and-animations"><a class="header" href="#d3js-javascript-svg-and-css-to-create-graphical-widgets-and-animations">D3.js: Javascript, SVG and CSS to create graphical widgets and animations</a></h2>
<ul>
<li><a href="https://wattenberger.com/">Amelia Wattenberger</a>'s site has lot of interesting articles about frontend visuals.</li>
<li><a href="https://wattenberger.com/blog/gauge">Creating a Gauge in React</a> by Amelia.</li>
<li><a href="https://d3js.org/">Data-Driven Documents</a> d3js javascript library, Github <a href="https://github.com/d3/d3">source</a>.
Really awesome visual effects can be built using this library.
d3 has bunch of cool features like force simulation, goe projections etc.</li>
<li><a href="https://svelte.dev/repl/8722c32f4e1a44a98e3a3fc8a095b2d7?version=3.5.3">D3 is svelte</a>. I have forked this in my svelte REPL.</li>
<li><a href="https://svelte.dev/repl/01a5774b53e9416584428c025668407b?version=3.15.0">D3 Force Graph - svg</a>. I have forked this in my svelte REPL.</li>
<li><a href="https://stackoverflow.com/questions/21209549/embed-and-refer-to-an-external-svg-via-d3-and-or-javascript">Refer to an external SVG via D3 and/or javascript</a>.</li>
<li><a href="https://stackoverflow.com/questions/12975929/how-to-use-svg-file-for-image-source-in-d3">How to use svg file for image source in D3</a>.</li>
<li><a href="https://github.com/billautomata/svg2d3/">Web application that parses SVG files and returns d3.js code</a>.</li>
</ul>
<h2 id="common-javascript-dom-recipes"><a class="header" href="#common-javascript-dom-recipes">Common Javascript DOM recipes</a></h2>
<ul>
<li><a href="https://htmldom.dev/">How to manage HTML DOM</a>.</li>
</ul>
<h2 id="serve-side-rendering-with-pwa"><a class="header" href="#serve-side-rendering-with-pwa">Serve side rendering with PWA</a></h2>
<ul>
<li><a href="https://michaljanaszek.com/blog/combine-pwa-and-isomorphic-rendering/">How to combine PWA and isomorphic rendering (SSR)?</a>.</li>
<li><a href="https://sunkanqiang.com/how-to-turn-ssr-react-spa-into-pwa/">How To Turn a Server-Side-Rendered React SPA Into a PWA</a></li>
<li><a href="https://simplabs.com/blog/2019/04/05/spas-pwas-and-ssr/">SPAs, PWAs and SSR</a></li>
<li><a href="https://engineering.linkedin.com/blog/2018/07/linkedin-lite--a-server-side-rendered-pwa">LinkedIn Lite: A Server-Side Rendered PWA</a></li>
<li><a href="https://medium.com/dev-channel/building-a-hybrid-rendered-pwa-c9d645baf158">Building a hybrid-rendered PWA</a></li>
</ul>
<h2 id="designing-css"><a class="header" href="#designing-css">designing CSS</a></h2>
<ul>
<li><a href="https://www.youtube.com/playlist?list=PLNYkxOF6rcIDI0QtJvW6vKonTxn6azCsD">Designing in the Browser</a></li>
<li><a href="https://github.com/gka/chroma.js">javascript color library for css manipulation</a></li>
<li><a href="https://1linelayouts.glitch.me/">1-Line Layouts</a>, youtube <a href="https://youtu.be/qm0IfG1GyZU">10 modern layouts in 1 line of CSS</a>.</li>
<li><a href="https://css-tricks.com/snippets/css/a-guide-to-flexbox/">https://css-tricks.com/snippets/css/a-guide-to-flexbox/</a></li>
</ul>
<h2 id="svg"><a class="header" href="#svg">SVG</a></h2>
<ul>
<li><a href="https://css-tricks.com/scale-svg/">How to Scale SVG</a></li>
<li><a href="https://stackoverflow.com/questions/45524875/scale-svg-to-a-fixed-height">Scale SVG to a fixed height</a></li>
</ul>
<h2 id="canvas-arts"><a class="header" href="#canvas-arts">Canvas arts</a></h2>
<ul>
<li><a href="http://www.malinc.se/">http://www.malinc.se/</a></li>
<li><a href="https://www.openprocessing.org/">https://www.openprocessing.org/</a></li>
<li><a href="https://p5js.org/">https://p5js.org/</a></li>
</ul>
<h2 id="polyfills"><a class="header" href="#polyfills">polyfills</a></h2>
<ul>
<li><a href="https://medium.com/hackernoon/polyfills-everything-you-ever-wanted-to-know-or-maybe-a-bit-less-7c8de164e423">Polyfills: everything you ever wanted to know, or maybe a bit less</a></li>
<li><a href="https://philipwalton.com/articles/loading-polyfills-only-when-needed/">Loading Polyfills Only When Needed</a>.</li>
</ul>
<h2 id="asyncawait"><a class="header" href="#asyncawait">async/await</a></h2>
<ul>
<li><a href="https://youtu.be/vn3tm0quoqE">The Async Await Episode I Promised</a>.</li>
</ul>
<h2 id="user-authentication"><a class="header" href="#user-authentication">user authentication</a></h2>
<ul>
<li><a href="https://blog.bitsrc.io/why-using-tokens-and-cookies-together-is-better-for-web-apps-9d205b7c1961">Why Using Tokens and Cookies Together is Better for Web App Security</a>.</li>
</ul>
<h2 id="icons"><a class="header" href="#icons">Icons</a></h2>
<ul>
<li>icons <a href="https://ionicons.com/">https://ionicons.com/</a></li>
<li><a href="https://www.svgrepo.com/">https://www.svgrepo.com/</a></li>
</ul>
<h2 id="dimensions"><a class="header" href="#dimensions">dimensions</a></h2>
<ul>
<li><a href="https://docs.microsoft.com/en-us/previous-versions//hh781509(v=vs.85)#understanding-properties-that-measure-element-dimension-and-location">https://docs.microsoft.com/en-us/previous-versions//hh781509(v=vs.85)#understanding-properties-that-measure-element-dimension-and-location</a></li>
</ul>
<h2 id="user-interface-look-and-feel"><a class="header" href="#user-interface-look-and-feel">User interface look and feel</a></h2>
<ul>
<li><a href="https://developer.apple.com/design/human-interface-guidelines/">https://developer.apple.com/design/human-interface-guidelines/</a></li>
<li><a href="https://material.io/">https://material.io/</a></li>
<li>COlor pallet for designers <a href="https://colorhunt.co/">https://colorhunt.co/</a></li>
<li><a href="https://youtu.be/tClRHOnHveY">https://youtu.be/tClRHOnHveY</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="markdown-editor"><a class="header" href="#markdown-editor">Markdown editor</a></h1>
<p>Markdown renderer and editor in browser in frontend development could be useful
for many applications for <a href="topics/text-content.html">content authoring</a>.</p>
<h2 id="markdown-it-package"><a class="header" href="#markdown-it-package"><code>markdown-it</code> package</a></h2>
<pre><code class="language-bash">#install markdown-it
npm install markdown-it
#install markdown-it addons
npm install markdown-it-abbr markdown-it-container markdown-it-deflist markdown-it-emoji markdown-it-footnote markdown-it-ins markdown-it-mark markdown-it-sub markdown-it-sup
#install highlighter for markdown
npm install highlight.js
</code></pre>
<h3 id="setting-up-for-markdown-editing"><a class="header" href="#setting-up-for-markdown-editing">Setting up for markdown editing</a></h3>
<p>Add a javascript file, for example <code>myjs.js</code> as shown,</p>
<pre><code class="language-javascript">'use strict';

const MarkdownIt = require('markdown-it');
module.exports.mdHtml = new MarkdownIt()
    .use(require('markdown-it-abbr'))
    .use(require('markdown-it-container'), 'warning')
    .use(require('markdown-it-deflist'))
    .use(require('markdown-it-emoji'))
    .use(require('markdown-it-footnote'))
    .use(require('markdown-it-ins'))
    .use(require('markdown-it-mark'))
    .use(require('markdown-it-sub'))
    .use(require('markdown-it-sup'));
</code></pre>
<p>Now we can <a href="topics/jslib">wrap this javascript for browser</a> and use it our html web app.</p>
<p>For instance in Svelte we can do the following,</p>
<pre><code class="language-html">&lt;script&gt;
    import md from "./myjs.js";
  
    let src = 'markdown content';
    $:markdown = md.render(src);
  };
&lt;/script&gt;

&lt;textarea bind:value={source} /&gt;
&lt;div&gt;{markdown}&lt;/div&gt;
</code></pre>
<h3 id="synchronized-scrolling"><a class="header" href="#synchronized-scrolling">Synchronized scrolling</a></h3>
<p>This is a rather interesting subject. This sample
<a href="https://github.com/kkibria/svelte-page-markdown">project</a> I did, implements it
using the scheme used in
<a href="https://github.com/markdown-it/markdown-it/blob/master/support/demo_template/index.js">markdown-it</a>
demo. VS code uses something probably similar, but they have more feature. VS
code <a href="https://github.com/microsoft/vscode">source</a> is worth exploring to learn
more.</p>
<p>Every time the content is updated, the demo injects the line numbers in the
generated content using <code>injectLineNumbers</code>. Next, <code>buildScrollMap</code> builds a
map of line number versus position using a hidden element, <code>sourceLikeDiv</code>.
This map is used by the following scroll handlers,</p>
<ul>
<li><code>syncSrcScroll</code>: handler that monitors generated content
scroll position and synchronizes the markdown source
position.</li>
<li><code>syncResultScroll</code>: handler that monitors markdown
source content scroll position and synchronizes the
generated content position.</li>
</ul>
<h2 id="showdownjs"><a class="header" href="#showdownjs">Showdown.js</a></h2>
<ul>
<li>Github Showdown.js <a href="https://github.com/showdownjs/showdown">source</a>.</li>
<li>Code highlighting (showdown highlight js
extension)[https://stackoverflow.com/questions/21785658/showdown-highlightjs-extension]</li>
<li>Github Showdown highlighter
<a href="https://github.com/Bloggify/showdown-highlight">source</a>,</li>
<li>Highlight.js, a general purpose highlighter, <a href="https://highlightjs.org/">https://highlightjs.org/</a>,
Github <a href="https://github.com/highlightjs/highlight.js">source</a>.</li>
<li>Check showdown extensions,
<a href="https://github.com/showdownjs/extension-boilerplate">Github</a>. To develop a
new extension take a look at their
<a href="https://github.com/showdownjs/extension-boilerplate">template</a> at github.
There are other extensions, google it.</li>
<li>Showdown extension writeup,
<a href="https://github.com/showdownjs/ng-showdown/wiki/Creating-an-Extension">https://github.com/showdownjs/ng-showdown/wiki/Creating-an-Extension</a>.</li>
</ul>
<h3 id="showdown-use"><a class="header" href="#showdown-use">Showdown use</a></h3>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;

&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;dev_cookbook&lt;/title&gt;
    &lt;script src="https://unpkg.com/showdown/dist/showdown.min.js"&gt;&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;script&gt;
        var div = document.createElement("DIV");
        document.body.appendChild(div);   // Append &lt;button&gt; to &lt;body&gt;
        var converter = new showdown.Converter();
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
            if (this.readyState == 4 &amp;&amp; this.status == 200) {
                div.innerHTML = converter.makeHtml(this.responseText);
            }
        };
        xhttp.open("GET", "README.md", true);
        xhttp.send();
    &lt;/script&gt;
&lt;/body&gt;

&lt;/html&gt;
</code></pre>
<h2 id="using-a-code-editor-for-entering-text"><a class="header" href="#using-a-code-editor-for-entering-text">Using a code editor for entering text</a></h2>
<p>Instead of a text area to enter source, we an use a code editor.</p>
<ul>
<li><a href="https://dillinger.io/">Dillinger</a> is a good example, Github
<a href="https://github.com/joemccann/dillinger">source</a>. It also integrated server
side pdf generation of markdown render.</li>
<li>Dillinger uses <a href="https://ace.c9.io/">Ace</a> code editor, Github
<a href="https://github.com/ajaxorg/ace">source</a>. Ace allows highlighting code.</li>
<li>highlight.js has Markdown syntax highlighting, integrating markdown
highlighting might be a good idea.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="using-flexbox"><a class="header" href="#using-flexbox">Using Flexbox</a></h1>
<blockquote>
<p>This is quite nonsensical, need to rewrite and organize the whole thing.</p>
</blockquote>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_flexible_box_layout/Basic_concepts_of_flexbox">https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_flexible_box_layout/Basic_concepts_of_flexbox</a> describes it quite nicely
just provide enough intro here so that by reading mdn page its easy to understand.</p>
<h2 id="div-with-elements"><a class="header" href="#div-with-elements">Div with elements</a></h2>
<p>Most elements in HTML have either a <code>display</code> of <code>block</code> or <code>inline</code>.
By default
<code>block</code> elements take up the entire width of the screen. This results in
elements being forced to the next line. <code>inline</code> makes them behave like text,
put them in the same line.</p>
<p>When we apply display <code>flex</code> we leave this system behind and enter a new world
where things work differently.</p>
<p>The most important Concept in <code>flexbox</code> are the axes along which items are
positioned the <em>main axis</em> and the <em>cross axis</em>. They control the flow of our
flexbox layout to position your elements you have to keep in mind both of these
axes.</p>
<h2 id="positioning-horizontally"><a class="header" href="#positioning-horizontally">Positioning Horizontally</a></h2>
<p>To position your elements anywhere along the main axis you need the justify
content property this property has three basic values <code>Flex start</code> is at the
start of the main axis this is the default value which is why our boxes are here
at the left side of our screen. <code>Flex end</code> is at the end of the main axis this
will align the boxes on the right side and <code>Center</code> is at the center of the main
axis so you can use these two lines of code display flex and justify content
Center to Center your elements horizontally.</p>
<h2 id="positioning-vertically"><a class="header" href="#positioning-vertically">Positioning Vertically</a></h2>
<p>Now let's see how we can align elements vertically. in this case we need to
consider the cross axis to do this let's increase the size of the flexbox layout
by applying a Min height of 800 pixels in the body now we can see that this
black border is basically the frame of our flexbox layout to Center your
elements on the cross axis we use the Align items property this property can
have the same values as justify content so you have Flex start for top
positioning meaning at the start of the Cross axis X end for bottom positioning
now they are down here and of course Center to put them in the center</p>
<h2 id="how-to-center-a-div"><a class="header" href="#how-to-center-a-div">How to Center a div</a></h2>
<p>how to center a div you just need these three lines of code to Center elements
along the main and cross axis since flexbox is flexible this layout will work
even if we change the size of the layout the boxes will always be in the center
no matter if we change the height and width of the body.</p>
<h2 id="justify-and-align"><a class="header" href="#justify-and-align">Justify and align</a></h2>
<p>justify content and align items can have three additional and more complex
values space between space around and space evenly space between will distribute
the elements from left to right the first and last element will touch the edge
of the layout depending on how big the container is the elements will have a
bigger Gap in between space around Works similarly but here the first and last
element do not touch the edge instead every element gets some space to the left
and right as you can see even when I resize the entire website the spacing
between the elements adjusts automatically but here we run into a slight
inconsistency that the right space of the Box adds up with the left space of the
second box it will result in these spaces being twice as big as the spaces that
we have to the edges if you don't want that you can use space evenly here all
the spaces are the same size and now finally the gaps are perfectly balanced as
all things should be and of course all of these values are completely flexible
they adjust perfectly when the size of the container changes and that's the
whole point of using Flex box theoretically you could achieve the same thing
centering a div and positioning your elements using only margins and padding but
they are just not as flexible as a flexbox layout by the way you can use the
same values on the Align items property as well but in this case it wouldn't
make sense since we only have one row of content the boxes will all just be at
the start of the Cross AIS but it is possible to use these values on the cross
axis as you will learn later once the layouts get more complex for now let's
learn about another interesting flexbox property which is flex direction to
understand it easier let's remove align items and just use justify content Flex
start for now Flex Direction the flex Direction property controls the direction
of the main axis its default value is row which makes the main axis go from left
to right you could also use row reverse to make it go from right to left looking
at the numbers we can see that it starts counting from the right but this
property also changed the way our justifi content value works now as the main
axis goes from right to left the value Flex start is on the right side and flex
end is on the left side you can also make the main axis go from top to bottom by
applying Flex Direction column now the elements are no longer side by side but
instead on top of each other since the direction of the main axis changed the
direction of the Cross ax has changed as well now if you want to Center these
boxes horizontally you no longer use Justified content but instead align items
since justify content aligns the elements on the main axis which goes from top
to bottom it doesn't make sense now to use it we need to use align items Center
to Center them on the cross axis so I hope you understand that it is really
important to remember the flex direction of your layout as this completely
changes the way all the other properties work per default flexbox uses a Flex
Direction row this will align the elements side by side but you're also going to
want to change it to flex Direction column when you want your elements to be
aligned vertically here is a very common use case scenario you want your entire
website to stay the same everything is aligned vertically but you also want to
Center everything horizontally then you would go to the body and apply display
Flex Flex Direction column and and align items Center and with that every
element will automatically be centered horizontally all right let's get back to
Other Flexbox Properties our starting point display Flex there are a few more
simple flexbox properties before it gets complicated the Gap property will
create a gap between our items this property is very simple and you no longer
need to use margins inside a flexbox layout for example let's give our boxes a
gap of 20 pixels and as we can see now every box has a nice little Gap in
between the flex wrap property can make your flexbox layout responsive using
only one line of code you either have wrap or no wrap if you use flex wrap you
will get a responsive layout that will align your items on the next line if we
don't have enough space resizing the window will show how the elements flow to
the next line when necessary if you use flex wrap no wrap that will not happen
and instead the boxes will shrink together using a flex wrap of wrap will make
the elements flow to the next line if we want this layout to be centered using
justify content Center and align item Center we end up with this layout while
the gap between the first line and the second line is so big will become clear
once we have a few more boxes so let's say we have nine boxes in HTML just add a
few boxes and number them properly then the flex box layout will have more line
braks when when we use flx wrap the issue that we are running into is that we no
longer have one main axis and one cross axis but every line has its own Main and
cross axis in this case we have three of them the Align items property will only
control the alignment along each individual cross axis Flex start puts the boxes
at the start of each cross axis Flex end at the end and Center in the center but
now we also need another CSS property to control the alignment of all the lines
together for that we use align content align content has a default value of
space around and this is why the gaps between the lines are so big we can also
apply space between or space evenly to change that and of course we can also use
the basic values Flex start Flex end and Center so the difference between align
content and align items is align items will control the alignment along the
cross axis of every flexbox line individually and align content will control the
alignment of all lines together ultimately the perfectly centered layout in
flexbox is when you Center all three of these properties and wrap the elements
automatically when necessary justify content Center align item Center and align
content Center by the way when we have a layout like this where are horizontal
gaps and vertical gaps then you can actually split the Gap property into two
different properties row Gap and column Gap you can use these to apply different
values for the horizontal and vertical gaps let's say column Gap is 10 pixels
and row Gap is 20 pixels this way we applied different values for the horizontal
and vertical gaps but most likely you will not need that and just use the normal
Gap property to control both at the same time these properties are not so
important on flexbox but they will become interesting when you have more complex
layouts in Grid later in the course by now you should have a good understanding
of alignment and flexbox using these flexbox properties and their different
combinations of values you can create any alignment possibility you want and of
course if you don't know by now you can also use flexbox in every other HTML
element as well it does not have to be the body for example a little thinking
exercise for beginners if we want to Center the numbers inside the boxes which
are currently at the top left corner how would you do that how can you Center
the numbers inside the boxes pause the video and try it out yourself the answer
is pretty straightforward we do the same thing as earlier but now Inside the Box
selector display Flex to enable flexbox justify content center for the main axis
and align item center for the cross AIS and this way we centered the numbers
inside the boxes obviously you can use all the different combinations we talked
about with black star and flex and here as well now let's move on to something
very powerful in flexbox you don't always have to wrap elements in Flex box you
can also resize them responsively so our next goal is this layout where the
boxes grow and drink responsively to do that let's go back to our layout of five
boxes in HTML so remove a few boxes so that we have five boxes again in CSS we
remove any Flex box properties except display flex and gap of 10 pixels this is
as simple as it gets now since we have no flex rep applied the boxes will be
resized automatically if the viewport gets too small this Behavior can be
specified using Flex shrink and interestingly this is something that you apply
on the flex items not on the flex container inside the boxes we can apply a flex
rink of zero for example this will prevent the shrinking of the boxes they can
no longer be resized and will overflow the container this is also the case for
every non-flex box layout when you have the problem of overflowing elements like
this then consider using Flex box to either wrap the elements to with the next
line or enable flexx rink with a value of one to make them shrink automatically
but remember Flex rink of one is the default value you can imagine this property
like a switch that you can turn on and off now when we have Flex rink applied we
can see how the boxes resize automatically currently we are addressing every box
the same way using their class so every box has the same Flex rink value but you
can also use different Flex rink values on each item so in HTML I give the first
box an ID box one I want to style this one differently when I address this box
in CSS I could give this box a flex ring of zero for example and the other ones
still have a flex ring of one this will result in this Behavior every element
rings when necessary except the first one it will stay the same you could use
this intentionally if you don't want specific elements to shrink for example if
you don't want to distort an image or icon then it is pretty useful to disable
Flex ring on that element now Flex rink is pretty FlexGrow useful but actually
what I use way more often is its counterpart Flex grow Flex grow enables
elements to grow meaning to stretch along the main axis its default value is
zero so elements do not grow per default but once you enable it Flex grow one
all the flex items try to fill out the empty space inside their parent element
this means if there's more empty space the elements will be bigger they grow
Flex grow tries to fill out all the available space inside the parent element
and of course you can address specific elements and apply a different grow
behavior let's say for the boxes the flex grow is zero so they cannot grow but
box number one can grow and as you can see we end up with this effect where only
the first element will grow I used this exact behavior when I developed the
to-do application here the to-do text grows as much as possible while the
checkbox the delete button and all the other elements should not be able to grow
this is is a very useful technique to resize specific elements depending on the
screen size so you will use it very often when making a website responsive Flex
grow and flex rink are not only a Boolean that you can turn on and off but they
also work as a multiplier you can assign even higher numbers than one they only
Mak sense if they are compared with each other for example let's give the boxes
a flex grow of one and the first box a flex grow of five now every element has
the ability to grow but the first one does it five times faster this El element
will be bigger than the others but every element can potentially grow so you can
basically apply different grow values to control how much of the empty space
they should fill this does not mean that this box is five times bigger as we can
see per default they are all the same size but only when there's new empty space
to fill out then this element will Reserve five times more of that new space
than the other elements and the same thing can be done for Flex shrink now the
first box shrinks five times faster than the other and of course you can address
every element on its own and apply a different value for Flex grow and flex rank
but I never had a situation where this specific feature was being used since
most times you just want to turn on and off the grow and Shrink ability for the
elements in a balanced way where they all behave the same way this whole system
of flex grow and flex rink becomes even more powerful when you combine it with
minimum and maximum sizes such as minwidth and Max width because then you can
Define where the flex rink and flex grow should stop you can say my boxes should
be able to grow Flex grow of one but they should not become bigger than 300
pixels each Max with 300 pixels now the elements grow grow grow grow grow up to
the point where they reach the maximum size and the same for Flex Shrink Flex
shrink they can shrink but only until they reach a minimum width of let's say
100 pixels this will make them shrink in the browser as expected but once they
reach that size of 100 pixels the elements will overflow and of course
overflowing elements is something that you should avoid but sometimes your
elements should not get any smaller and need a minimum width to solve the
overflowing problem remember that earlier we talked about Flex wrap we can't
combine Flex rink and flex wrap by just using a media query normally we use flex
rink and flex wrap is disabled with no wrap but once the screen size gets too
small and the minwidth causes the element to overflow then we apply a flex wrap
of wrap and the element wraps to the next line and this is a beautiful example
of how easy it can be to make your website responsive you just use flex shrink
and once you don't want it to shrink anymore then you use a flex AlignSelf wrap
a special feature of flexbox that I don't really see that often being used is
the Align self property this property works just as align items but you use it
on the flex items that means let's say we have an align items of flex start and
for some reason we want to isolate the first box and apply something else that
is not Flex start a line self of flex end for example this will position only
the first box at Flex end and everything else stays Flex start of course Center
is also possible so you can use this property to align self one item differently
on the cross axis but unfortunately I have not found a similar flexbox property
for the main axis let's say we have a general Justified content of flex m and we
want the first item to be Flex start it's only logical to assume that the
property justify self works the same for the main axis but unfortunately it
doesn't since justify self is actually a property that you use in CSS grid as
you are going to learn later in the course if you want to achieve the desired
layout where only the first element is on the left side and every other element
is on the right then you would use the old school solution of margin right Auto
this is a very useful technique for navigation bars here you want your company
logo on the left side and everything else on the right side so just use margin
right Auto Summary now we already know a lot about CSS flexbox layouts but
before we dive into grid layouts let's summarize the key takeaways of flexbox
you can position everything anywhere inside a flex container if you consider the
main and cross axis and their properties justify content and align items you can
wrap elements to the next line using Flex wrap of wrap you can also resize
elements using Flex grow and flex rink and apply different values for each
element if that is what you want combining all of that with minimum and maximum
sizes and media queries you can already achieve most layouts that you have in
mind but if you want to create more complex layouts or you just want to simplify
your code then let me introduce CSS grid because there are actually things that
are easier in Grid and work with even fewer lines of code here is a common
situation how to Cent a div an experienced flexbox guy would say just use
display Flex justify content Center and Aline items Center and that's fine but a
grid layout guy would say hold on three lines of code I can do it in two display
grid Place content center now if you want to learn CSS Grid in flexbox in a
practical way by building Advanced projects like this learning page that uses
modern flexbox and grid sections then I strongly recommend that you get our HTML
and CSS complete course using the first link in the video description my name is
Fabian and this was coding to go the channel where you the most relevant coding
Concept in just a few minutes</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="server-side-andor-headless-rendering"><a class="header" href="#server-side-andor-headless-rendering">Server side and/or Headless rendering</a></h1>
<h2 id="rendering-js"><a class="header" href="#rendering-js">Rendering JS</a></h2>
<ul>
<li><a href="https://developers.google.com/web/tools/puppeteer/articles/ssr">https://developers.google.com/web/tools/puppeteer/articles/ssr</a></li>
<li><a href="https://medium.com/swlh/video-export-from-p5-js-sketch-1b9b6287801a">https://medium.com/swlh/video-export-from-p5-js-sketch-1b9b6287801a</a></li>
<li><a href="https://github.com/TrevorSundberg/h264-mp4-encoder">https://github.com/TrevorSundberg/h264-mp4-encoder</a></li>
<li><a href="https://github.com/ffmpegwasm/ffmpeg.wasm">https://github.com/ffmpegwasm/ffmpeg.wasm</a></li>
<li><a href="https://stackoverflow.com/questions/62863547/save-canvas-data-as-mp4-javascript">https://stackoverflow.com/questions/62863547/save-canvas-data-as-mp4-javascript</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="firebase-matters"><a class="header" href="#firebase-matters">Firebase matters</a></h1>
<h2 id="firebase-auth-sample"><a class="header" href="#firebase-auth-sample">Firebase Auth sample</a></h2>
<ul>
<li>YouTube <a href="https://youtu.be/qtJU5T0tF-M">Flutter Web - Firebase Authentication for your web apps</a>.
Github <a href="https://github.com/rajayogan/flutterweb-firebaseauth">link</a> used in this video.</li>
</ul>
<h2 id="firebase-auth-articles"><a class="header" href="#firebase-auth-articles">Firebase Auth articles</a></h2>
<ul>
<li>Cross-Origin Resource Sharing (CORS) article, <a href="https://dzone.com/articles/do-you-really-know-cors">Do you really know CORS?</a>.</li>
<li>Using function api- <a href="https://www.toptal.com/firebase/role-based-firebase-authentication">How to Build a Role-based API with Firebase Authentication</a>, sources in <a href="https://github.com/joaqcid/firebase-user-role-api">github</a>.</li>
<li><a href="https://youtu.be/3hj_r_N0qMs">Controlling Data Access Using Firebase Auth Custom Claims (Firecasts)</a></li>
</ul>
<h2 id="email-link-sign-in"><a class="header" href="#email-link-sign-in">Email link sign in</a></h2>
<ul>
<li>Article <a href="https://medium.com/@huzaifa.ameen229/firebase-email-link-authentication-ac2504068562">Firebase Email Link Authentication</a>.</li>
<li>Article <a href="https://medium.com/mindorks/working-with-firebase-dynamic-links-a581df8fee6f">Working with Firebase Dynamic links</a>.</li>
<li>We have to whitelist dynamic link domain, article <a href="https://stackoverflow.com/questions/51374411/.firebase-says-domain-not-whitelisted-for-a-link-that-is-whitelisted">Firebase says “Domain not whitelisted” for a link that is whitelisted
</a></li>
</ul>
<h2 id="google-sign-in"><a class="header" href="#google-sign-in">Google sign in</a></h2>
<p>Enable the google sign-in in the authentication tab in firebase console for the project. In the enable dialog, expand the web SDK config.
Copy the Web client ID and save setting.  Lets say this value is <code>somerandomstuff.apps.googleusercontent.com</code>. Now copy the client ID value into the <code>web/index.html</code> file in a meta tag.</p>
<pre><code class="language-html">&lt;head&gt;
  ...
  &lt;meta name="google-signin-client_id" content="somerandomstuff.apps.googleusercontent.com" /&gt;
  ...
  &lt;title&gt;my awesome pwa app&lt;/title&gt;
  &lt;link rel="manifest" href="/manifest.json"&gt;
  ...
&lt;/head&gt;
</code></pre>
<h2 id="stack-overflow"><a class="header" href="#stack-overflow">Stack Overflow</a></h2>
<ul>
<li>Google api problem <a href="https://stackoverflow.com/questions/58495985/firebase-403-permission-denied-firebaseerror-installations-requests-are-blo/58496014#58496014">Firebase: 403 PERMISSION_DENIED</a></li>
</ul>
<h2 id="firebase-security-videos"><a class="header" href="#firebase-security-videos">Firebase security videos</a></h2>
<ul>
<li><a href="https://youtu.be/DBKB6r5BFqo">Security Rules</a></li>
<li><a href="https://youtu.be/qLrDWBKTUZo">Firebase Database Rules Tutorial</a></li>
<li>Youtube <a href="https://youtu.be/b7PUm7LmAOw">Firestore Security Rules - How to Hack a Firebase App</a></li>
<li><a href="https://youtu.be/Rx4pVS1vPGY">Firestore Rules Testing with the Emulator - New Feature</a></li>
<li><a href="https://youtu.be/eW5MdE3ZcAw">Security Rules! 🔑 | Get to Know Cloud Firestore #6</a></li>
</ul>
<h2 id="firebase-database-rule-generator"><a class="header" href="#firebase-database-rule-generator">Firebase database rule generator</a></h2>
<ul>
<li><a href="https://github.com/FirebaseExtended/bolt">bolt</a></li>
</ul>
<h2 id="cloud-firestore-rule-generator"><a class="header" href="#cloud-firestore-rule-generator">Cloud Firestore rule generator</a></h2>
<ul>
<li><a href="https://github.com/bijoutrouvaille/fireward">fireward</a></li>
</ul>
<h2 id="firestore"><a class="header" href="#firestore">Firestore</a></h2>
<ul>
<li><a href="https://fireship.io/snippets/firestore-rules-recipes/">Firestore Security Rules Cookbook</a></li>
</ul>
<h3 id="firestore-rules-common-functions"><a class="header" href="#firestore-rules-common-functions">firestore rules common functions</a></h3>
<pre><code class="language-javascript">service cloud.firestore {
  match /databases/{database}/documents {

    function isSignedIn() {
      return request.auth != null;
    }
    function emailVerified() {
      return request.auth.token.email_verified;
    }
    function userExists() {
      return exists(/databases/$(database)/documents/users/$(request.auth.uid));
    }

    // [READ] Data that exists on the Firestore document
    function existingData() {
      return resource.data;
    }
    // [WRITE] Data that is sent to a Firestore document
    function incomingData() {
      return request.resource.data;
    }

    // Does the logged-in user match the requested userId?
    function isUser(userId) {
      return request.auth.uid == userId;
    }

    // Fetch a user from Firestore
    function getUserData() {
      return get(/databases/$(database)/documents/accounts/$(request.auth.uid)).data
    }

    // Fetch a user-specific field from Firestore
    function userEmail(userId) {
      return get(/databases/$(database)/documents/users/$(userId)).data.email;
    }


    // example application for functions
    match /orders/{orderId} {
      allow create: if isSignedIn() &amp;&amp; emailVerified() &amp;&amp; isUser(incomingData().userId);
      allow read, list, update, delete: if isSignedIn() &amp;&amp; isUser(existingData().userId);
    }

  }
}
</code></pre>
<h3 id="firestore-rules-data-validation"><a class="header" href="#firestore-rules-data-validation">firestore rules data validation</a></h3>
<pre><code class="language-javascript">function isValidProduct() {
  return incomingData().price &gt; 10 &amp;&amp; 
         incomingData().name.size() &lt; 50 &amp;&amp;
         incomingData().category in ['widgets', 'things'] &amp;&amp;
         existingData().locked == false &amp;&amp; 
         getUserData().admin == true
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="firestore-matters"><a class="header" href="#firestore-matters">Firestore matters</a></h1>
<h2 id="firestore-security"><a class="header" href="#firestore-security">Firestore security</a></h2>
<p>Cloud firestore is a database for a serverless architecture Firebase uses. Followings are notes I took from watching a google firebase team provided youtube playlist <a href="https://www.youtube.com/playlist?list=PLl-K7zZEsYLluG5MCVEzXAQ7ACZBCuZgZ">Get to know Cloud Firestore</a>.</p>
<h3 id="notes"><a class="header" href="#notes">Notes</a></h3>
<p>Document contains tree structure of information. But document does not contain another document. Maximum size ie 1 meg. Documents can point to a sub-collection.</p>
<pre><code class="language-javascript">document = {
    bird_type: "swallow",
    airspeed: 42733,
    coconut_capacity: 0.62,
    isNative: false,
    icon: &lt;binary data&gt;,
    vector: {
        x: 36.4255, 
        y: 25.1442, 
        z: 18.8816
    } distances_traveled: [
        42,
        39,
        12,
        421
    ]
}
</code></pre>
<p>Collections only contains documents</p>
<pre><code class="language-javascript">collection = {
    hash1: document1
    hash2: document2 
}
</code></pre>
<p>At rhe root we will have a collection, so path to a document may look like,</p>
<pre><code class="language-javascript">var messageRef = firestore.collection('rooms').doc('roomA').collection('messages').doc('message1');
</code></pre>
<p>Each level fragment pattern will come in pair <code>.collection(...).doc(...)</code>.</p>
<p>Every field in a document is automatically indexed by Firestore. Depending on the search we may have create composite indexes
if a search fails. Firestore will send a link to console
which can be used to create exact composite index that is needed for that specific search.</p>
<p>Note, we will have to copy the composite index it back to our firestore project so that it will be pushed when we deploy next time.</p>
<blockquote>
<p>Question: does the firestore emulator do the same? Answer No.
Emulator will automatically build the indexes if it is missing.
there is no way currently to figure out what are the indexes
it built, although google might add it in the future.</p>
</blockquote>
<p>General rules</p>
<ul>
<li>Documents have limits.</li>
<li>You can't retrieve a partial document.</li>
<li>Queries are shallow.</li>
<li>You're billed by the number of reads and writes you perform.</li>
<li>Queries find documents in collections.</li>
<li>Arrays are weird.</li>
</ul>
<pre><code class="language-javascript">service cloud.firestore {
    match /databases/{database}/documents {
        match /{document=**} {
            // Completely locked
            allow read, write: if false;
        }
    }
}
</code></pre>
<pre><code class="language-javascript">service cloud.f1restore {
    match /databases/{database}/documents {
        match /restaurants/{restaurantID} {
            // restaurantID could be resturant_123
        }
        match /restaurants/{restaurantID}/reviews/{reviewID} {
        }
    }
}
</code></pre>
<p>wildcard</p>
<pre><code class="language-javascript">service cloud.f1restore {
    match /databases/{database}/documents {
        match /restaurants/{restOfPath=**} {
            // restOfPath could be resturant_123
            // or could be resturant_123/reviews/review_456
        }
        match /restaurants/{restaurantID}/reviews/{reviewID} {
        }
    }
}
</code></pre>
<pre><code class="language-javascript">service cloud.f1restore {
    match /databases/{database}/documents {
        match/restaurants/{restaurantID} {
            // restaurantID = The ID of the restaurant doc is available at this level 
            match /reviews/{reviewID} {
                // restaurantID = The ID of the restaurant doc available at this level
                // reviewID = The ID of the review doc is also available at this level
                allow write: if reviewID == "review_234"
            }
            // private data that only helps queries not to be sent back to client 
            match /private-data/{privateDoc} {
            }
        }
    }
}
</code></pre>
<pre><code class="language-javascript">service cloud.f1restore {
    match /databases/{database}/documents {
        match /{document=**} {
            //DO NOT LEAVE THIS IN, this will override everything else, RULES are OR-ED
            allow read, write;
        }
        match /users/{rest0fPath=**} {
            allow read;
        }
        match /users/{userID}/privateData/{privateDoc} {
            //Doesn't do anything
            allow read: if false;
        }
    }
}
</code></pre>
<p>read <a href="https://firebase.google.com/docs/auth/admin/custom-claims">Control Access with Custom Claims and Security Rules</a> to enable additional fields in Auth token.</p>
<p>access rule checks</p>
<pre><code class="language-javascript">// logged in users only 
service cloud.f1restore {
    match /databases/{database}/documents {
        match /myCollection/{docID} {
            allow read: if request.auth!= null;
        }
    }
}
// logged in users with google email
service cloud.f1restore {
    match /databases/{database}/documents {
        match /myCollection/{docID} {
            allow read: if request.auth.token.email.matches('.*google[.]com$');
        }
    }
}
// logged in users with google email and email verified
service cloud.f1restore {
    match /databases/{database}/documents {
        match /myCollection/{docID} {
            allow read: if request.auth.token.email.matches('.*google[.]com$') &amp;&amp;
                request.auth.token.email_verified;
        }
    }
}
// only logged in as albert 
service cloud.f1restore {
    match /databases/{database}/documents {
        match /myCollection/{docID} {
            allow read: if request.auth.uid == "albert_245";
        }
    }
}

// role based access using private collection
allow update: if get(/databases/$(database)/documents/restaurants/$(restaurantID)/private_data/private).data.roles[request.auth.uid] == "editor";

// multiple role access using private collection
allow update: if get(/databases/$(database)/documents/restaurants/$(restaurantID)/private_data/private).data.roles[request.auth.uid] in ["editor", "owner"];
</code></pre>
<p>using functions</p>
<pre><code class="language-javascript">// logged in users with google email and email verified
service cloud.f1restore {
    match /databases/{database}/documents {
        match /myCollection/{docID} {
            function doesUserHaveGoogleAccuunt() {
                return request.auth.token.email.matches(
                    '.*google[.]com$')
                    &amp;&amp; request.auth.token.email_verified;
                }
            allow read: if doesUserHaveGoogleAccuunt();
        }
    }
}
</code></pre>
<p>or</p>
<pre><code class="language-javascript">service cloud.f1restore {
    match /databases/{database}/documents {
        function userIsRestaurantEditor(restaurantID) {
            return get(/databases/$(database)/documents/restaurants/$(restaurantID)/private_data/private)
                .data.roles[request.auth.uid] in ["editor", "owner"];
        }
        match /restaurants/{restaurantID} {
            // restaurantID = The ID of the restaurant doc is available at this level 
            allow update: if userIsRestaurantEditor(restaurantID);
            match /reviews/{reviewID} {
                // restaurantID = The ID of the restaurant doc available at this level
                // reviewID = The ID of the review doc is also available at this level
            }
            // private data that only helps queries not to be sent back to client 
            match /private-data/{privateDoc} {
            }
        }
    }
}
</code></pre>
<p>To test rules use cloud firestore emulator.</p>
<p>pagination needs to be used save data transfer cost</p>
<pre><code class="language-javascript">// first page
myQuery = restaurantRef
    .whereFie1d("city", isEqualTo: "Tokyo")
    .whereFie1d("category", isEqualTo: "tempura")
    .order(by: "rating”, descending: true)
    .limit(to: 20)
// next page
myQuery = restaurantRef
    .whereFie1d("city", isEqualTo: "Tokyo")
    .whereFie1d("category", isEqualTo: "tempura")
    .order(by: "rating”, descending: true)
    .limit(to: 20)
    .start(after: [”Tokyo", “tempura", 4.9)

// or a simpler way, 
myQuery = myQuery.start(after: [”Tokyo", “tempura", 4.9])

// even easier 
myQuery = myQuery.start(after: previousDoc)
</code></pre>
<p>dont use .offset() because it will still bill you for the skipped data.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cross-platform-apps"><a class="header" href="#cross-platform-apps">Cross Platform Apps</a></h1>
<p>The traditional way is using a multi-platform UI library. GTK4 is an example
for such library from gnome project. However it requires lot of coding to provide
plumbing between different components.</p>
<p>However, another most convenient way to build cross platform apps is to use
web technology
for the frontend user interface. This a well understood technology and as such
the gui can be built with standard web page design tooling.</p>
<p>Most popular such app design environment is electron, which is chromium based.
the backend of electron app is node.
The problem with electron is distributable bundle size. The are quite large,
because bundle includes node, and chromium.
In order to reduce bundle size, new similar environments are using</p>
<ul>
<li>Webview, instead of chromium. Desktops distros are equipped with webview.</li>
<li>Faster and lighter compiled binary backend.</li>
</ul>
<p>As a result, the bundles are orders of magnitude smaller, more secure compared
to Electron.</p>
<p>One such environment is Tauri, which rust based. Here, I will record my notes as
I try to build a Tauri app, with svelte frontend.</p>
<h2 id="electron-python"><a class="header" href="#electron-python">Electron Python</a></h2>
<ul>
<li><a href="https://github.com/fyears/electron-python-example">https://github.com/fyears/electron-python-example</a></li>
</ul>
<h2 id="tauri"><a class="header" href="#tauri">Tauri</a></h2>
<h3 id="installing"><a class="header" href="#installing">Installing</a></h3>
<ul>
<li>Install rust. Run the installer from
<a href="https://www.rust-lang.org/tools/install">rust</a> site.</li>
<li>Install tauri. Follow instructions from [tauri] (https://tauri.app/v1/guides/getting-started/setup/sveltekit/) site.</li>
</ul>
<pre><code>cargo install create-tauri-app
# cargo create-tauri-app
</code></pre>
<p>Install tauri cli</p>
<pre><code>cargo install tauri-cli
</code></pre>
<h3 id="create-the-project"><a class="header" href="#create-the-project">Create the project</a></h3>
<pre><code>npm create svelte@latest tauri-svelte
cd tauri-svelte
git init

# add tauri to project
cargo tauri init

npm install @tauri-apps/api
</code></pre>
<h3 id="run-in-dev-mode"><a class="header" href="#run-in-dev-mode">Run in dev mode</a></h3>
<pre><code>cargo tauri dev
</code></pre>
<h3 id="build-the-production-version"><a class="header" href="#build-the-production-version">Build the production version</a></h3>
<pre><code>cargo tauri build
</code></pre>
<h2 id="use-web-rendering-engine"><a class="header" href="#use-web-rendering-engine">Use web rendering engine</a></h2>
<p>WebRender is a GPU-based 2D HTML rendering engine written in Rust.
See <a href="https://github.com/servo/webrender">https://github.com/servo/webrender</a></p>
<ul>
<li><a href="https://docs.rs/webrender/latest/webrender/">https://docs.rs/webrender/latest/webrender/</a></li>
</ul>
<p>Either we can use a javascript engine similar to a web browser,
or build the UI functionality in pure rust.</p>
<h2 id="gtk4"><a class="header" href="#gtk4">GTK4</a></h2>
<ul>
<li><a href="https://gtk-rs.org/gtk4-rs/git/book/">https://gtk-rs.org/gtk4-rs/git/book/</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="svelte"><a class="header" href="#svelte">Svelte</a></h1>
<h2 id="general-capabilities"><a class="header" href="#general-capabilities">General capabilities</a></h2>
<ul>
<li><a href="https://www.freecodecamp.org/news/the-svelte-handbook/">The Svelte Handbook</a></li>
</ul>
<h3 id="create-a-starter-svelte-project"><a class="header" href="#create-a-starter-svelte-project">create a starter svelte project</a></h3>
<pre><code class="language-bash">npx degit sveltejs/template my-svelte-project
cd my-svelte-project
npm install
npm run dev
</code></pre>
<h3 id="vscode-setting"><a class="header" href="#vscode-setting">vscode setting</a></h3>
<p>Command Palette (⇧⌘P) then: Preferences: Configure Language Specific Settings,</p>
<pre><code class="language-json">{
  "[svelte]": {
    "editor.defaultFormatter": "svelte.svelte-vscode",
    "editor.tabSize": 2
  }
}
</code></pre>
<h2 id="svelte-browser-compatibility"><a class="header" href="#svelte-browser-compatibility">Svelte Browser compatibility</a></h2>
<ul>
<li><a href="https://blog.az.sg/posts/svelte-and-ie11/">Making a svelte app compatible with Internet Explorer 11</a></li>
<li><a href="http://simey.me/svelte3-rollup-and-babel7/">Svelte3, Rollup and Babel7</a></li>
</ul>
<h2 id="svelte-components"><a class="header" href="#svelte-components">Svelte components</a></h2>
<ul>
<li><a href="https://github.com/hperrin/svelte-material-ui">https://github.com/hperrin/svelte-material-ui</a></li>
<li><a href="https://github.com/collardeau/svelte-fluid-header">https://github.com/collardeau/svelte-fluid-header</a></li>
<li><a href="https://flaviocopes.com/svelte-state-management/">https://flaviocopes.com/svelte-state-management/</a></li>
</ul>
<h2 id="svelte-component-exported-functions"><a class="header" href="#svelte-component-exported-functions">Svelte Component exported functions</a></h2>
<p><code>Comp1.svelte</code> file.</p>
<pre><code class="language-html">&lt;script&gt;
    import Comp2, {mod_param as C2param} from 'Comp2.svelte';

    console.log(C2param.someText);
    C2param.someFunc("Comp2 function called from Comp1");
&lt;/script&gt;
</code></pre>
<p><code>Comp2.svelte</code> file.</p>
<pre><code class="language-html">&lt;script&gt;
  // This is component instance context
...
&lt;/script&gt;

&lt;script context="module"&gt;
  // This is component module context
  export const mod_param = {
    someFunc: (text) =&gt; {
      console.log(text);
    },

    someText: "hello from Comp2" 
  }
&lt;/script&gt;
</code></pre>
<blockquote>
<p>Exchanging data between components module and instance context is tricky
So appropriate handling required in such case. It is best to use
<a href="https://svelte.dev/repl">REPL</a> sandbox <code>JS output</code> window to
check the exact use case.</p>
</blockquote>
<h2 id="component-lifecycle"><a class="header" href="#component-lifecycle">Component lifecycle</a></h2>
<p>Components,</p>
<ol>
<li>are instantiated and composed inside parents.</li>
<li>are initialized by parents via parameters.
Parameters are passed by value.</li>
<li>display information and interact with user.</li>
<li>manage user interaction via state transitions.</li>
<li>make the user entered information accessible to parents via bindings.
Binding keeps parent's variable in sync with components variable.
Binding makes the parameter behave like as if they were passed
by pointers.</li>
<li>send events to parent so that parent can take actions.
Parent uses event handlers.</li>
<li>are destroyed by parents when they are no longer needed.</li>
</ol>
<blockquote>
<p>A parent can get component state both via binding and events.
Bindings provide easy reactive update in parents. Events
provides an easy way when algorithmic action is required by parent.
Using both as appropriate is the best approach.</p>
</blockquote>
<p>Check <a href="https://dev.to/joshnuss/managing-state-in-svelte-29o7">Managing state in Svelte</a>.</p>
<h2 id="passing-parameter-to-sub-component"><a class="header" href="#passing-parameter-to-sub-component">Passing parameter to sub-component</a></h2>
<p>Sub-components act like functions javascript function with parameters, pass parameters individually or
all the parameters as a dictionary using a spread operator.
You can have <a href="https://svelte.dev/tutorial/default-values">default values</a> inside the sub-component.</p>
<pre><code class="language-auto">  &lt;Comp1 param1={data} /&gt;
  &lt;Comp2 {...selprops} /&gt;
</code></pre>
<p>Using spread operator is preferred for large number of parameters.</p>
<p>Check <a href="https://svelte.dev/repl/aac50a4f24fd4858b1c6fffc0a75e418?version=3.23.1">Passing parameters to components</a>.</p>
<h2 id="binding"><a class="header" href="#binding">Binding</a></h2>
<p>Binding is exactly same as passing individual parameters, except you have to attach the
<code>bind</code> keyword in the association.</p>
<pre><code class="language-auto">  &lt;Comp1 bind:param1={data} /&gt;
</code></pre>
<p>Binding will keep component parameter <code>param1</code> and parent variable
<code>data</code> always in sync. When components updates <code>param1</code> it will be
immediately reflected in <code>data</code>. Parent can bind <code>data</code> with multiple
components and they all will be in sync as well.</p>
<p>There is no spread style binding syntax supported.</p>
<p>There is a short hand syntax available for binding in the case when parameter name and variable name are the same.</p>
<pre><code class="language-auto">  &lt;Comp1 bind:same_name={same_name} /&gt;
  &lt;!-- short hand syntax for above --&gt;
  &lt;Comp1 bind:same_name /&gt;
</code></pre>
<p>Check <a href="https://svelte.dev/tutorial/component-bindings">component bindings</a>.</p>
<h2 id="events"><a class="header" href="#events">Events</a></h2>
<p><code>Parent.svelte</code> source,</p>
<pre><code class="language-auto">&lt;script&gt;
	import Comp1 from './Comp1.svelte';

	function handleMessage(event) {
		alert(event.detail.text);
	}
&lt;/script&gt;

&lt;Comp1 on:event_name={handleMessage}/&gt;
</code></pre>
<p><code>Comp1.svelte</code> source,</p>
<pre><code class="language-auto">&lt;script&gt;
	import { createEventDispatcher } from 'svelte';

	const dispatch = createEventDispatcher();

	function sayHello() {
		dispatch('event_name', {
			text: 'Hello!'
		});
	}
&lt;/script&gt;

&lt;button on:click={sayHello}&gt;
	Click to say hello
&lt;/button&gt;
</code></pre>
<p>To bubble up component message parent can forward it further up,
see <a href="https://svelte.dev/tutorial/event-forwarding">event forwarding</a>.</p>
<h2 id="develop-reusable-components"><a class="header" href="#develop-reusable-components">develop reusable components</a></h2>
<p>using REPL, Github and npm</p>
<blockquote>
<p>todo: write up</p>
</blockquote>
<h2 id="generating-web-components-with-svelte"><a class="header" href="#generating-web-components-with-svelte">Generating web components with svelte</a></h2>
<ul>
<li><a href="https://dev.to/silvio/how-to-create-a-web-components-in-svelte-2g4j">How to Create a Web Component in Svelte</a>.</li>
</ul>
<h2 id="styling"><a class="header" href="#styling">Styling</a></h2>
<ul>
<li><a href="https://css-tricks.com/what-i-like-about-writing-styles-with-svelte/">What I Like About Writing Styles with Svelte</a></li>
<li><a href="https://svelte.dev/blog/the-zen-of-just-writing-css">The zen of Just Writing CSS</a></li>
<li><a href="https://css-tricks.com/what-i-like-about-writing-styles-with-svelte/">https://css-tricks.com/what-i-like-about-writing-styles-with-svelte/</a></li>
<li>With tailwind we can import external css file into a component, Although it is not specific for svelte, still is a good read: <a href="https://mattferderer.com/add-postcss-imports-to-tailwind-css">Add Imports to Tailwind CSS with PostCSS</a>.</li>
<li>css in js for svelte, <a href="https://svelte.dev/blog/svelte-css-in-js">https://svelte.dev/blog/svelte-css-in-js</a></li>
</ul>
<h2 id="generated-content-and-global-styling-in-production-build"><a class="header" href="#generated-content-and-global-styling-in-production-build">Generated content and global styling in production build</a></h2>
<p>Svelte allows css support of generated content with global styling. However
it (with postcss and purgecss) removes any css that is not being used by
the static content during production build, if it is loaded from a css file
using postcss-include facility even it is a global style. During
development build this doesn't happen though since we don't run purgecss in
development build. To ensure those styles are retained we need to tell
purgecss about those. For instance if we used a highlighter such as
highlight.js which prepends highlight classes with <code>hljs-</code> prefix. Then
we can retain styling for them by adding a whitelist pattern <code>/hljs-/</code></p>
<p>in <code>postcss.config.js</code> the same way as it is done for svelte in their
official svelte template.</p>
<pre><code class="language-javascript">const purgecss = require('@fullhuman/postcss-purgecss')({
  content: ['./src/**/*.svelte', './src/**/*.html'],
  whitelistPatterns: [/svelte-/, /hljs-/],
  defaultExtractor: content =&gt; content.match(/[A-Za-z0-9-_:/]+/g) || []
})
</code></pre>
<h3 id="transitions-animations"><a class="header" href="#transitions-animations">Transitions, Animations</a></h3>
<ul>
<li><a href="https://svelte.dev/repl/865750b1ffb642f59d317747bd9f3534?version=3.4.4">https://svelte.dev/repl/865750b1ffb642f59d317747bd9f3534?version=3.4.4</a></li>
<li><a href="https://stackoverflow.com/questions/56453366/cant-use-svelte-animate-to-make-a-list-item-fly-into-a-header">https://stackoverflow.com/questions/56453366/cant-use-svelte-animate-to-make-a-list-item-fly-into-a-header</a></li>
<li><a href="https://svelte.dev/repl/f4386ec88df34e3b9a6b513e19374824?version=3.4.4">https://svelte.dev/repl/f4386ec88df34e3b9a6b513e19374824?version=3.4.4</a> for moving selected item to a position.</li>
</ul>
<h2 id="state-management"><a class="header" href="#state-management">state management</a></h2>
<ul>
<li><a href="https://stackoverflow.com/questions/65092054/how-to-use-svelte-store-with-tree-like-nested-object">https://stackoverflow.com/questions/65092054/how-to-use-svelte-store-with-tree-like-nested-object</a></li>
<li><a href="https://www.newline.co/@kchan/state-management-with-svelte-props-part-1--73a26f45">https://www.newline.co/@kchan/state-management-with-svelte-props-part-1--73a26f45</a></li>
<li><a href="https://medium.com/@veeralpatel/things-ive-learned-about-state-management-for-react-apps-174b8bde87fb">https://medium.com/@veeralpatel/things-ive-learned-about-state-management-for-react-apps-174b8bde87fb</a></li>
<li><a href="https://svelte-recipes.netlify.app/stores/">https://svelte-recipes.netlify.app/stores/</a></li>
<li><a href="https://mobx.js.org/getting-started">https://mobx.js.org/getting-started</a></li>
<li><a href="https://blog.logrocket.com/application-state-management-with-svelte/">https://blog.logrocket.com/application-state-management-with-svelte/</a></li>
</ul>
<h3 id="contexts-vs-stores"><a class="header" href="#contexts-vs-stores">Contexts vs. stores</a></h3>
<p>Contexts and stores seem similar. They differ in that stores are available to any part of an app, while a context is only available to a component and its descendants. This can be helpful if you want to use several instances of a component without the state of one interfering with the state of the others.</p>
<p>In fact, you might use the two together. Since context is not <strong>reactive</strong> and not mutable, values that change over time should be represented as stores:</p>
<pre><code class="language-auto">const { these, are, stores } = getContext(...);
</code></pre>
<ul>
<li><a href="https://svelte.dev/tutorial/context-api">REPL context API demo</a></li>
<li><a href="https://www.toptal.com/front-end/svelte-framework-guide">Lighter and Faster - A Guide to the Svelte Framework</a>,
Github <a href="https://github.com/teimurjan/svelte-login-form">source</a></li>
</ul>
<hr />
<h2 id="svelte-markdown-editor"><a class="header" href="#svelte-markdown-editor">Svelte markdown editor</a></h2>
<ul>
<li><a href="https://dev.to/karkranikhil/build-markdown-editor-using-svelte-in-10-minutes-1c69">Build Markdown editor using Svelte in 10 minutes</a>,
this uses <a href="https://marked.js.org">marked.js</a> parser, <a href="https://github.com/markedjs/marked">github</a>.</li>
<li>Stackedit is a vue markdown editor, but provides scroll sync. We can take
a look at the source code and do similar thing in Svelte. Uses <a href="https://github.com/markdown-it/markdown-it">https://github.com/markdown-it/markdown-it</a>. markdown-it has most versatile collection of plugins.</li>
<li>Nice scrollbar sync example, <a href="https://github.com/vincentcn/markdown-scroll-sync">https://github.com/vincentcn/markdown-scroll-sync</a>.</li>
<li>Another scrollbar sync example, <a href="https://github.com/jonschlinkert/remarkable">https://github.com/jonschlinkert/remarkable</a>. Look in the demo directory.</li>
<li>The most promising markdown editing seems to be <code>markdown-it</code>, <code>vscode</code> uses this for their markdown support as well.
This seems to be a project which evolved from
<code>remarkable</code>. Check Github <a href="https://github.com/markdown-it/markdown-it">https://github.com/markdown-it/markdown-it</a>
in the <code>support/demo_template</code> directory for the scroll syncing javascript source.
With some modification this can be integrated with svelte.
I like the way vscode does it, whenever the cursor is on a line, it finds
the whole element in the preview window and draws a side bar to indicate
the element being edited. I was able to integrate the relevant part of
the code from <code>support/demo_template</code> with svelte,
<a href="topics/markdown">read more</a>.</li>
</ul>
<h2 id="using-processing-p5js-in-svelte"><a class="header" href="#using-processing-p5js-in-svelte">using processing p5.js in svelte</a></h2>
<ul>
<li><a href="https://dev.to/tonyketcham/p5-svelte-a-quick-and-easy-way-to-use-p5-in-svelte-3j8f">p5-Svelte: a quick and easy way to use p5 in Svelte!</a>, <a href="https://github.com/tonyketcham/p5-svelte">Github</a></li>
<li><a href="https://www.youtube.com/watch?v=OIfEHD3KqCg">Q&amp;A #6: p5.js Sketch as Background</a></li>
<li><a href="https://p5js.org/reference/#/p5/loadImage">https://p5js.org/reference/#/p5/loadImage</a></li>
</ul>
<h2 id="routing"><a class="header" href="#routing">Routing</a></h2>
<ul>
<li><a href="https://youtu.be/edFp-vuDlLs">Client-side (SPA) routing in Svelte</a></li>
<li><a href="https://visionmedia.github.io/page.js/">Micro client-side router inspired by the Express router</a></li>
<li><a href="https://dev.to/ism/svelte-routing-with-page-js-part-1-2h9h">Svelte routing with page.js, Part 1</a></li>
<li><a href="https://dev.to/ism/svelte-routing-with-page-js-part-2-4l76">Svelte routing with page.js, Part 2</a>, code in <a href="https://github.com/iljoo/svelte-pagejs">https://github.com/iljoo/svelte-pagejs</a>.</li>
<li><a href="https://jackwhiting.co.uk/posts/setting-up-routing-in-svelte-with-pagejs/">Setting up Routing In Svelte with Page.js</a></li>
<li>Svelte with firebase and page.js router- I have built a template, work in progress: <a href="https://github.com/kkibria/svelte-page-markdown">https://github.com/kkibria/svelte-page-markdown</a>.</li>
</ul>
<h2 id="spa--search-engine-optimization-seo"><a class="header" href="#spa--search-engine-optimization-seo">SPA &amp; Search Engine Optimization (SEO)</a></h2>
<ul>
<li><a href="https://snipcart.com/spa-seo">SPA SEO: A Single-Page App Guide to Google’s 1st Page</a></li>
<li><a href="https://love2dev.com/blog/why-single-page-application-views-should-be-hydrated-on-the-client-not-the-server/">Why Single Page Application Views Should be Hydrated on the Client, Not the Server</a></li>
</ul>
<h2 id="svelte-with-firebase"><a class="header" href="#svelte-with-firebase">Svelte with firebase</a></h2>
<ul>
<li><a href="https://svelte.dev/">svelte</a></li>
<li><a href="https://youtu.be/AdNJ3fydeao">Rich Harris - Rethinking reactivity</a></li>
<li><a href="https://youtu.be/043h4ugAj4c">Svelte 3 Reaction &amp; QuickStart Tutorial</a></li>
<li><a href="https://youtu.be/urDLn8RNlCA">Svelte + Firebase = Sveltefire (and it is FIRE 🔥🔥🔥)</a></li>
<li><a href="https://fireship.io/lessons/svelte-v3-overview-firebase/">Svelte Realtime Todo List with Firebase</a>. I built a template using this in <a href="https://github.com/kkibria/svelte-todo">https://github.com/kkibria/svelte-todo</a>.</li>
<li>Uses firebase auth web UI <a href="https://sveltecasts.dev/episodes/001-firebase-ui">Sapper/Svelte Firebase Auth UI</a>, github source <a href="https://github.com/sveltecasts/001-auth">code</a>.</li>
<li>Firebase storage with svelte - <a href="https://dev.to/ajonpllc/rxfire-in-svelte-3-using-firebase-firestore-and-authentication-pca">RxFire in Svelte 3 using Firebase Firestore and Authentication</a></li>
</ul>
<h2 id="login-data-passing-with-context-api"><a class="header" href="#login-data-passing-with-context-api">Login data passing with context API</a></h2>
<p>Firebase can have has it own login subscription via rxfire. However following articles are good read to understand svelte support data sharing across the app.</p>
<h2 id="web-components"><a class="header" href="#web-components">Web components</a></h2>
<p>A Svelte component can be compiled into a web component as documented in
<a href="https://svelte.dev/docs#run-time-custom-element-api">Custom element API</a>, read this carefully.</p>
<blockquote>
<p>At the moment this is an incomplete feature. There are many issues as described in the following parts
of this section. If you are not dependent on them (kebab casing and global: css) you can make web components.</p>
</blockquote>
<p>There should be two ways we can interact with web component technology,</p>
<ul>
<li>Instantiate web component in a svelte component. Check this as a starting point, <a href="https://youtu.be/-6Hy3MHfPhA">https://youtu.be/-6Hy3MHfPhA</a>.</li>
<li>instantiate a svelte component in a web component or a existing web page like a web component.</li>
</ul>
<h3 id="compile"><a class="header" href="#compile">Compile</a></h3>
<p>To convert your existing Svelte app into a web component, you need to,</p>
<ul>
<li>Add &lt;svelte:options tag="component-name"&gt; somewhere in your .svelte file to assign a html tag name.</li>
<li>Tell the svelte compiler to create web component by adding <code>customElement: true</code> option.
However using this way would turn every svelte file it compiles to a web component. In a typical
project however you might one only the top svelte file compiled to be a web component and all other files to integrated in the top level file. This can be done using <code>customElement</code> option with a filter.</li>
</ul>
<p>Following is a filter example that only makes web component when the file has <code>.wc.svelte</code> extension.</p>
<pre><code>// rollup.config.js
svelte({ customElement: true, include: /\.wc\.svelte$/ }),
svelte({ customElement: false, exclude: /\.wc\.svelte$/ }),
</code></pre>
<h3 id="global-css-file"><a class="header" href="#global-css-file">Global CSS file</a></h3>
<p>Using global CSS from a file should be done carefully if they are not scoped properly. They should
be avoided inside a component, all styles should be defined inside the Svelte components
so that svelte compiler scope them properly. Using class name to scope CSS is the right approach
if needed.
For web components svelte will inline the CSS.
Note that, CSS with global: specifier for generated content is needed since svelte will remove
any unused CSS otherwise. But this <a href="https://github.com/sveltejs/svelte/issues/2969">does not work</a> in Custom element right now.</p>
<p>A workaround proposed is to use webpack <code>ContentReplacePlugin</code>,</p>
<pre><code>plugins: [
	new ContentReplacePlugin({
        	rules: {
		      '**/*.js': content =&gt; content.replace(/:global\(([\[\]\(\)\-\.\:\*\w]+)\)/g, '$1')
	          }
	})
]
</code></pre>
<p>A side note, CSS doesn't leak thru shadow DOM which is used for web components.</p>
<h3 id="property-name"><a class="header" href="#property-name">Property name</a></h3>
<p>The property names should be restricted to lower case, camel case and kebab case should not be used
as they have complications. However if you must, check <a href="https://github.com/sveltejs/svelte/issues/3852">https://github.com/sveltejs/svelte/issues/3852</a>.
The solution proposed is to create a wrapper,</p>
<pre><code>import MyCustomComponent from './MyCustomComponent.svelte';

class MyCustomComponentWrapper extends MyCustomComponent {
  static get observedAttributes() {
    return (super.observedAttributes || []).map(attr =&gt; attr.replace(/([a-zA-Z])(?=[A-Z])/g, '$1-').toLowerCase());
  }

  attributeChangedCallback(attrName, oldValue, newValue) {
    attrName = attrName.replace(/-([a-z])/g, (_, up) =&gt; up.toUpperCase());
    super.attributeChangedCallback(attrName, oldValue, newValue);
  }
}

customElements.define('my-custom-component', MyCustomComponentWrapper);
</code></pre>
<p>MyCustomComponent.svelte</p>
<pre><code>&lt;script&gt;
  export let someDashProperty;
&lt;/script&gt;

&lt;svelte:options tag={null} /&gt;

{someDashProperty}
</code></pre>
<p>Then you can use it in this way:</p>
<pre><code>&lt;my-custom-component some-dash-property="hello"&gt;&lt;/my-custom-component&gt;
</code></pre>
<p>There were variants of this can be used in the bundler to have a automated wrapper injection
done at the build time.</p>
<p>If you use esbuild bundler instead of rollup, following would work.</p>
<p>Original Svelte component like this:</p>
<pre><code>&lt;!-- src/components/navbar/navbar.wc.svelte --&gt;

&lt;svelte:options tag="elect-navbar" /&gt;

&lt;!-- Svelte Component ... --&gt;
</code></pre>
<p>Create a customElements.define</p>
<pre><code>/* src/utils/custom-element.js */

export const customElements = {
  define: (tagName, CustomElement) =&gt; {
    class CustomElementWrapper extends CustomElement {
      static get observedAttributes() {
        return (super.observedAttributes || []).map((attr) =&gt;
          attr.replace(/([a-zA-Z])(?=[A-Z])/g, '$1-').toLowerCase(),
        );
      }

      attributeChangedCallback(attrName, oldValue, newValue) {
        super.attributeChangedCallback(
          attrName.replace(/-([a-z])/g, (_, up) =&gt; up.toUpperCase()),
          oldValue,
          newValue === '' ? true : newValue, // [Tweaked] Value of omitted value attribute will be true
        );
      }
    }

    window.customElements.define(tagName, CustomElementWrapper); // &lt;--- Call the actual customElements.define with our wrapper
  },
};

</code></pre>
<p>Then use esbuild inject option to inject the above code to the top of the built file</p>
<pre><code>/* esbuild.js */

import { build } from 'esbuild';
import esbuildSvelte from 'esbuild-svelte';
import sveltePreprocess from 'svelte-preprocess';

// ...
    build({
      entryPoints,
      ourdir,
      bundle: true,
      inject: ['src/utils/custom-element.js'], // &lt;--- Inject our custom elements mock
      plugins: [
        esbuildSvelte({
          preprocess: [sveltePreprocess()],
          compileOptions: { customElement: true },
        }),
      ],
    })
// ...
</code></pre>
<p>Will produce web component like this:</p>
<pre><code>// components/navbar.js

(() =&gt; {
  // src/utils/custom-element.js
  var customElements = {
    define: (tagName, CustomElement) =&gt; {
      // Our mocked customElements.define logic ...
    }
  };

  // Svelte compiled code ...

  customElements.define("elect-navbar", Navbar_wc); // &lt;--- This code compiled by Svelte will called our mocked function instead of actual customElements.define
  var navbar_wc_default = Navbar_wc;
})();



</code></pre>
<ul>
<li><a href="https://javascript.plainenglish.io/can-you-build-web-components-with-svelte-3c8bc3c1cfd8#:~:text=In%20theory%2C%20all%20you%20need,That&#x27;s%20it!">Can You Build Web Components With Svelte?</a>, slightly old, some of the issues have been fixed since then. A must read
to understand related issues.</li>
</ul>
<blockquote>
<p>Todo: We will explore this in more details in future.</p>
</blockquote>
<h3 id="events-1"><a class="header" href="#events-1">Events</a></h3>
<ul>
<li><a href="https://github.com/sveltejs/svelte/issues/3119">https://github.com/sveltejs/svelte/issues/3119</a></li>
</ul>
<p>Read <a href="https://developer.mozilla.org/en-US/docs/Web/API/Event/Event">MDN events article</a>.
The read-only <code>composed</code> property of the Event interface returns a Boolean which indicates
whether or not the event will propagate across the shadow DOM boundary into the standard DOM.</p>
<pre><code>// App.svelte
&lt;svelte:options tag="my-component" /&gt;
&lt;script&gt;
	import { createEventDispatcher } from 'svelte';
	const dispatch = createEventDispatcher();
&lt;/script&gt;

&lt;button on:click="{() =&gt; dispatch('foo', {detail: 'bar', composed: true})}"&gt;
    click me 
&lt;/button&gt;
</code></pre>
<h2 id="develop-with-vite"><a class="header" href="#develop-with-vite">Develop with Vite</a></h2>
<ul>
<li><a href="https://vitejs.dev/">https://vitejs.dev/</a></li>
</ul>
<p>Vite provides very nice response time during development cycle, compile is really fast with vite
as it doesn't bundle at development time. For production build it uses rollup as usual with
svelte and bundles everything together. It also has a nice
<a href="https://github.com/roonie007/vite-plugin-svelte-kebab-props">plugin for kebab casing</a>
support for svelte component property names.</p>
<blockquote>
<p>I am not sure if we make a web component with this plugin, the web component will support
kebab casing. But using web component with kebab casing in Svelte can be done with this.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="svelte-desktop-and-mobile-app"><a class="header" href="#svelte-desktop-and-mobile-app">Svelte Desktop and mobile app</a></h1>
<h2 id="svelte-for-desktop-app"><a class="header" href="#svelte-for-desktop-app">svelte for desktop app</a></h2>
<ul>
<li><a href="https://dev.to/khangnd/build-a-desktop-app-with-electron-and-svelte-44dp">Build a desktop app with Electron and Svelte</a>, <a href="https://github.com/khang-nd/electron-app-svelte">github</a></li>
<li><a href="https://dev.to/o_a_e/getting-started-with-electron-and-svelte-2gn8">Getting started with Electron and Svelte</a>, read the discussion in this article for problems and solutions.</li>
</ul>
<h2 id="web-apps--mobile-apps"><a class="header" href="#web-apps--mobile-apps">web apps &amp; mobile apps</a></h2>
<ul>
<li><a href="https://dev.to/ruppysuppy/turn-your-website-into-a-cross-platform-desktop-app-with-less-than-15-lines-of-code-with-electron-44m3">https://dev.to/ruppysuppy/turn-your-website-into-a-cross-platform-desktop-app-with-less-than-15-lines-of-code-with-electron-44m3</a></li>
<li><a href="https://www.webtips.dev/how-to-make-your-very-first-desktop-app-with-electron-and-svelte">https://www.webtips.dev/how-to-make-your-very-first-desktop-app-with-electron-and-svelte</a></li>
<li><a href="https://dev.to/khangnd/build-a-desktop-app-with-electron-and-svelte-44dp">https://dev.to/khangnd/build-a-desktop-app-with-electron-and-svelte-44dp</a></li>
<li><a href="https://fireship.io/snippets/svelte-electron-setup/">https://fireship.io/snippets/svelte-electron-setup/</a></li>
</ul>
<h2 id="svelete-and-capacitor-will-allow-web-apps-to-become-mobile-apps"><a class="header" href="#svelete-and-capacitor-will-allow-web-apps-to-become-mobile-apps">Svelete and capacitor will allow web apps to become mobile apps</a></h2>
<ul>
<li><a href="https://ionicframework.com">https://ionicframework.com</a></li>
<li><a href="https://capacitorjs.com/">https://capacitorjs.com/</a></li>
<li><a href="https://stackoverflow.com/questions/58611710/how-to-setup-svelte-js-with-ionic">https://stackoverflow.com/questions/58611710/how-to-setup-svelte-js-with-ionic</a></li>
<li><a href="https://www.joshmorony.com/using-the-capacitor-filesystem-api-to-store-photos/">https://www.joshmorony.com/using-the-capacitor-filesystem-api-to-store-photos/</a></li>
<li><a href="https://gist.github.com/dalezak/a6b1de39091f4ace220695d72717ac71">https://gist.github.com/dalezak/a6b1de39091f4ace220695d72717ac71</a></li>
</ul>
<h2 id="local-file-loading-in-electron"><a class="header" href="#local-file-loading-in-electron">local file loading in electron</a></h2>
<ul>
<li><a href="https://github.com/electron/electron/issues/23393">Electron should be able to load local resources with enabled webSecurity</a></li>
<li><a href="https://www.electronjs.org/docs/api/protocol#protocolregisterfileprotocolscheme-handler-completion">https://www.electronjs.org/docs/api/protocol#protocolregisterfileprotocolscheme-handler-completion</a></li>
</ul>
<h2 id="electron-app-security"><a class="header" href="#electron-app-security">electron app security</a></h2>
<p>Getting error doing electron dialog because fs and ipcRender can not be used in browser thread securely.</p>
<ul>
<li>
<p><a href="https://github.com/electron/electron/issues/9920">Error while importing electron in browser, import { ipcRenderer } from 'electron'</a></p>
</li>
<li>
<p>read <a href="https://www.electronjs.org/docs/latest/tutorial/process-model">https://www.electronjs.org/docs/latest/tutorial/process-model</a> to see how selected node environment
apis can be made available to renderer process via contextBridge.</p>
</li>
<li>
<p>also see <a href="https://stackoverflow.com/questions/44391448/electron-require-is-not-defined/59888788#59888788">https://stackoverflow.com/questions/44391448/electron-require-is-not-defined/59888788#59888788</a>.</p>
</li>
<li>
<p><a href="https://www.electronjs.org/docs/tutorial/context-isolation">https://www.electronjs.org/docs/tutorial/context-isolation</a></p>
</li>
<li>
<p>building secure electron app,
<a href="https://github.com/reZach/secure-electron-template/blob/master/docs/secureapps.md">https://github.com/reZach/secure-electron-template/blob/master/docs/secureapps.md</a></p>
</li>
</ul>
<h2 id="nodejs-and-frontend-interaction-in-electron"><a class="header" href="#nodejs-and-frontend-interaction-in-electron">Node.js and frontend interaction in electron</a></h2>
<p>there are two choices,</p>
<ol>
<li>server backend, chromium frontend communicating over tcpip port using standard web technique</li>
<li>browser-node interaction via IPC. We can promisify this. Following is the suggested code from this <a href="https://gist.github.com/Johnz86/33425246eddc36b26c6af2d5c8e2b1a7">gist</a>.</li>
</ol>
<p><code>main-ipc.ts</code></p>
<pre><code class="language-typescript">import { ipcMain, BrowserWindow, Event } from 'electron'

const getResponseChannels = (channel:string) =&gt; ({
    sendChannel: `%app-send-channel-${channel}`,
    dataChannel: `%app-response-data-channel-${channel}`,
    errorChannel: `%app-response-error-channel-${channel}`
})

const getRendererResponseChannels = (windowId: number, channel: string) =&gt; ({
    sendChannel: `%app-send-channel-${windowId}-${channel}`,
    dataChannel: `%app-response-data-channel-${windowId}-${channel}`,
    errorChannel: `%app-response-error-channel-${windowId}-${channel}`
})

export default class ipc {
    static callRenderer(window: BrowserWindow, channel: string, data: object) {
        return new Promise((resolve, reject) =&gt; {
            const { sendChannel, dataChannel, errorChannel } = getRendererResponseChannels(window.id, channel)

            const cleanup = () =&gt; {
                ipcMain.removeAllListeners(dataChannel)
                ipcMain.removeAllListeners(errorChannel)
            }

            ipcMain.on(dataChannel, (_: Event, result: object) =&gt; {
                cleanup()
                resolve(result)
            })

            ipcMain.on(errorChannel, (_: Event, error: object) =&gt; {
                cleanup()
                reject(error)
            })

            if (window.webContents) {
                window.webContents.send(sendChannel, data)
            }
        })
    }

    static answerRenderer(channel: string, callback: Function) {
        const { sendChannel, dataChannel, errorChannel } = getResponseChannels(channel)

        ipcMain.on(sendChannel, async (event: Event, data: object) =&gt; {
            const window = BrowserWindow.fromWebContents(event.sender)

            const send = (channel: string, data: object) =&gt; {
                if (!(window &amp;&amp; window.isDestroyed())) {
                    event.sender.send(channel, data)
                }
            }

            try {
                send(dataChannel, await callback(data, window))
            } catch (error) {
                send(errorChannel, error)
            }
        })
    }

    static sendToRenderers(channel: string, data: object) {
        for (const window of BrowserWindow.getAllWindows()) {
            if (window.webContents) {
                window.webContents.send(channel, data)
            }
        }
    }
}
</code></pre>
<p><code>renderer-ipc.ts</code></p>
<pre><code class="language-typescript">import { ipcRenderer, remote, Event } from 'electron';

const getResponseChannels = (channel: string) =&gt; ({
    sendChannel: `%app-send-channel-${channel}`,
    dataChannel: `%app-response-data-channel-${channel}`,
    errorChannel: `%app-response-error-channel-${channel}`
})

const getRendererResponseChannels = (windowId: number, channel: string) =&gt; ({
    sendChannel: `%app-send-channel-${windowId}-${channel}`,
    dataChannel: `%app-response-data-channel-${windowId}-${channel}`,
    errorChannel: `%app-response-error-channel-${windowId}-${channel}`
})

export default class ipc {
    static callMain(channel: string, data: object) {
        return new Promise((resolve, reject) =&gt; {
            const { sendChannel, dataChannel, errorChannel } = getResponseChannels(channel)

            const cleanup = () =&gt; {
                ipcRenderer.removeAllListeners(dataChannel)
                ipcRenderer.removeAllListeners(errorChannel)
            }

            ipcRenderer.on(dataChannel, (_: Event, result: object) =&gt; {
                cleanup()
                resolve(result)
            })

            ipcRenderer.on(errorChannel, (_: Event, error: object) =&gt; {
                cleanup()
                reject(error)
            })

            ipcRenderer.send(sendChannel, data)
        })
    }

    static answerMain(channel: string, callback: Function) {
        const window = remote.getCurrentWindow()
        const { sendChannel, dataChannel, errorChannel } = getRendererResponseChannels(window.id, channel)

        ipcRenderer.on(sendChannel, async (_: Event, data: object) =&gt; {
            try {
                ipcRenderer.send(dataChannel, await callback(data))
            } catch (err) {
                ipcRenderer.send(errorChannel, err)
            }
        })
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sveltekit"><a class="header" href="#sveltekit">Sveltekit</a></h1>
<ul>
<li><a href="https://kit.svelte.dev/">https://kit.svelte.dev/</a></li>
</ul>
<blockquote>
<p>TODO: check server side rendering.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sapper-a-server-side-framework-with-svelte"><a class="header" href="#sapper-a-server-side-framework-with-svelte">Sapper, a server side framework with Svelte</a></h1>
<blockquote>
<p>Sapper is officially dead. It has been replaced by <a href="topics/sveltekit.html">sveltekit</a>.</p>
</blockquote>
<blockquote>
<p>TODO: The firebase related material here, needs to be moved elsewhere.
We will eventully remove this section.</p>
</blockquote>
<h2 id="sapper"><a class="header" href="#sapper">Sapper</a></h2>
<ul>
<li><a href="https://sapper.svelte.dev/">sapper</a></li>
<li><a href="https://www.merixstudio.com/blog/project-sapper-javascript-framework/">Building a project with Sapper, a JavaScript app framework</a></li>
<li><a href="https://medium.com/swlh/simple-svelte-3-app-with-router-44fe83c833b6">Simple Svelte 3 app with router</a></li>
<li><a href="https://blog.logrocket.com/exploring-sapper-svelte-a-quick-tutorial/">Exploring Sapper + Svelte: A quick tutorial</a></li>
<li><a href="https://www.creativebloq.com/how-to/svelte-and-sapper">Build a fast reactive blog with Svelte and Sapper</a></li>
</ul>
<h2 id="sapper-with-firebase"><a class="header" href="#sapper-with-firebase">Sapper with firebase</a></h2>
<ul>
<li><a href="https://dev.to/eckhardtd/how-to-host-a-sapper-js-ssr-app-on-firebase-hmb">How to host a Sapper.js SSR app on Firebase</a></li>
<li><a href="https://youtu.be/fxfFMn4VMpQ">Sapper - Deploy to Firebase Cloud Functions</a></li>
<li><a href="https://lacourt.dev/2019/06/16">migrating to Sapper part 1 - SEO, Twitter Cards, OpenGraph</a></li>
<li><a href="https://lacourt.dev/2019/06/21">migrating to Sapper part 2 - TDD with Cypress.io</a></li>
<li><a href="https://lacourt.dev/2019/06/29">migrating to Sapper part 3 - RSS feed</a></li>
<li><a href="https://lacourt.dev/2019/06/30">migrating to Sapper part 2 bis - Netlify, GitHub Actions with Cypress.io</a></li>
<li><a href="https://github.com/fusionstrings/firebase-functions-sapper">https://github.com/fusionstrings/firebase-functions-sapper</a></li>
</ul>
<h2 id="a-recipe-to-be-tried-for-firebase"><a class="header" href="#a-recipe-to-be-tried-for-firebase">A recipe to be tried for firebase</a></h2>
<p>from <a href="https://dev.to/nedwards/comment/h1l7">https://dev.to/nedwards/comment/h1l7</a> ...snip --&gt;</p>
<p>Thanks very much for breaking this down.</p>
<p>I also tried following this video,
<a href="https://youtu.be/fxfFMn4VMpQ">https://youtu.be/fxfFMn4VMpQ</a>
and found the workflow a bit more manageable when creating a Firebase project. Sources from video <a href="https://github.com/sveltecasts/006-deploy-sapper-to-firebase-cloud-functions">https://github.com/sveltecasts/006-deploy-sapper-to-firebase-cloud-functions</a>.</p>
<p>First, and then adding in a new Sapper project. I got through it without
any issues, on Windows. Would have much preferred it to be a write-up like
yours though, so here's a summary:</p>
<p>Create a new empty folder, then navigate to it in the VS Code terminal.</p>
<pre><code class="language-bash">firebase init
</code></pre>
<ul>
<li>functions</li>
<li>hosting</li>
<li>use an existing project you've created on Firebase</li>
<li>no ESLint</li>
<li>don't install dependencies now</li>
<li>public directory: functions/static (Sapper project will go into functions folder)</li>
<li>SPA: no</li>
</ul>
<p>Move or rename <code>package.json</code>, and delete <code>.gitignore</code> (sapper will
create these for us later)</p>
<pre><code class="language-bash">cd functions
npx degit sveltejs/sapper-template#rollup --force
</code></pre>
<p>Copy contents of <code>scripts</code> block (Firebase commands) from old <code>package.json</code> into <code>scripts</code> block of new <code>package.json</code> that was generated by Sapper.
Rename Firebase's <code>start</code> command to <code>fb_start</code>.</p>
<p>Copy entire <code>engines</code> block from old to new <code>package.json</code>, and change
node version to 10.</p>
<p>Copy over contents of <code>dependencies</code> and <code>devDependencies</code> blocks.</p>
<p>Delete old <code>package.json</code>, once all Firebase stuff is moved over, and
save the new Sapper one.</p>
<p>Remove polka from dependencies in <code>package.json</code>.</p>
<pre><code class="language-bash">npm install --save express
npm install
</code></pre>
<p><code>server.js</code>:</p>
<ul>
<li>import express instead of polka</li>
<li>change function to: <code>const expressServer = express()</code>...</li>
<li>change <code>.listen</code> to <code>if (dev) { expressServer.listen</code> ... <code>}</code></li>
<li><code>export { expressServer }</code></li>
</ul>
<p><code>index.js</code>:</p>
<ul>
<li><code>const {expressServer} = require('./__sapper__/build/server/server')</code></li>
<li><code>exports.ssr = functions.https.onRequest(expressServer);</code></li>
</ul>
<pre><code class="language-bash">npm run build
npm run dev
</code></pre>
<p>localhost:3000 will show the Firebase default <code>index.html</code> from static
folder, which can be deleted.
Page reload will bring up Sapper project.</p>
<p><code>firebase.json</code>:</p>
<ul>
<li><code>"rewrites": [ { "source": "**", "function": "ssr" }]</code></li>
</ul>
<pre><code class="language-bash">npm run build
firebase deploy
</code></pre>
<p>Visit app and click around, refresh to verify functionality.</p>
<p>Try Postman, send a GET to your project URL.
In output, look for confirmation that content is SSR.</p>
<p><code>package.json</code>:</p>
<ul>
<li><code>"deploy": "npm run build &amp;&amp; firebase deploy"</code></li>
</ul>
<p><code>Nav.svelte</code>:</p>
<ul>
<li>add a new <code>li</code> to the navbar, for a new page</li>
</ul>
<p><code>routes</code>:</p>
<ul>
<li>create new <code>.svelte</code> page, and add some quick HTML content</li>
</ul>
<pre><code class="language-bash">npm run deploy
</code></pre>
<p>Verify new content shows.
Run audit from Chrome dev tools.</p>
<p>&lt;-- snip..</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="angular-bootstrap-firebase"><a class="header" href="#angular-bootstrap-firebase">Angular, bootstrap, firebase</a></h1>
<p>ngx-bootstrap or ng-bootstrap? ng-bootstrap Animation capability is an issue</p>
<p>Should we use material2 instead of bootstrap? some people say matrial2 grid has limited functionality, bootstrap grid system is reasier to use.</p>
<h2 id="articles"><a class="header" href="#articles">articles</a></h2>
<ul>
<li><a href="https://medium.com/codingthesmartway-com-blog/building-an-angular-5-project-with-bootstrap-4-and-firebase-4504ff7717c1">Building An Angular 5 Project with Bootstrap 4 and Firebase</a></li>
<li><a href="https://azmind.com/material-design-vs-bootstrap/">Material Design vs Bootstrap: Which One is Better?</a></li>
<li><a href="https://riptutorial.com/angular-material2">Getting started with angular-material2</a></li>
<li><a href="https://alligator.io/angular/angular-material-2/">angular-material-2 tutorial</a></li>
</ul>
<h2 id="web-based-code-editortext-editor"><a class="header" href="#web-based-code-editortext-editor">web based code editor/text editor</a></h2>
<ul>
<li><a href="https://codemirror.net/">codemirror</a>, source in <a href="https://github.com/codemirror/codemirror">github</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="flutter-apps"><a class="header" href="#flutter-apps">Flutter Apps</a></h1>
<h2 id="setup"><a class="header" href="#setup">Setup</a></h2>
<ul>
<li>
<p>Install git</p>
</li>
<li>
<p>Install npm</p>
</li>
<li>
<p>Install flutter sdk</p>
</li>
<li>
<p>Read carefully the <a href="https://firebase.google.com/docs/cli">firebase CLI docs</a>. Install firebase CLI using npm.</p>
<pre><code class="language-text">npm install -g firebase-tools
</code></pre>
</li>
<li>
<p>log into firebase using the firebase CLI.</p>
<pre><code class="language-text">firebase login
# this will test the successful login
# by listing all your projects
firebase projects:list
</code></pre>
</li>
<li>
<p>Read carefully <a href="https://flutter.dev/docs/get-started/web">flutter web doc</a>. Change channel to dev or beta. Currently I am using dev channel to the latest features.</p>
<pre><code class="language-text">flutter channel dev
flutter upgrade
flutter config --enable-web
</code></pre>
</li>
<li>
<p>Set powershell script policy by running in an <strong>admin powershell</strong> for Windows machine. Otherwise firebase commands will not run.</p>
<pre><code>Set-ExecutionPolicy RemoteSigned
</code></pre>
</li>
</ul>
<h2 id="create-a-flutter-project"><a class="header" href="#create-a-flutter-project">Create a flutter project</a></h2>
<p>Type following flutter cli command in shell to create a starter flutter project.</p>
<pre><code class="language-text">flutter create &lt;app_name&gt;
cd &lt;app_name&gt;
</code></pre>
<p>This creates a folder named '<code>&lt;app_name&gt;</code>' in the current working directory. Next we change working directory to newly created '<code>&lt;app_name&gt;</code>' folder.</p>
<p>Android app, IOS app, and web app target support will be added to the project by the cli command.</p>
<h2 id="add-git-and-setup-for-gitlab"><a class="header" href="#add-git-and-setup-for-gitlab">Add git and setup for gitlab</a></h2>
<pre><code class="language-bash">git init
git add .
git commit -m "initial commit"
git push --set-upstream https://gitlab.com/kkibria/&lt;app_name&gt;.git master
git remote add origin https://gitlab.com/kkibria/&lt;app_name&gt;.git
</code></pre>
<h2 id="add-firebase-to-tha-flutter-project"><a class="header" href="#add-firebase-to-tha-flutter-project">Add firebase to tha flutter project</a></h2>
<h3 id="create-a-firebase-project"><a class="header" href="#create-a-firebase-project">Create a firebase project</a></h3>
<ul>
<li>Go to firebase <a href="https://console.firebase.google.com">console</a>.</li>
<li>Create a new firebase project in firebase console with the <code>&lt;app_name&gt;</code> as the project name.</li>
<li>In the project <code>Setting &gt; General</code> tab select Google Cloud Platform (GCP) resource location.</li>
<li>Select the <code>Database</code> tab. Configure the firestore database into Native mode.</li>
</ul>
<h3 id="add-the-firebase-sdk-support-libraries"><a class="header" href="#add-the-firebase-sdk-support-libraries">Add the firebase SDK support libraries</a></h3>
<p>Add firebase dart libraries to the <code>dependencies</code> section of <code>pubspec.yaml</code> file.</p>
<pre><code class="language-yaml">...

dependencies:
  ...

  # flutter firebase SDK libraries
  # comment out the ones you don't need
  firebase_auth: ^0.15.4
  firebase_messaging: ^6.0.9
  firebase_database: ^3.1.1
  cloud_firestore: ^0.13.2+2
  firebase_storage: ^3.1.1

...
</code></pre>
<h2 id="configure-webapp-with-pwa"><a class="header" href="#configure-webapp-with-pwa">Configure Webapp with PWA</a></h2>
<p>PWA support was already added for web platform by <code>flutter create</code> command. We need to connect flutter web target with a firebase web app.</p>
<ul>
<li>Add an web app to the firebase project.</li>
<li>Add a nickname for the <code>&lt;app_name&gt;_web</code>.</li>
<li>Click on firebase hosting option.</li>
<li>Now click on Register button.</li>
<li>It will show a javascript snippet that will show how to add firebase javascript SDK to <code>web/index.html</code>. For now we wont add the snippet. We will do it later.</li>
</ul>
<h2 id="connect-the-flutter-web-target-with-firebase-webapp"><a class="header" href="#connect-the-flutter-web-target-with-firebase-webapp">Connect the flutter web target with firebase webapp.</a></h2>
<p>Run following firebase CLI command from inside &lt;app_name&gt; directory.</p>
<pre><code class="language-text">firebase init
</code></pre>
<p>Select either <code>Realtime Database</code> or <code>Firestore</code>, or both as necessary. Both can be used if there is a need but probably not common. Check the rest of the options as necessary as well. Hit enter.</p>
<p>Select <code>Exiting project</code> and hit enter. Then select the firebase project you just created.</p>
<p>Note: selecting firestore is giving index trouble, so I selected Realtime.</p>
<p>Select all defaults except for the public directory, type <code>build/web</code>.</p>
<h2 id="android-app-from-flutter"><a class="header" href="#android-app-from-flutter">Android app from flutter</a></h2>
<p>Todo......</p>
<h2 id="ios-app-from-flutter"><a class="header" href="#ios-app-from-flutter">IOS app from flutter</a></h2>
<p>Todo.....</p>
<h2 id="web-app-from-flutter"><a class="header" href="#web-app-from-flutter">Web app from flutter</a></h2>
<p>We have to configure the web template file. When we build the web app, the web template file gets copied over to the <code>build/web</code> folder.</p>
<h3 id="update-the-flutter-web-template"><a class="header" href="#update-the-flutter-web-template">Update the flutter web template</a></h3>
<p><code>firebase init</code> will build an <code>index.html</code> file in <code>build/web</code> directory. You will see the firebase javascript SDK snippet we saw earlier, is already included in this <code>index.html</code>.</p>
<p>However, every time flutter will build our web app this file will be overridden from a template file.
Therefore, copy the firebase relevant portion in this file to the web template <code>web/index.html</code> file to update the template. Next time we build the web target with <code>flutter build web</code> command the javascript SDK snippet will persist.</p>
<p>The template will end up looking something like the following,</p>
<pre><code class="language-html">&lt;head&gt;
  ...
  &lt;title&gt;my awesome pwa app&lt;/title&gt;
  &lt;link rel="manifest" href="/manifest.json"&gt;
  ...
  &lt;!-- update the version number as needed --&gt;
  &lt;script defer src="/__/firebase/7.8.2/firebase-app.js"&gt;&lt;/script&gt;
  &lt;!-- include only the Firebase features as you need --&gt;
  &lt;!-- comment out the ones you don't need --&gt;
  &lt;script defer src="/__/firebase/7.8.2/firebase-auth.js"&gt;&lt;/script&gt;
  &lt;script defer src="/__/firebase/7.8.2/firebase-database.js"&gt;&lt;/script&gt;
  &lt;script defer src="/__/firebase/7.8.2/firebase-firestore.js"&gt;&lt;/script&gt;
  &lt;script defer src="/__/firebase/7.8.2/firebase-messaging.js"&gt;&lt;/script&gt;
  &lt;script defer src="/__/firebase/7.8.2/firebase-storage.js"&gt;&lt;/script&gt;
  &lt;!-- initialize the SDK after all desired features are loaded --&gt;
  &lt;script defer src="/__/firebase/init.js"&gt;&lt;/script&gt;
  ...
&lt;/head&gt;
</code></pre>
<h3 id="building-the-web-app-and-host-it-in-firebase-server"><a class="header" href="#building-the-web-app-and-host-it-in-firebase-server">Building the web app and host it in firebase server.</a></h3>
<ul>
<li><code>flutter build web</code>.</li>
<li><code>firebase serve</code></li>
<li><code>firebase deploy</code></li>
</ul>
<p>... to be continued</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="flutter-sign-in-for-your-users"><a class="header" href="#flutter-sign-in-for-your-users">Flutter Sign-in for your users</a></h1>
<h2 id="google-sign-in-1"><a class="header" href="#google-sign-in-1">Google sign in</a></h2>
<ul>
<li>Firebase <a href="topics/firebase#google-sign-in">Google sign in</a></li>
</ul>
<h2 id="email-link-sign-in-1"><a class="header" href="#email-link-sign-in-1">Email link sign in</a></h2>
<ul>
<li>Article <a href="https://medium.com/@ayushsahu_52982/passwordless-login-with-firebase-flutter-f0819209677">Flutter: How to implement Password-less login with Firebase</a>.</li>
<li>Article <a href="https://medium.com/@diegoveloper/flutter-firebase-dynamic-link-6f1b79278ce0">Flutter : Firebase Dynamic Link</a>.</li>
</ul>
<h2 id="new-notes"><a class="header" href="#new-notes">New notes</a></h2>
<ul>
<li><a href="https://proandroiddev.com/flutter-passwordless-authentication-a-guide-for-phone-email-login-6759252f4e">https://proandroiddev.com/flutter-passwordless-authentication-a-guide-for-phone-email-login-6759252f4e</a></li>
<li><a href="https://medium.com/@ayushsahu_52982/passwordless-login-with-firebase-flutter-f0819209677">https://medium.com/@ayushsahu_52982/passwordless-login-with-firebase-flutter-f0819209677</a></li>
<li><a href="https://medium.com/@levimatheri/flutter-email-verification-and-password-reset-db2eed893d1d">https://medium.com/@levimatheri/flutter-email-verification-and-password-reset-db2eed893d1d</a></li>
<li>For WebApps email link login needs to be handled somewhat differently than regular ios or android app,
<a href="https://firebase.google.com/docs/auth/web/email-link-auth">https://firebase.google.com/docs/auth/web/email-link-auth</a></li>
</ul>
<p>It is also important to note that email verification and password reset links through email will require similar approach in flutter WebApps. We have to figure out how to handle those in the same dart code for all platforms.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="flutter-matters"><a class="header" href="#flutter-matters">Flutter matters</a></h1>
<h2 id="flutter-text-and-rendering-features"><a class="header" href="#flutter-text-and-rendering-features">Flutter Text and rendering features</a></h2>
<ul>
<li><a href="https://www.raywenderlich.com/4562681-flutter-text-rendering">flutter-text-rendering</a></li>
<li><a href="https://github.com/flutter/flutter/blob/master/packages/flutter/lib/src/widgets/framework.dart">framework.dart</a></li>
<li><a href="https://github.com/flutter/flutter/blob/master/packages/flutter/lib/src/widgets/text.dart">text.dart</a></li>
<li><a href="https://github.com/flutter/flutter/blob/master/packages/flutter/lib/src/widgets/basic.dart">basic.dart</a></li>
<li><a href="https://github.com/flutter/flutter/tree/master/examples/layers">Examples of Flutter's layered architecture</a></li>
</ul>
<h2 id="medium-articles"><a class="header" href="#medium-articles">Medium articles</a></h2>
<ul>
<li><a href="https://medium.com/flutter-community/more-than-a-flutter-web-app-is-a-full-flutter-website-c6bb210b1f16">full-flutter-website</a></li>
<li><a href="https://medium.com/flutter/how-to-write-a-flutter-web-plugin-5e26c689ea1">flutter-web-plugin</a></li>
</ul>
<h2 id="youtube-videos"><a class="header" href="#youtube-videos">YouTube videos</a></h2>
<ul>
<li><a href="https://www.youtube.com/watch?v=CXedqMlLo7M">Widgets 101</a></li>
<li><a href="https://www.youtube.com/watch?v=UUfXWzp0-DU">Flutter's Rendering Pipeline</a></li>
<li><a href="https://www.youtube.com/watch?v=dkyY9WCGMi0">The Mahogany Staircase - Flutter's Layered Design</a></li>
</ul>
<h2 id="firebase-auth-sample-1"><a class="header" href="#firebase-auth-sample-1">Firebase Auth sample</a></h2>
<ul>
<li><a href="https://github.com/FirebaseExtended/flutterfire/tree/master/packages/firebase_auth/firebase_auth/example">firebase auth example</a></li>
<li>Medium <a href="https://medium.com/@greg.perry/auth-in-flutter-97275b29b550">auth-in-flutter</a></li>
</ul>
<h2 id="firebase-auth-articles-1"><a class="header" href="#firebase-auth-articles-1">Firebase Auth articles</a></h2>
<ul>
<li><a href="https://proandroiddev.com/flutter-passwordless-authentication-a-guide-for-phone-email-login-6759252f4e">Flutter Password-less Authentication — a guide for phone &amp; email login</a></li>
<li><a href="https://medium.com/@ayushsahu_52982/passwordless-login-with-firebase-flutter-f0819209677">Flutter: How to implement Password-less login with Firebase</a></li>
<li><a href="https://medium.com/@levimatheri/flutter-email-verification-and-password-reset-db2eed893d1d">Flutter: Email verification and password reset</a></li>
</ul>
<h2 id="articles-on-rendering"><a class="header" href="#articles-on-rendering">Articles on rendering</a></h2>
<ul>
<li><a href="https://github.com/flutter/flutter/wiki/The-Engine-architecture">The Engine architecture</a></li>
<li><a href="https://medium.com/saugo360/flutters-rendering-engine-a-tutorial-part-1-e9eff68b825d">Flutter’s Rendering Engine: A Tutorial </a></li>
<li><a href="https://www.freecodecamp.org/news/all-you-need-to-know-about-tree-data-structures-bceacb85490c/">Everything you need to know about tree data structures</a></li>
<li><a href="https://medium.com/@romainguy/androids-font-renderer-c368bbde87d9">Android’s Font Renderer</a></li>
</ul>
<h2 id="flutter-renderobject--painting"><a class="header" href="#flutter-renderobject--painting">Flutter RenderObject / painting</a></h2>
<ul>
<li><a href="https://nicksnettravels.builttoroam.com/create-a-flutter-widget/">How to Create a Flutter Widget Using a RenderObject</a></li>
<li><a href="https://stackoverflow.com/questions/45130497/creating-a-custom-clock-widget-in-flutter/45133660">Creating a custom clock widget in Flutter</a></li>
</ul>
<h2 id="flutter-ui-design-tools"><a class="header" href="#flutter-ui-design-tools">Flutter UI design tools</a></h2>
<ul>
<li><a href="https://github.com/Norbert515/flutter_ide">flutter IDE</a></li>
<li><a href="https://medium.com/@pmutisya/flutter-studio-version-2-41cce10fcf3d">flutter studio</a>, no source code! he has two apps, <a href="https://flutterstudio.app">https://flutterstudio.app</a> and <a href="https://devicedb.app/">https://devicedb.app/</a>.</li>
<li><a href="https://github.com/thebuggycoder/flutterstudio">another flutter studio project</a>,
has source code but broken code at the moment.</li>
</ul>
<h2 id="dart-serialization"><a class="header" href="#dart-serialization">Dart serialization</a></h2>
<ul>
<li><a href="https://medium.com/flutter-community/serializing-your-object-in-flutter-ab510f0b8b47">serializing-your-object-in-flutter</a></li>
</ul>
<h2 id="page-routing"><a class="header" href="#page-routing">Page Routing</a></h2>
<ul>
<li>Flutter <a href="https://medium.com/flutter-community/advance-url-navigation-for-flutter-web-d8b5f2d424e6">web routing with parameters</a></li>
</ul>
<h2 id="dart-code-generation"><a class="header" href="#dart-code-generation">dart code generation</a></h2>
<ul>
<li><a href="https://medium.com/flutter-community/part-1-code-generation-in-dart-the-basics-3127f4c842cc">[Part 1] Code generation in Dart: the basics</a></li>
<li><a href="https://medium.com/flutter-community/part-2-code-generation-in-dart-annotations-source-gen-and-build-runner-bbceee28697b">[Part 2] Code generation in Dart: Annotations, source_gen and build_runner</a></li>
<li><a href="https://github.com/jorgecoca/todo_reporter.dart">todo_reporter.dart in github</a></li>
</ul>
<h2 id="flutter-markdown-editing"><a class="header" href="#flutter-markdown-editing">Flutter markdown editing</a></h2>
<p>We can use this editor as a basis for markdown editing</p>
<ul>
<li><a href="https://github.com/memspace/zefyr">Soft and gentle rich text editing</a></li>
<li><a href="https://learningflutter.net/flutter-markdown-editor/">Markdown Editor With Flutter</a>.
This is incomplete, but at least the idea is there for us to examine.</li>
</ul>
<h2 id="built_value-library"><a class="header" href="#built_value-library">Built_Value library</a></h2>
<ul>
<li><a href="https://medium.com/dartlang/darts-built-value-for-immutable-object-models-83e2497922d4">Dart’s built_value for Immutable Object Models</a></li>
<li><a href="https://medium.com/dartlang/darts-built-collection-for-immutable-collections-db662f705eff">Dart’s built_collection for Immutable Collections</a></li>
<li><a href="https://www.stacksecrets.com/flutter/introduction-to-built_value-library-in-dart">Introduction To Built_Value Library In Dart</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="textual-contents"><a class="header" href="#textual-contents">Textual Contents</a></h1>
<p>Textual content authoring in html is quite tedious and alternative authoring is
preferred for web sites. As such,
<a href="https://www.markdownguide.org/getting-started/">markdown</a> format has gathered
popularity and is being used quite widely. This format is really just a simple
text file that can be produced by any text editor.</p>
<p>We will look into Content Management with markdown for web sites. These sites
can contain a collection of markdown files. Content Management allows them to be
organized and navigated n a useful way. They are transformed to html before they
are rendered in a browser.</p>
<p>However, wherever you will host the content, their flow is something important
to understand clearly before you start. For instance, we can talk about github
pages later.</p>
<h2 id="vs-code-to-edit-markdown-files"><a class="header" href="#vs-code-to-edit-markdown-files">VS code to edit markdown files</a></h2>
<p>Install <a href="https://stkb.github.io/Rewrap/">Rewrap</a> vscode plugin. &lt;Alt+Q&gt; will
hard wrap and unwrap your content. Makes life lot easier when you are copy
pasting excerpts from somewhere else that comes aa long line of text. Also helps
writing comments in code by wrapping long comments. Read it's documentation.</p>
<h2 id="html-to-markdown-conversion"><a class="header" href="#html-to-markdown-conversion">html to markdown conversion</a></h2>
<p>We may need to convert existing html to markdown.
<a href="https://github.com/suntong/html2md"><code>html2md</code></a> is a tool
written in golang. Works nice!</p>
<h2 id="hosting-content-in-github-pages"><a class="header" href="#hosting-content-in-github-pages">Hosting Content in github pages</a></h2>
<p>Github pages is quite popular for hosting as it is free and git controlled.
Although there are several options available for github pages, there is a idea
of separation of concern behind those options. They implemented the idea by
using two different git branches. One for textual content like markdown source
files and the other for generated html. Usually, the markdown source file lives
in the default branch <code>master</code> as we may edit those files more frequently. When
we are ready to deploy our content, the generated html will live in another
branch, lets call it <code>gh-pages</code>. github allows configuring the repository such
that it's web server will check out html from <code>gh-pages</code> branch and use.</p>
<h3 id="scaffolding-setup"><a class="header" href="#scaffolding-setup">Scaffolding setup</a></h3>
<p>Knowing this, we will need to scaffold our project in way so that it is
convenient to manage. As such, I will suggest one way that felt most convenient
for me.</p>
<pre><code class="language-text">my_project (folder)
   +-- .git (points to master branch)
   +-- .gitignore (set to ignore gh-pages folder)
   +-- (markdown contents)
   +-- deploy.sh (used for deploying generated content)
   +-- gh-pages (folder)
         +-- .git (points to gh-pages branch)
         +-- (generated html contents)
</code></pre>
<p>Using terminal, create a project folder and open it in vscode,</p>
<pre><code class="language-bash">mkdir my_project
cd my_project
echo "gh-pages" &gt; .gitignore
mkdir gh-pages

# This will create the master branch
git init
git add .
git commit -m "first commit" 

code .
</code></pre>
<h3 id="create-repository-in-github-and-publish-the-default-branch"><a class="header" href="#create-repository-in-github-and-publish-the-default-branch">Create repository in github and publish the default branch</a></h3>
<p>With vscode, in source control panel, create a github repository and push
everything we have so far to github.</p>
<p>If you are not using vscode, then you can manually create github repository and
push the <code>master</code> branch.</p>
<h3 id="create-and-publish-the-html-branch"><a class="header" href="#create-and-publish-the-html-branch">Create and publish the html branch</a></h3>
<p>Now we create the <code>gh-pages</code> branch.
Following bash script will do this,</p>
<pre><code class="language-bash">URL=`git remote get-url origin`
pushd gh-pages
echo "gh-pages site" &gt; index.html
git init
git remote add origin $URL

# create gh-pages branch
git checkout -b gh-pages
git add .
git commit -m "initial commit"

# push the branch to github
git push origin gh-pages
popd
</code></pre>
<p>Now the scaffolding is ready. We need to create a script that will deploy
generated content.</p>
<h3 id="setup-a-deploy-script"><a class="header" href="#setup-a-deploy-script">Setup a deploy script</a></h3>
<p><code>deploy.sh</code></p>
<pre><code class="language-bash">command_to_generate_html
pushd gh-pages
git add .
git commit -m "deploy"
git push origin gh-pages
popd
</code></pre>
<p>If you are in windows, you can create equivalent powershell or command line
scripts.</p>
<h3 id="setup-github-to-pick-up-the-branch-and-folder"><a class="header" href="#setup-github-to-pick-up-the-branch-and-folder">Setup github to pick up the branch and folder</a></h3>
<p>In github repo settings go to <code>github pages</code> and setup branch to <code>gh-pages</code> and
change folder to <code>docs</code> and note the public url they provide for the site.</p>
<h3 id="create-and-publish-the-html-branch-powershell-version"><a class="header" href="#create-and-publish-the-html-branch-powershell-version">Create and publish the html branch (powershell version)</a></h3>
<pre><code>$url = git remote get-url origin
mkdir gh-pages
Set-Location gh-pages
echo "gh-pages site" &gt; index.html
git init
git remote add origin $url

git checkout -b gh-pages
git add .
git commit -m "initial commit"

git push origin gh-pages
Set-Location ..
</code></pre>
<h3 id="setup-a-deploy-script-powershell-version"><a class="header" href="#setup-a-deploy-script-powershell-version">Setup a deploy script (powershell version)</a></h3>
<p><code>deploy.ps1</code></p>
<pre><code>command_to_generate_html
Set-Location gh-pages
git add .
git commit -m "deploy"
git push origin gh-pages
Set-Location ..
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mdbook"><a class="header" href="#mdbook">Mdbook</a></h1>
<p>To do a new book, first you need to install <code>rust</code>.</p>
<h2 id="install-mdbook-and-the-front-matter-preprocessor"><a class="header" href="#install-mdbook-and-the-front-matter-preprocessor">Install mdbook and the front matter preprocessor</a></h2>
<p>With this preprocessor we can support a subset of Yaml in front matter.</p>
<pre><code class="language-bash">cargo install mdbook
cargo install --git https://github.com/kkibria/mdbook-frntmtr.git
</code></pre>
<h2 id="hosting-at-github-pages"><a class="header" href="#hosting-at-github-pages">Hosting at github pages</a></h2>
<p>For static sites, github pages is a great choice. It is free and easy to use.
Generate the scaffolding using instructions from <a href="topics/text-content.html#hosting-content-in-github-pages">Hosting Content in github pages</a> section.</p>
<h2 id="initialize-project-folder"><a class="header" href="#initialize-project-folder">Initialize Project folder</a></h2>
<pre><code class="language-bash">cd my_project
mdbook init
mkdir src
</code></pre>
<h3 id="setup-booktoml"><a class="header" href="#setup-booktoml">Setup <code>book.toml</code></a></h3>
<p>add following,</p>
<pre><code>[book]
src = "src"

[build]
build-dir = "gh-pages/docs"

[preprocessor.frntmtr]
command = "mdbook-frntmtr"
</code></pre>
<h3 id="add-content"><a class="header" href="#add-content">Add content</a></h3>
<p>Start the local server for development,</p>
<pre><code>mdbook serve -o
</code></pre>
<p>Now modify or add contents in <code>src</code> folder. It will live update. Once you are happy with the
content you can deploy.</p>
<h3 id="deploy-to-github-pages-powershell-version"><a class="header" href="#deploy-to-github-pages-powershell-version">Deploy to github pages (powershell version)</a></h3>
<p><code>deploy.ps1</code></p>
<pre><code>mdbook build
Set-Location gh-pages
git add .
git commit -m "deploy"
git push origin gh-pages
Set-Location ..
</code></pre>
<p>Now the site will be served by github pages.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hugo"><a class="header" href="#hugo">Hugo</a></h1>
<h2 id="tutorial"><a class="header" href="#tutorial">tutorial</a></h2>
<ul>
<li><a href="https://www.youtube.com/playlist?list=PLLAZ4kZ9dFpOnyRlyS-liKL5ReHDcj4G3">Hugo - Static Site Generator | Tutorial</a>.</li>
</ul>
<h2 id="how-to-build-hugo-theme"><a class="header" href="#how-to-build-hugo-theme">How to build Hugo Theme</a></h2>
<ul>
<li><a href="https://www.zeolearn.com/magazine/develop-a-theme-for-hugo">Develop a Theme for Hugo</a></li>
</ul>
<h2 id="adding-tailwind"><a class="header" href="#adding-tailwind">Adding tailwind</a></h2>
<ul>
<li><a href="https://flaviocopes.com/tailwind-setup/">How to setup Tailwind with PurgeCSS and PostCSS</a></li>
</ul>
<h2 id="install-hugo"><a class="header" href="#install-hugo">Install Hugo</a></h2>
<p>First install google golang from their <a href="https://golang.org/dl/">website</a> appropriate to your computer.</p>
<p>Then build <code>hugo</code> from source code using their github repo.</p>
<pre><code class="language-bash">mkdir $HOME/src
cd $HOME/src
git clone https://github.com/gohugoio/hugo.git
cd hugo
go install --tags extended
</code></pre>
<blockquote>
<p>If you are a Windows user, substitute the <code>$HOME</code> environment variable above with <code>%USERPROFILE%</code>.</p>
</blockquote>
<h2 id="create-a-site-for-github-pages"><a class="header" href="#create-a-site-for-github-pages">Create a site for github pages</a></h2>
<p>Go to github and create a repo. Get the git https clone URL.</p>
<p>Now create a hugo directory,</p>
<pre><code class="language-bash">mkdir &lt;repo_name&gt;
cd my repo
hugo new site .
git remote add origin &lt;repo_clone_url&gt;
git push -u origin master
</code></pre>
<p>This will create the scaffolding for hugo. Now we will get a theme. Go to the themes github page and get the clone url.</p>
<pre><code class="language-bash">cd themes
git clone &lt;theme_clone_url&gt;
cd ..
</code></pre>
<p>This wll create a directory with same name as the theme. Now copy the theme config to the our config.</p>
<pre><code class="language-bash">cp themes/&lt;theme_name&gt;/exampleSite/config.toml .
</code></pre>
<p>Now edit the config.toml file and delete the <code>themesdir</code> as appropriate.</p>
<p>At this point you can add content, and do your own theme.</p>
<blockquote>
<p>Need to play with themes.</p>
</blockquote>
<h1 id="render-math"><a class="header" href="#render-math">Render Math</a></h1>
<p><a href="https://eankeen.github.io/blog/posts/render-latex-with-katex-in-hugo-blog/">KaTex in Hugo</a></p>
<h1 id="integrate-slides-capability"><a class="header" href="#integrate-slides-capability">Integrate slides capability</a></h1>
<ul>
<li><a href="https://github.com/kkibria/io-2012-slides">io-2012-slides</a></li>
<li><a href="https://github.com/kkibria/html5slides">html5slides</a></li>
</ul>
<h1 id="integrate-pdf-generation"><a class="header" href="#integrate-pdf-generation">Integrate PDF generation</a></h1>
<ul>
<li><a href="https://github.com/tanakh/pandoc-html5slide">Using pandoc</a></li>
<li><a href="https://github.com/wkhtmltopdf">wkhtmltopdf, Convert HTML to PDF using Qt Webkit engine</a></li>
<li><a href="https://weasyprint.readthedocs.io">Weasyprint a python tool</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="jekyll"><a class="header" href="#jekyll">Jekyll</a></h1>
<h2 id="jekyll-filter"><a class="header" href="#jekyll-filter">Jekyll filter</a></h2>
<p>Filters are to be saved in <code>_plugins</code> directory.</p>
<pre><code class="language-ruby">module Jekyll
  module BibFilter
    REGEXP = /\bjournal\b[\w\s= \{\-\.\,\(\)\-\:\+\'\/\..]+\},?/

    def bibFilter(bib)
      #filter text using regexp
      str = "#{bib}".gsub(REGEXP,'')
      #print filtered text
      "#{str}"
    end
 end
end

Liquid::Template.register_filter(Jekyll::BibFilter)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="beyond-textual-contents"><a class="header" href="#beyond-textual-contents">Beyond Textual Contents</a></h1>
<h2 id="javascript-libraries-that-can-be-generate-content"><a class="header" href="#javascript-libraries-that-can-be-generate-content">Javascript libraries that can be generate content</a></h2>
<p>Need to explore the followings,</p>
<ul>
<li>For math expression <a href="https://github.com/KaTeX/KaTeX">https://github.com/KaTeX/KaTeX</a> is a good library to provide client side rendering.</li>
<li>For flowcharts <a href="https://flowchart.js.org">https://flowchart.js.org</a> also seems like a great library.</li>
<li>For building graphs or networks, <a href="https://js.cytoscape.org">https://js.cytoscape.org</a></li>
<li>10+ JavaScript libraries to draw your own diagrams <a href="https://modeling-languages.com/javascript-drawing-libraries-diagrams">https://modeling-languages.com/javascript-drawing-libraries-diagrams</a>.</li>
<li><a href="https://svgjs.com/docs/3.0">https://svgjs.com/docs/3.0</a> svg drawing library that provides animation.</li>
<li><a href="https://mermaid-js.github.io">https://mermaid-js.github.io</a> support flowcharts.</li>
<li><a href="https://ivanceras.github.io/content/Svgbob">https://ivanceras.github.io/content/Svgbob</a> ascii diagram to svg.</li>
</ul>
<h2 id="gitbook"><a class="header" href="#gitbook">Gitbook</a></h2>
<ul>
<li><a href="https://medium.com/@rebeccapeltz/publish-your-book-online-with-gitbook-fc0ce9b7f12">Publish Your Book Online with GitBook</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="community-portal"><a class="header" href="#community-portal">Community portal</a></h1>
<h2 id="building-a-multi-community-portal"><a class="header" href="#building-a-multi-community-portal">building a multi-community portal</a></h2>
<p>There are lot of heavy duty social networking sites around us. For a learning
exercise, lets say we are building a social site that hosts multiple
communities. This site will have many registered users. Any of the user can
start a community and he will be the owner of the community. The community will
have a portal and owner can configure the look and feel of the portal. Other
users can join the community and some of them will be given the right to author
in the portal. How would we structure our data for such a site?</p>
<h2 id="nosql-databse"><a class="header" href="#nosql-databse">NOSQL databse</a></h2>
<p>Lets assume the data will be saved in a NOSQL databse.</p>
<p>The structure will look like,</p>
<pre><code>users:
    userid:
</code></pre>
<blockquote>
<p>To be continued...</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="go-language"><a class="header" href="#go-language">Go language</a></h1>
<h2 id="vscode-powershell-setup"><a class="header" href="#vscode-powershell-setup">vscode powershell setup</a></h2>
<p>The powershell does not have the environment variables setup for <code>go</code> when it starts.
First setup the powershell startup as shown in
<a href="topics/vscode#powershell-setup">Powershell setup</a>.</p>
<p>In your go project directory create <code>.psrc.ps1</code> and put the following to get the
environment variables setup.</p>
<pre><code class="language-bash">$env:Path = [System.Environment]::GetEnvironmentVariable("Path","Machine")
$env:GOPATH = [Environment]::GetEnvironmentVariable("GOPATH","User")
</code></pre>
<p>Alternatively you can setup your custom go binary path and <code>GOPATH</code> in this file as well.</p>
<h2 id="server"><a class="header" href="#server">Server</a></h2>
<ul>
<li><a href="https://github.com/eranyanay/1m-go-websockets">https://github.com/eranyanay/1m-go-websockets</a></li>
</ul>
<h2 id="desktop"><a class="header" href="#desktop">desktop</a></h2>
<ul>
<li><a href="https://github.com/zserge/lorca">https://github.com/zserge/lorca</a></li>
<li><a href="https://youtu.be/p_7MfQZTy34">https://youtu.be/p_7MfQZTy34</a></li>
<li><a href="https://github.com/webview/webview">https://github.com/webview/webview</a></li>
<li><a href="https://github.com/wailsapp/wails">https://github.com/wailsapp/wails</a></li>
<li><a href="https://youtu.be/Dg9rUXxNV-c">https://youtu.be/Dg9rUXxNV-c</a></li>
<li><a href="https://github.com/asticode/go-astilectron">https://github.com/asticode/go-astilectron</a></li>
</ul>
<blockquote>
<p>TODO: So far, go-astilectron seems most promising for serious development.
But, astilectron is using tcp connection for ipc. Instead path based connection
will much be much faster as long as both endpoints are within the same host which
is the most typical case. Under the hood path based connection uses unix domain
socket or windows named pipe depending on the o/s. As such the go side need to adjust
for path based connection.</p>
</blockquote>
<h2 id="using-dbus"><a class="header" href="#using-dbus">using dbus</a></h2>
<h2 id="python-to-go"><a class="header" href="#python-to-go">python to go</a></h2>
<ul>
<li><a href="https://github.com/google/grumpy">https://github.com/google/grumpy</a></li>
<li><a href="https://youtu.be/m335zpefXFE">https://youtu.be/m335zpefXFE</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="java-development"><a class="header" href="#java-development">Java development</a></h1>
<h2 id="maven"><a class="header" href="#maven">Maven</a></h2>
<p>Maven is a great build tool, running maven build will compile, do all sorts of tasks and create the project target.</p>
<p>Maven build will store target jar and download all the dependencies (jars, plugin jars, other artifacts) for later use in the local repository. Maven supports 3 types of repository for dependencies:</p>
<ul>
<li><strong>Local</strong> – Repository on local Dev machine.</li>
<li><strong>Central</strong> – Repository provided by Maven community.</li>
<li><strong>Remote</strong> – Organization owned custom repository.</li>
</ul>
<h3 id="the-local-repository"><a class="header" href="#the-local-repository">The Local Repository</a></h3>
<p>Usually this is a folder named <code>.m2</code> in users home directory.
The default path to this folder,</p>
<ul>
<li>Windows: <code>C:\Users\&lt;User_Name&gt;\.m2</code> i.e. <code>%UserProfile%\.m2</code>.</li>
<li>Linux: <code>/home/&lt;User_Name&gt;/.m2</code> i.e. <code>~/.m2</code>.</li>
<li>Mac: <code>/Users/&lt;user_name&gt;/.m2</code>  i.e. <code>~/.m2</code>.</li>
</ul>
<p>maven config file can change the default. The config file is located at the following path
<code>&lt;Maven-install-Path&gt;/conf/settings.xml</code>.</p>
<p>Reading materials:</p>
<ul>
<li><a href="https://www.eviltester.com/2017/10/maven-local-dependencies.html">Simple ways to add and work with a <code>.jar</code> file in your local maven setup</a>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="javascript-library"><a class="header" href="#javascript-library">Javascript library</a></h1>
<h2 id="using-require-like-a-node-package-in-browser"><a class="header" href="#using-require-like-a-node-package-in-browser">Using require like a node package in browser</a></h2>
<p>Lets take an example where we will use node package in a <code>commonjs</code> javascript file. This kind of setup would work in a node environment without
problem. But in a browser using <code>require</code> would normally be a problem. We can use the following method to make it work in browser.</p>
<p>In this example we will instantiate jquery with <code>require</code> as a node module. First get jquery module using npm. Then make <code>test.js</code> module as following.
At the end of the file we will export the API.</p>
<pre><code class="language-javascript">var $ = require("jquery");

function getName () {
  return 'Jim';
};

function getLocation () {
  return 'Munich';
};

function injectEl() {
  // wait till document is ready 
  $(function() {
    $("&lt;h1&gt;This text was injected using jquery&lt;/h1&gt;").appendTo(".inject-dev");
  });
}

const dob = '12.01.1982';

module.exports.getName = getName;
module.exports.getLocation = getLocation;
module.exports.dob = dob;
module.exports.injectEl = injectEl;
</code></pre>
<p>Now wrap everything up in a single module.
You have two options,</p>
<ul>
<li>Use <code>browserify</code>.</li>
<li>Use <code>rollup</code>.</li>
</ul>
<h2 id="use-browserify"><a class="header" href="#use-browserify">Use browserify</a></h2>
<p>Assuming you have already installed <code>browserify</code> and <code>js-beautify</code>, run them. If node builtins are used your <code>commonjs</code> file, <code>browserify --s</code> option will include them.</p>
<pre><code class="language-bash">browserify test.js --s test -o gen-test.js
#optional only if you like to examine the generated file.
js-beautify gen-test.js -o pretty-gen-test.js
</code></pre>
<p>Check the outputs, you can see jquery has already been included in the output.</p>
<p>Now we can load <code>gen-test.js</code> in the browser in an html file. It also works with svelte. Following shows using it in a svelte source.</p>
<pre><code class="language-html">&lt;script&gt;
  import { onMount } from 'svelte';
  import test from "./gen-test.js"

  let name = test.getName();
  let location = test.getLocation();
  let dob = test.dob;

  test.injectEl();
&lt;/script&gt;

&lt;main&gt;
  &lt;h1&gt;Hello {name}!&lt;/h1&gt;
  &lt;p&gt;Location: {location}, dob: {dob}&lt;/p&gt;
  &lt;div class="inject-dev"&gt;&lt;/div&gt;
&lt;/main&gt;
</code></pre>
<p>I have built this as an npm project in <a href="https://github.com/kkibria/svelte-js-library">github</a> with svelte template.</p>
<h2 id="use-rollup"><a class="header" href="#use-rollup">Use rollup</a></h2>
<p>If you have installed <code>rollup</code> this can also be done with added benefit of <a href="topics/jslib.html#tree-shaking-with-rollup">tree shaking</a>. <code>rollup.config.js</code> can be configured as,</p>
<pre><code class="language-javascript">import resolve from '@rollup/plugin-node-resolve';
import commonjs from '@rollup/plugin-commonjs';
import json from '@rollup/plugin-json';
export default {
  ...
  plugins: [
    resolve({
      browser: true,

      // only if you need rollup to look inside
      // node_modules for builtins
      preferBuiltins: false, 

      dedupe: ['svelte']
    }),
    json(),
    commonjs()
  ]
}
</code></pre>
<h3 id="node-builtins"><a class="header" href="#node-builtins">node builtins</a></h3>
<p>Read <a href="https://github.com/rollup/plugins/tree/master/packages/node-resolve">node-resolve documentation</a> carefully.
If node builtins are used your <code>commonjs</code> file, they will be missing. You have two options,</p>
<ul>
<li>Import the individual builtin packages with npm, if you have only a few missing. Set <code>preferBuiltins</code> to <code>false</code>
so that rollup can get them from <code>node_modules</code>.</li>
<li>All node builtins can be included using npm packages <code>rollup-plugin-node-builtins</code> and <code>rollup-plugin-node-globals</code> with rollup. Set <code>preferBuiltins</code> to <code>true</code> so that rollup will use builtins from these instead. You can remove <code>preferBuiltins</code> altogether since<br />
it default value is <code>true</code> anyways.</li>
</ul>
<h2 id="create-javascript-for-older-browsers"><a class="header" href="#create-javascript-for-older-browsers">Create javascript for older browsers</a></h2>
<p>The way to fix language version problems is transpiling the javascript code using <a href="https://babeljs.io/"><strong>babel</strong></a>. To make sure transpiled code works on older browser, we have to test it on different browsers to see if and why it fails. Cross browser testing sites like <a href="https://www.lambdatest.com">https://www.lambdatest.com</a> or <a href="https://saucelabs.com/">https://saucelabs.com/</a> are helpful but can be expansive depending on situation. Check the following to get an insight,</p>
<ul>
<li><a href="https://github.com/jamiebuilds/babel-handbook/blob/master/translations/en/">babel Handbook</a>.</li>
<li>Browser support for javascript, <a href="https://kangax.github.io/compat-table/es6/">ECMAScript compatibility table</a>.</li>
<li>Youtube video, <a href="https://youtu.be/MzZilaM16oY">Do you really need BABEL to compile JavaScript</a>?</li>
<li><a href="https://medium.com/@makk.bit/babel-under-the-hood-63e3fb961243">Babel under the hood</a>.</li>
</ul>
<h3 id="babel-with-rollup"><a class="header" href="#babel-with-rollup">babel with rollup</a></h3>
<p>Read <a href="https://github.com/rollup/plugins/tree/master/packages/babel">rollup babel plugin documentation</a> carefully to understand how to configure the plugin. This plugin
will invoke babel.
Next we need to understand how to configure babel, read <a href="https://babeljs.io/docs/en/configuration">Babel configuration documentation</a>.</p>
<ul>
<li><a href="https://blog.az.sg/posts/svelte-and-ie11/">Making a svelte app compatible with Internet Explorer 11</a>.</li>
<li><a href="http://simey.me/svelte3-rollup-and-babel7/">Svelte3, Rollup and Babel7</a>.</li>
</ul>
<h3 id="babel-with-webpack"><a class="header" href="#babel-with-webpack">babel with webpack</a></h3>
<ul>
<li><a href="https://dillinger.io/">Dillinger</a> is a good example, Github <a href="https://github.com/joemccann/dillinger">source</a>. I tried their site on IE11 and it worked fine.</li>
<li>Good info on using babel in the Github <a href="https://github.com/babel/babel-loader">source</a> readme of the webpack plugin <code>babel-loader</code>.</li>
<li><a href="https://medium.com/@ramez.aijaz/transpile-typescript-to-es5-using-babel-and-webpack-f3b72a157399">Support IE 11 Using Babel and Webpack</a></li>
</ul>
<h2 id="polyfill-articles"><a class="header" href="#polyfill-articles">Polyfill articles</a></h2>
<ul>
<li><a href="https://medium.com/hackernoon/polyfills-everything-you-ever-wanted-to-know-or-maybe-a-bit-less-7c8de164e423">Polyfills: everything you ever wanted to know, or maybe a bit less</a>.</li>
<li><a href="https://philipwalton.com/articles/loading-polyfills-only-when-needed/">Loading Polyfills Only When Needed</a>.</li>
</ul>
<h2 id="file-io-from-browsers"><a class="header" href="#file-io-from-browsers">File io from browsers</a></h2>
<ul>
<li><a href="http://simey.me/saving-loading-files-with-javascript/">Saving / Loading files with Javascript (from the browser)</a></li>
</ul>
<h2 id="tree-shaking-with-rollup"><a class="header" href="#tree-shaking-with-rollup">Tree shaking with rollup</a></h2>
<ul>
<li><a href="https://madewithlove.com/optimizing-javascript-packages-for-tree-shaking/">Optimizing JavaScript packages for tree shaking</a>.</li>
<li><a href="https://medium.com/@paleo.said/how-to-bundle-an-npm-package-with-typescript-and-rollup-f80e0f196189">How to bundle a npm package with TypeScript and Rollup</a>.</li>
</ul>
<h2 id="typescript"><a class="header" href="#typescript">TypeScript</a></h2>
<p>We can automatically compile typescript files by running typescript compiler in watch mode,</p>
<pre><code class="language-bash">tsc *.ts --watch
</code></pre>
<p>Check out more details on <a href="https://www.typescriptlang.org/docs/handbook/tsconfig-json.html"><code>tsconfig.json</code></a> usage.</p>
<h2 id="best-way-to-provide-module-api"><a class="header" href="#best-way-to-provide-module-api">Best way to provide module API</a></h2>
<p>I like using Javascript class to provide prototypical APIs that uses states.
APIs without states can be exported as functions.</p>
<h2 id="js-asynchronous-programming-promise-asyncawait-explained"><a class="header" href="#js-asynchronous-programming-promise-asyncawait-explained">js asynchronous programming: Promise(), async/await explained</a></h2>
<p>Traditionally, we would access the results of asynchronous code through the use of callbacks.</p>
<pre><code class="language-javascript">let myfunc = (maybeAnID) =&gt; {
  someDatabaseThing(maybeAnID, function(error, result)) {
    if(error) {
      // build an error object and return
      // or just process the error and log and return nothing
      return doSomethingWithTheError(error);
    } else {
      // process the result, build a return object and return
      // or just process result and return nothing
      return doSomethingWithResult(result);
    }
  }
}
</code></pre>
<p>The use of callbacks is ok until they become overly nested. In other words, you have to run more asynchronous code with each new result. This pattern of callbacks within callbacks can lead to something known as <em>callback hell</em>.</p>
<p>To solve this we can use promise.
A promise is simply an object that we create like the later example. We instantiate it with the <code>new</code> keyword. Instead of the three parameters we passed in to make our car (color, type, and doors), we pass in a function that takes two arguments: <code>resolve</code> and <code>reject</code>.</p>
<pre><code class="language-javascript">
let myfunc = (maybeAnID) =&gt; new Promise((resolve, reject) =&gt; {
  someDatabaseThing(maybeAnID, function(error, result)) {
    //...Once we get back the thing from the database...
    if(error) {
        reject(doSomethingWithTheError(error));
    } else {
        resolve(doSomethingWithResult(result));
    }
  }
}
</code></pre>
<p>The call to asynchronous function is simply wrapped in a promise that is returned which allows
chaining with <code>.then()</code> which is much more readable then the <em>callback hell</em> style coding.</p>
<p>Or we can have our own function that returns a promise without wrapping a callback API.</p>
<pre><code class="language-javascript">let myfunc = (param) =&gt; new Promise((resolve, reject) =&gt; {
  // Do stuff that takes time using param
  ...
  if(error) {
      reject(doSomethingWithTheError(error));
  } else {
      resolve(doSomethingWithResult(result));
  }
}
</code></pre>
<p>The functions that consume a function returning a promise can use <code>.then()</code>
chaining. However there is yet another cleaner alternative.
In a function we can use <code>await</code> to invoke a function that returns a promise.
This will make the execution wait till the promise is resolved or rejected.
We don't need to use <code>.then()</code> chaining, which improves readability further more.
A function that wants to use <code>await</code> must be declared with <code>async</code> keyword.</p>
<p>More details here,</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function</a></li>
<li><a href="https://levelup.gitconnected.com/async-await-vs-promises-4fe98d11038f">https://levelup.gitconnected.com/async-await-vs-promises-4fe98d11038f</a></li>
<li><a href="https://www.freecodecamp.org/news/how-to-write-a-javascript-promise-4ed8d44292b8/">https://www.freecodecamp.org/news/how-to-write-a-javascript-promise-4ed8d44292b8/</a></li>
<li><a href="https://medium.com/@sebelga/simplify-your-code-adding-hooks-to-your-promises-9e1483662dfa">https://medium.com/@sebelga/simplify-your-code-adding-hooks-to-your-promises-9e1483662dfa</a></li>
</ul>
<p><code>async</code> function always returns a promise.</p>
<p>from a regular function they can be called with <code>.then()</code></p>
<pre><code class="language-javascript">let v = new Promise((resolve, reject) =&gt; {
    // throw Error("Returning error");
    resolve(20);
});

async function abc() {
    // test rejected promise
    // r will be undefined in case there is an error
    let r = await v.catch(() =&gt; {});
    console.log(r);
    return 35;
}

async function pqr() {
    console.log("running abc");
    let p = await abc();
    console.log(p);
}

// unused return value which is a promise
// This is perfectly acceptable if
// there was no result to return
pqr(); 

// this is how we retrieve return value from 
// an async function from a regular function
// or top level as we can't use await
// however module top level can be made async
abc().then(val =&gt; console.log(val));

</code></pre>
<h2 id="clipboard-api"><a class="header" href="#clipboard-api">clipboard API</a></h2>
<p>modern web browsers provide api for clipboard access</p>
<ul>
<li><a href="https://www.sitepoint.com/clipboard-api/">https://www.sitepoint.com/clipboard-api/</a></li>
</ul>
<h2 id="tree-implementation-in-node"><a class="header" href="#tree-implementation-in-node">tree implementation in node</a></h2>
<pre><code>const dirTree = require("directory-tree");

function printtree(indent, tree, last) {
    let myindent = last ? "'": "|";
    console.log(`${indent}${myindent}-- ${tree.name}`);
    if ("children" in tree) {
        for (let i=0; i &lt; tree.children.length; i++) {
            let chindent = last ? " ": "|";
            let chlast = i == (tree.children.length-1);
            printtree(indent+chindent+"   ", tree.children[i], chlast);            
        }
    }
}

function tree(path) {
  let dt = dirTree(path);
  printtree("", dt, false);
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rust-language"><a class="header" href="#rust-language">Rust language</a></h1>
<h2 id="learning-rust"><a class="header" href="#learning-rust">Learning rust</a></h2>
<ul>
<li><a href="https://doc.rust-lang.org/book/">The rust book</a>. Expand the TOC by pressing the menu icon on the top left of the page.</li>
<li><a href="https://www.youtube.com/playlist?list=PLai5B987bZ9CoVR-QEIN9foz4QCJ0H2Y8">The Rust Lang Book</a>.
I like this video series, watch along with the rust book.</li>
<li><a href="https://youtu.be/A3AdN7U24iU">Rust: A Language for the Next 40 Years - Carol Nichols</a>.</li>
<li><a href="https://youtu.be/SKGVItFlK3w">Rust Out Your C by Carol</a>. The <a href="https://github.com/carols10cents/rust-out-your-c-talk">Slides</a>.</li>
<li><a href="https://youtu.be/SZvs15hC81U">Stanford Seminar The Rust Programming Language - The Best Documentary Ever</a></li>
<li><a href="https://youtu.be/grU-4u0Okto">Traits and You: A Deep Dive — Nell Shamrell-Harrington</a>.</li>
<li><a href="https://youtu.be/LKYSl7kM5q8">Let's Learn Rust: Structs and Traits</a></li>
<li><a href="https://tourofrust.com">https://tourofrust.com</a></li>
<li>An excellent article <a href="https://fasterthanli.me/articles/a-half-hour-to-learn-rust">https://fasterthanli.me/articles/a-half-hour-to-learn-rust</a></li>
</ul>
<h2 id="rust-libraries"><a class="header" href="#rust-libraries">rust libraries</a></h2>
<ul>
<li><a href="https://crates.io/">https://crates.io/</a></li>
</ul>
<h2 id="desktop-app-with-rust"><a class="header" href="#desktop-app-with-rust">desktop app with rust</a></h2>
<ul>
<li><a href="https://tauri.studio">https://tauri.studio</a>
Most practical application pattern is what they call lockdown pattern (event api) added with rust command api. Uses webview2 for windows.</li>
<li><a href="https://tauri.studio/en/docs/guides/command">https://tauri.studio/en/docs/guides/command</a></li>
<li><a href="https://tauri.studio/en/docs/guides/events">https://tauri.studio/en/docs/guides/events</a></li>
<li>GUI <a href="https://github.com/vizia/vizia">https://github.com/vizia/vizia</a></li>
</ul>
<h2 id="creating-books"><a class="header" href="#creating-books">creating books</a></h2>
<ul>
<li><a href="https://github.com/rust-lang/mdBook">https://github.com/rust-lang/mdBook</a></li>
</ul>
<h2 id="using-rust-in-raspberry-pi"><a class="header" href="#using-rust-in-raspberry-pi">Using rust in Raspberry pi</a></h2>
<ul>
<li><a href="https://www.makeuseof.com/tag/getting-started-rust-raspberry-pi/">How to Get Started With Rust on Raspberry Pi</a></li>
<li><a href="https://opensource.com/article/19/3/physical-computing-rust-raspberry-pi">Program the real world using Rust on Raspberry Pi</a></li>
<li><a href="https://dev.to/h_ajsf/cross-compiling-rust-for-raspberry-pi-4iai">Cross compiling Rust for Raspberry Pi</a></li>
<li><a href="https://chacin.dev/blog/cross-compiling-rust-for-the-raspberry-pi/">Cross Compiling Rust for the Raspberry Pi</a></li>
<li><a href="https://www.raspberrypi.org/forums/viewtopic.php?t=233928">Anyone using Rust on a PI?</a></li>
<li><a href="https://docs.rust-embedded.org/book/">Learn to write an embedded OS in Rust</a>, <a href="https://github.com/rust-embedded">github</a>, <a href="https://github.com/rust-embedded/rust-raspberrypi-OS-tutorials">tutorials</a>.</li>
<li><a href="https://gnutoolchains.com/raspberry/">Prebuilt Windows Toolchain for Raspberry Pi</a>. Question: who are these people? Where are the sources for these tools?</li>
<li><a href="https://medium.com/@wizofe/cross-compiling-rust-for-arm-e-g-raspberry-pi-using-any-os-11711ebfc52b">Cross compiling Rust for ARM (e.g. Raspberry Pi) using any OS!</a></li>
<li><a href="https://github.com/rust-embedded/cross">“Zero setup” cross compilation and “cross testing” of Rust crates</a></li>
<li><a href="https://www.vagrantup.com/">Vagrant, Virtual machine for cross development</a>. I really like this setup, easy to use. Plays well with virtualbox.</li>
<li><a href="https://github.com/kunerd/clerk/wiki/How-to-use-HD44780-LCD-from-Rust#setting-up-the-cross-toolchain">https://github.com/kunerd/clerk/wiki/How-to-use-HD44780-LCD-from-Rust#setting-up-the-cross-toolchain</a></li>
<li><a href="https://opensource.com/article/19/3/physical-computing-rust-raspberry-pi">https://opensource.com/article/19/3/physical-computing-rust-raspberry-pi</a></li>
<li><a href="https://github.com/japaric/rust-cross">https://github.com/japaric/rust-cross</a></li>
</ul>
<h2 id="rust-gpio-for-pi"><a class="header" href="#rust-gpio-for-pi">rust GPIO for pi</a></h2>
<ul>
<li>May be a kernel module with rust?? Some <a href="topics/rust#Linux-kernel-module-with-rust">work</a> is ongoing.</li>
<li><a href="https://github.com/golemparts/rppal">RPPAL</a>.</li>
<li><a href="https://github.com/rust-embedded/rust-sysfs-gpio">https://github.com/rust-embedded/rust-sysfs-gpio</a>.</li>
</ul>
<p>Most promising seems to be <a href="https://github.com/golemparts/rppal">RPPAL</a> option.</p>
<blockquote>
<p>I will try this option and do the write up on this.</p>
</blockquote>
<h2 id="cross-compiling-rust-on-ubuntu"><a class="header" href="#cross-compiling-rust-on-ubuntu">Cross compiling rust on ubuntu</a></h2>
<p>Compiling rust on pi will take for ever, cross compiling will save development time. We will use ubuntu for cross compile.</p>
<p>If we are on a windows machine, WSL2 also is a good way to develop for raspberry. check <a href="https://www.youtube.com/watch?v=_fntjriRe48">WSL 2: Getting started</a>. Go ahead install ubuntu to run with WSL2.</p>
<p>Primary problem with cross compiling rust for pi zero is that zero is armv6 but other pis are armv7. At the time of this writing, gcc toolchain only has support for armv7. armv6 compile also produces armv7 image. So the toolchain needs to be installed from pi official tool repo from github which has armv6 support. See more in the following links,</p>
<ul>
<li><a href="https://github.com/rust-embedded/cross/issues/426">https://github.com/rust-embedded/cross/issues/426</a></li>
<li><a href="https://github.com/japaric/rust-cross/issues/42">https://github.com/japaric/rust-cross/issues/42</a></li>
<li><a href="https://hub.docker.com/r/mdirkse/rust_armv6">https://hub.docker.com/r/mdirkse/rust_armv6</a></li>
</ul>
<p>Using this strategy we will go ahead and setup wsl2 linux detailed in <a href="topics/pirust">Rust in Raspberry Pi</a>.</p>
<h3 id="qemu-for-library-dependencies"><a class="header" href="#qemu-for-library-dependencies">QEMU for library dependencies</a></h3>
<ul>
<li><a href="http://linux-sunxi.org/Debootstrap">Debootstrap</a></li>
<li><a href="http://logan.tw/posts/2017/01/21/introduction-to-qemu-debootstrap/">Introduction to qemu-debootstrap</a>.</li>
<li><a href="https://headmelted.com/using-qemu-to-produce-debian-filesystems-for-multiple-architectures-280df41d28eb">https://headmelted.com/using-qemu-to-produce-debian-filesystems-for-multiple-architectures-280df41d28eb</a>.</li>
<li><a href="https://youtu.be/PBY9l97-lto">Kernel Recipes 2015 - Speed up your kernel development cycle with QEMU - Stefan Hajnoczi</a>.</li>
<li><a href="https://youtu.be/L_r3z3402do">Debootstrap #1 Creating a Filesystem for Debian install Linux tutorial</a>.</li>
<li><a href="https://youtu.be/OLFH4Ov6bJQ">Creating Ubuntu and Debian container base images, the old and simple way</a>.</li>
<li><a href="https://youtu.be/xiQX0YXYuqU">Raspberry Pi Emulator for Windows 10 Full Setup Tutorial and Speed Optimization</a>.</li>
<li><a href="https://azeria-labs.com/emulate-raspberry-pi-with-qemu/">RASPBERRY PI ON QEMU</a>.</li>
</ul>
<h2 id="linux-kernel-module-with-rust"><a class="header" href="#linux-kernel-module-with-rust">Linux kernel module with rust</a></h2>
<ul>
<li><a href="https://github.com/fishinabarrel/linux-kernel-module-rust">https://github.com/fishinabarrel/linux-kernel-module-rust</a></li>
</ul>
<h2 id="rust-wasm"><a class="header" href="#rust-wasm">rust-wasm</a></h2>
<ul>
<li><a href="https://rustwasm.github.io/">https://rustwasm.github.io/</a></li>
<li><a href="https://rustwasm.github.io/docs/book/">book</a></li>
<li><a href="https://youtu.be/ohuTy8MmbLc">Rust in the Browser for JavaScripters: New Frontiers, New Possibilities</a></li>
</ul>
<h2 id="java-to-rust"><a class="header" href="#java-to-rust">java to rust</a></h2>
<ul>
<li><a href="https://github.com/aschoerk/converter-page">java to rust</a></li>
<li><a href="https://jrconverter.appspot.com/index.jsp">online converter</a></li>
</ul>
<h2 id="python-to-rust"><a class="header" href="#python-to-rust">python to rust</a></h2>
<ul>
<li><a href="https://alantrick.ca/writings/programming/python_to_rust">Converting a Python library to Rust</a>. <a href="https://gitlab.com/alantrick/august-python-old/">Python</a> and <a href="https://gitlab.com/alantrick/august/">Rust</a>.</li>
<li><a href="https://medium.com/@konchunas/transpiling-python-to-rust-766459b6ab8f">Transpiling Python to Rust</a>, <a href="https://github.com/konchunas/pyrs">github</a>.</li>
</ul>
<h1 id="using-dbus-in-rust"><a class="header" href="#using-dbus-in-rust">using dbus in rust</a></h1>
<ul>
<li><a href="https://github.com/diwic/dbus-rs">https://github.com/diwic/dbus-rs</a> dbus crate.</li>
<li><a href="https://github.com/diwic/dbus-rs/issues/214">https://github.com/diwic/dbus-rs/issues/214</a> Simple dbus-codegen example.</li>
<li><a href="https://github.com/deifactor/ninomiya">https://github.com/deifactor/ninomiya</a></li>
<li><a href="https://github.com/diwic/dbus-rs/blob/master/dbus-codegen/examples/adv_server_codegen.rs">https://github.com/diwic/dbus-rs/blob/master/dbus-codegen/examples/adv_server_codegen.rs</a> server example.</li>
<li><a href="https://github.com/diwic/dbus-rs/blob/master/dbus/examples/match_signal.rs">https://github.com/diwic/dbus-rs/blob/master/dbus/examples/match_signal.rs</a> client example using dbus-codegen-rust.</li>
<li><a href="https://github.com/kkibria/rustdbuscross">https://github.com/kkibria/rustdbuscross</a></li>
</ul>
<pre><code>pi dbus
$ dpkg -l | grep dbus
ii  dbus                1.12.16-1 armhf  simple  interprocess messaging system (daemon and utilities)
ii  libdbus-1-3:armhf   1.12.16-1 armhf  simple  interprocess messaging system (library)
ii  libdbus-1-dev:armhf 1.12.16-1 armhf  simple  interprocess messaging system (development headers)
ii  python-dbus         1.2.8-3   armhf  simple  interprocess messaging system (Python interface)
ii  python3-dbus        1.2.8-3   armhf  simple  interprocess messaging system (Python 3 interface)
</code></pre>
<h2 id="install-dbus-codegen-rust"><a class="header" href="#install-dbus-codegen-rust">install dbus-codegen-rust</a></h2>
<p>following will install dbus-codegen-rust CLI.</p>
<pre><code class="language-bash">cargo install dbus-codegen
</code></pre>
<p>There are two possibilities</p>
<ul>
<li>Write server and client.</li>
<li>Write client for an exiting installed server.</li>
</ul>
<h2 id="client-for-an-exiting-server"><a class="header" href="#client-for-an-exiting-server">Client for an exiting server</a></h2>
<p>example of generated code,</p>
<pre><code>dbus-codegen-rust -s -d org.freedesktop.timedate1 -p /org/freedesktop/timedate1 -o src/timedate.rs -i org.freedesktop
</code></pre>
<p>which will put the code in <code>src</code> folder.</p>
<h2 id="cross-compile-dbus"><a class="header" href="#cross-compile-dbus">cross compile dbus</a></h2>
<ul>
<li><a href="https://github.com/diwic/dbus-rs/blob/master/libdbus-sys/cross_compile.md">https://github.com/diwic/dbus-rs/blob/master/libdbus-sys/cross_compile.md</a></li>
<li><a href="https://serverfault.com/questions/892465/starting-systemd-services-sharing-a-session-d-bus-on-headless-system">https://serverfault.com/questions/892465/starting-systemd-services-sharing-a-session-d-bus-on-headless-system</a> headless dbus.</li>
<li><a href="https://raspberrypi.stackexchange.com/questions/114739/how-to-install-pi-libraries-to-cross-compile-for-pi-zero-in-wsl2">https://raspberrypi.stackexchange.com/questions/114739/how-to-install-pi-libraries-to-cross-compile-for-pi-zero-in-wsl2</a>.</li>
</ul>
<p>The following script downloads and cross-compiles D-Bus and Expat for Raspberry Pi zero:</p>
<pre><code class="language-sh">#!/usr/bin/env bash

set -ex

# Clone the D-bus and Expat libraries
[ -d dbus ] || \
    git clone --branch dbus-1.13.18 --single-branch --depth=1 \
        https://gitlab.freedesktop.org/dbus/dbus.git

[ -d libexpat ] || \
    git clone --branch R_2_2_9 --single-branch --depth=1 \
    https://github.com/libexpat/libexpat.git

# Script for building these libraries:
cat &lt;&lt; 'EOF' &gt; build-script-docker.sh
#!/usr/bin/env bash

set -ex
cd "$(dirname "${BASH_SOURCE[0]}")"

# Point pkg-config to the sysroot:
. cross-pkg-config

# Directory to install the packages to:
export RPI_STAGING="$PWD/staging"
rm -rf "${RPI_STAGING}"

# libexpat
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

pushd libexpat/expat
./buildconf.sh
mkdir -p build
pushd build
../configure \
    --prefix="/usr/local" \
    --host="${HOST_TRIPLE}" \
    --with-sysroot="${RPI_SYSROOT}"
make -j$(nproc)
make install DESTDIR="${RPI_SYSROOT}"
make install DESTDIR="${RPI_STAGING}"
popd
popd

# dbus
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

pushd dbus
mkdir -p build
pushd build
cmake .. \
    -DCMAKE_TOOLCHAIN_FILE="$HOME/${HOST_TRIPLE}.cmake" \
    -DCMAKE_BUILD_TYPE="Release" \
    -DCMAKE_INSTALL_PREFIX="/usr/local"
make -j$(nproc)
make install DESTDIR="${RPI_SYSROOT}"
make install DESTDIR="${RPI_STAGING}"
popd
popd
EOF

# Start the Docker container with the toolchain and run the build script:
image="tttapa/rpi-cross:armv6-rpi-linux-gnueabihf-dev"
docker run --rm -it -v "$PWD:/tmp/workdir" $image \
    bash "/tmp/workdir/build-script-docker.sh"

</code></pre>
<p>You'll need to have Docker installed. When finished, the libraries will be in the <code>staging</code> folder in the working directory.</p>
<p>The Docker container with the toolchain is one I maintain (https://github.com/tttapa/RPi-Cpp-Toolchain), but the installation process should be similar with the toolchain you're using, you'll just have to install some extra dependencies such as make, autotools, and maybe cross-compile some other dependencies of Expat and D-Bus as well.<br />
I also maintain some notes with instructions of the toolchains and cross-compilation processes, which you might find useful: https://tttapa.github.io/Pages/Raspberry-Pi/C++-Development/index.html</p>
<p>You might want to add some extra options to the configure and cmake steps, but that's outside of the scope of this answer, see the relevant D-Bus documentation.<br />
Also note that installs both libraries to both the sysroot and the staging area, it'll depend on what you want to do with it. You have to install at least <code>libexpat</code> to the <code>${RPI_SYSROOT}</code> folder, because that's the folder used as the sysroot for compiling <code>dbus</code> which depends on <code>libexpat</code>. The sysroot folder for the compilation of <code>dbus</code> is selected in the CMake Toolchain file, <code>~/${HOST_TRIPLE}.cmake</code>, it's included with the Docker container. Its contents are:</p>
<pre><code class="language-cmake">SET(CMAKE_SYSTEM_NAME Linux)
SET(CMAKE_C_COMPILER armv6-rpi-linux-gnueabihf-gcc)
SET(CMAKE_CXX_COMPILER armv6-rpi-linux-gnueabihf-g++)
SET(CMAKE_SYSTEM_PROCESSOR armv6)

set(CMAKE_SYSROOT $ENV{RPI_SYSROOT})
SET(CMAKE_FIND_ROOT_PATH ${CMAKE_SYSROOT}) 

set(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)
set(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)
set(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)
set(CMAKE_FIND_ROOT_PATH_MODE_PACKAGE ONLY)
</code></pre>
<p>You might also have to point <code>pkg-config</code> to the right sysroot folder. This is handled by the <code>cross-pkg-config</code> script:</p>
<pre><code class="language-sh">export PKG_CONFIG_LIBDIR="${RPI_SYSROOT}/usr/local/lib:${RPI_SYSROOT}/opt/vc/lib"
export PKG_CONFIG_PATH="${RPI_SYSROOT}/usr/local/lib/pkgconfig:${RPI_SYSROOT}/usr/local/share/pkgconfig:${RPI_SYSROOT}/opt/vc/lib/pkgconfig"
export PKG_CONFIG_SYSROOT_DIR="${RPI_SYSROOT}"
</code></pre>
<h2 id="rust-qt-binding"><a class="header" href="#rust-qt-binding">Rust Qt binding</a></h2>
<ul>
<li><a href="https://youtu.be/McgwDB13igo">https://youtu.be/McgwDB13igo</a>, github <a href="https://github.com/KDE/rust-qt-binding-generator">https://github.com/KDE/rust-qt-binding-generator</a></li>
</ul>
<h2 id="using-rust-with-vscode-in-windows"><a class="header" href="#using-rust-with-vscode-in-windows">using rust with vscode in windows</a></h2>
<p>If you are using powershell in vscode, the path might not pickup rust compiler.
Read <a href="topics/vscode#powershell-setup">Powershell setup</a> for vscode for more information.</p>
<p>Place <code>.psrc.ps1</code> file at the root of the project folder with following, which is the default
path of rust install.</p>
<pre><code>$env:Path += ";$profile/.cargo/bin"
</code></pre>
<p>If you installed rust to a custom path, use that path instead.</p>
<h3 id="videos-to-watch"><a class="header" href="#videos-to-watch">Videos to watch:</a></h3>
<ul>
<li><a href="https://youtu.be/x_iZEK6Rww4">IDE Setup For Rust Development</a></li>
<li><a href="https://youtu.be/aYsUBddY7KY">Getting Started with Rust on Windows and Visual Studio Code</a></li>
</ul>
<h2 id="debugging-rust-with-vscode-in-windows"><a class="header" href="#debugging-rust-with-vscode-in-windows">debugging rust with vscode in windows</a></h2>
<ul>
<li><a href="https://www.brycevandyk.com/debug-rust-on-windows-with-visual-studio-code-and-the-msvc-debugger/">https://www.brycevandyk.com/debug-rust-on-windows-with-visual-studio-code-and-the-msvc-debugger/</a></li>
</ul>
<h2 id="server-1"><a class="header" href="#server-1">Server</a></h2>
<ul>
<li><a href="https://crates.io/crates/rust-embed">https://crates.io/crates/rust-embed</a> embeds static file in the server binary.</li>
<li><a href="https://crates.io/crates/live-server">https://crates.io/crates/live-server</a> live reload enabled server. Embeds livereload websocket code
into html files on the fly when serving.</li>
<li><a href="https://crates.io/crates/tide">https://crates.io/crates/tide</a> a web server with support for middleware.</li>
</ul>
<h2 id="creative-content-framework"><a class="header" href="#creative-content-framework">creative content framework</a></h2>
<ul>
<li><a href="https://nannou.cc/">https://nannou.cc/</a></li>
</ul>
<h2 id="ide-design"><a class="header" href="#ide-design">Ide design</a></h2>
<ul>
<li><a href="https://github.com/makepad/makepad">https://github.com/makepad/makepad</a></li>
</ul>
<h2 id="rust-drawing-app"><a class="header" href="#rust-drawing-app">rust drawing app</a></h2>
<ul>
<li><a href="https://github.com/GraphiteEditor/Graphite">https://github.com/GraphiteEditor/Graphite</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rust-setup-in-wsl"><a class="header" href="#rust-setup-in-wsl">Rust setup in wsl</a></h1>
<h2 id="rust-with-vscode"><a class="header" href="#rust-with-vscode">rust with vscode</a></h2>
<p>I installed the VS Code extension,</p>
<ul>
<li>rust-analyzer (for IDE support)</li>
</ul>
<p>It provides lot of helpers, including
refactoring that makes it easy to write code. This also puts a command in
command pallet (ctrl+shift+p) called <code>rust analyzer: debug</code> which starts the
debug, without setting vscode debug configuration which is nice!</p>
<p>But then it started becoming frustrating.</p>
<h2 id="rust-in-wsl"><a class="header" href="#rust-in-wsl">rust in wsl</a></h2>
<p>Why do we need to even use wsl to build rust. It has to do with symbolic debug
with vscode. In windows the default is MSVC-style debugging using <code>cppvsdbg</code>
for debugging. Unfortunately with this many symbols were reported as "gotten
optimized away". Even when <code>cargo.toml</code> contains,</p>
<pre><code>[profile.dev]
opt-level = 0           # no optimizations
debug = true            # emit debug info (level 2 by default)
</code></pre>
<p>So, the common recommendation I found was to use <code>lldb</code> for debug. So I
installed the VS Code extension,</p>
<ul>
<li>CodeLLDB (LLDB frontend)</li>
</ul>
<p>Under windows, LLDB did give symbols that were missing before, but lldb was
running so slow that it was almost unusable. When I tried in wsl under vscode,
things were running very nicely.</p>
<h2 id="cross-compile-for-windows-msvc-in-wsl"><a class="header" href="#cross-compile-for-windows-msvc-in-wsl">Cross compile for windows msvc in wsl</a></h2>
<p>But I wanted windows binary. Rust toolchain can compile for windows <code>msvc</code>
target, but I needed to use <code>msvc</code> linker which lives in windows side. In order
to use the linker in the cargo flow, I followed instructions from
<a href="https://github.com/strickczq/msvc-wsl-rust">https://github.com/strickczq/msvc-wsl-rust</a> for setting up the linker. In my
case I use vscode. So I downloaded Build Tools for Visual Studio and then
installed <code>C++ Build Tools</code> workload.</p>
<p>This setup works great.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rust-plugins"><a class="header" href="#rust-plugins">Rust Plugins</a></h1>
<ul>
<li><a href="https://adventures.michaelfbryan.com/posts/plugins-in-rust/">https://adventures.michaelfbryan.com/posts/plugins-in-rust/</a></li>
<li><a href="https://github.com/Michael-F-Bryan/plugins_in_rust">https://github.com/Michael-F-Bryan/plugins_in_rust</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rust-multithreading"><a class="header" href="#rust-multithreading">Rust Multithreading</a></h1>
<p>Rust's ownership and borrow checking at compile time makes it easy to use
threads. However sharing data between threads requires some consideration.</p>
<h2 id="sharing-data"><a class="header" href="#sharing-data">Sharing data</a></h2>
<p>Let's say we have two threads. One for gui, another for processing. We need to
share a big data structure which is modified in gui thread. But they are
accessed in the processing thread which could perform lengthy processing. How do
we achieve this?</p>
<p>Accessing shared data between threads can be tricky, especially when the data is
large and frequently modified. In such Read-copy-update can be considered.</p>
<h2 id="read-copy-update"><a class="header" href="#read-copy-update">Read copy update</a></h2>
<p>Sharing data with read copy update (RCU) is a technique used in concurrent
programming to allow multiple threads or processes to access a shared data
structure simultaneously without the need for explicit locking. The RCU
technique is commonly used in high-performance computing environments where lock
contention can be a significant bottleneck.</p>
<p>The basic idea behind RCU is to maintain multiple versions of the shared data
structure simultaneously, with each version accessible by a different thread or
process. When a thread wants to read the shared data, it simply accesses the
current version. When a thread wants to modify the shared data, it creates a new
version of the data structure, modifies it, and then updates a global pointer to
indicate that the new version is now the current version.</p>
<p>The RCU technique provides fast read access because readers do not need to
acquire locks or wait for other threads to release locks. Instead, they simply
access the current version of the shared data. The write operations are
serialized using some other synchronization mechanism such as atomic operations
or locks, but the read operations are not blocked by these write operations.</p>
<p>In the read-copy-update technique, a process or thread requesting to modify the
shared data structure can create a copy of the data structure and work on it in
isolation. Other threads that are still using the old version of the data
structure can continue to use it without locking or blocking. The updated data
structure is made available only when the current users are no longer using the
old data structure. This process of sharing old data and allowing read-only
access to it while a copy is modified is called copy-on-write.</p>
<p>RCU is particularly useful for shared data structures that are read frequently
but updated infrequently, or where lock contention is a bottleneck. However, it
requires careful design and implementation to ensure that the different versions
of the shared data are correctly managed and that updates to the data structure
do not result in inconsistencies or race conditions.</p>
<h2 id="rust-data-sharing"><a class="header" href="#rust-data-sharing">Rust data sharing</a></h2>
<p>In Rust we can share by using,</p>
<ul>
<li><code>Arc</code> (atomic reference counting) and <code>Mutex</code> (mutual exclusion) types.</li>
<li>Message passing.</li>
<li>Combination of both.</li>
</ul>
<p>Following cases are not exhaustive use cases but shows some common uses.</p>
<h2 id="using-mutex"><a class="header" href="#using-mutex">Using Mutex</a></h2>
<p>Wrap your data structure in an <code>Arc&lt;Mutex&lt;T&gt;&gt;</code>. This will allow multiple threads
to share the data structure and access it safely.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use std::sync::{Arc, Mutex};

// Define your data structure.
struct MyDataStructure {
    // ...
}

// Wrap it in an Arc&lt;Mutex&lt;T&gt;&gt;.
let shared_data = Arc::new(Mutex::new(MyDataStructure { /* ... */ }));
<span class="boring">}</span></code></pre></pre>
<p>In the gui thread, when you need to modify the data structure, you can acquire a
lock on the <code>Mutex</code> using the <code>lock()</code> method. This will give you a mutable
reference to the data structure that you can modify.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let mut data = shared_data.lock().unwrap();
// Modify the data structure as needed.
data.modify_something();
<span class="boring">}</span></code></pre></pre>
<p>In the processing thread, when you need to access the data structure, you can
also acquire a lock on the <code>Mutex</code> using the <code>lock()</code> method. This will give you
an immutable reference to the data structure that you can safely access.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let data = shared_data.lock().unwrap();
// Access the data structure as needed.
let value = data.get_something();
<span class="boring">}</span></code></pre></pre>
<p>Note that calling <code>lock()</code> on a <code>Mutex</code> can block if another thread has already
acquired the lock. To avoid deadlocks, be sure to acquire locks on the <code>Mutex</code>
in a consistent order across all threads that access it.</p>
<p>Also, keep in mind that accessing shared data across threads can have
performance implications, especially if the data structure is large and
frequently modified. You may want to consider other strategies such as message
passing to minimize the need for shared mutable state.</p>
<h2 id="message-passing"><a class="header" href="#message-passing">Message passing</a></h2>
<p>Using message passing can be a good way to minimize the need for shared mutable
state, especially for large data structures. Instead of sharing the data
structure directly, you can send messages between threads to communicate changes
to the data.</p>
<p>Here's an example of how you could use message passing to modify a large data
structure between two threads:</p>
<p>Define your data structure and a message type that can be used to modify it.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Define your data structure.
struct MyDataStructure {
    // ...
}

// Define a message type that can modify the data structure.
enum Message {
    ModifyDataStructure(Box&lt;dyn FnOnce(&amp;mut MyDataStructure) + Send + 'static&gt;),
}
<span class="boring">}</span></code></pre></pre>
<p>Create a channel for sending messages between the gui and processing threads.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use std::sync::mpsc::{channel, Sender, Receiver};

// Create a channel for sending messages between threads.
let (sender, receiver): (Sender&lt;Message&gt;, Receiver&lt;Message&gt;) = channel();
<span class="boring">}</span></code></pre></pre>
<p>In the gui thread, when you need to modify the data structure, create a closure
that modifies the data structure and send it as a message to the processing
thread.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Create a closure that modifies the data structure.
let modify_data = Box::new(|data: &amp;mut MyDataStructure| {
    // Modify the data structure as needed.
    data.modify_something();
});

// Send the closure as a message to the processing thread.
let message = Message::ModifyDataStructure(modify_data);
sender.send(message).unwrap();
<span class="boring">}</span></code></pre></pre>
<p>In the processing thread, receive messages from the channel and apply them to
the data structure.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Receive messages from the channel and apply them to the data structure.
loop {
    match receiver.recv() {
        Ok(message) =&gt; {
            match message {
                Message::ModifyDataStructure(modify_data) =&gt; {
                    // Acquire a lock on the data structure and apply the closure.
                    let mut data = shared_data.lock().unwrap();
                    modify_data(&amp;mut data);
                },
            }
        },
        Err(_) =&gt; break,
    }
}
<span class="boring">}</span></code></pre></pre>
<p>Note that this example is simplified and doesn't handle errors, such as when
sending or receiving messages fails. Also, keep in mind that message passing can
have performance implications, especially for large data structures or frequent
updates. You may want to consider using a combination of message passing and
shared mutable state, depending on your specific requirements and constraints.</p>
<h2 id="combination-of-message-passing-and-shared-mutable-state"><a class="header" href="#combination-of-message-passing-and-shared-mutable-state">Combination of message passing and shared mutable state</a></h2>
<p>This can be a good way to balance the need for communication and performance.
You can use message passing to communicate high-level changes (small updates) to
the data structure, and shared mutable state to allow for low-level access
(large updates or initial state) and modification.</p>
<p>Here's an example of how you could use a combination of message passing and
shared mutable state to modify a large data structure between two threads:</p>
<p>Define your data structure and a message type that can be used to modify it.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Define your data structure.
struct MyDataStructure {
    // ...
}

// Define a message type that can modify the data structure.
enum Message {
    ModifyDataStructure(Box&lt;dyn FnOnce(&amp;mut MyDataStructure) + Send + 'static&gt;),
}

<span class="boring">}</span></code></pre></pre>
<p>Create a channel for sending messages between the gui and processing threads.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use std::sync::mpsc::{channel, Sender, Receiver};

// Create a channel for sending messages between threads.
let (sender, receiver): (Sender&lt;Message&gt;, Receiver&lt;Message&gt;) = channel();
<span class="boring">}</span></code></pre></pre>
<p>Wrap your data structure in an <code>Arc&lt;Mutex&lt;T&gt;&gt;</code>. This will allow multiple threads
to share the data structure and access it safely.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use std::sync::{Arc, Mutex};

// Wrap your data structure in an Arc&lt;Mutex&lt;T&gt;&gt;.
let shared_data = Arc::new(Mutex::new(MyDataStructure { /* ... */ }));
<span class="boring">}</span></code></pre></pre>
<p>In the gui thread, when you need to modify the data structure, create a closure
that modifies the data structure and send it as a message to the processing
thread.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Create a closure that modifies the data structure.
let modify_data = Box::new(|data: &amp;mut MyDataStructure| {
    // Modify the data structure as needed.
    data.modify_something();
});

// Send the closure as a message to the processing thread.
let message = Message::ModifyDataStructure(modify_data);
sender.send(message).unwrap();
<span class="boring">}</span></code></pre></pre>
<p>In the processing thread, receive messages from the channel and apply them to
the data structure. In addition, you can acquire a lock on the Mutex to allow
for low-level access and modification.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Receive messages from the channel and apply them to the data structure.
loop {
    match receiver.recv() {
        Ok(message) =&gt; {
            match message {
                Message::ModifyDataStructure(modify_data) =&gt; {
                    // Acquire a lock on the data structure and apply the closure.
                    let mut data = shared_data.lock().unwrap();
                    modify_data(&amp;mut data);
                },
            }
        },
        Err(_) =&gt; break,
    }
}
<span class="boring">}</span></code></pre></pre>
<p>Note that in the processing thread, you can also access the data structure
outside of the messages by acquiring a lock on the Mutex. This will allow for
low-level access and modification, without the overhead of message passing.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Acquire a lock on the data structure for low-level access.
let mut data = shared_data.lock().unwrap();
// Modify the data structure as needed.
data.modify_something_else();
<span class="boring">}</span></code></pre></pre>
<p>Using a combination of message passing and shared mutable state can be a
powerful way to balance the need for communication and performance. Keep in mind
that this approach requires careful synchronization and error handling,
especially when modifying the data structure from multiple threads.</p>
<h2 id="read-only-access"><a class="header" href="#read-only-access">Read only access</a></h2>
<p>Read access has the possibilities of data races.</p>
<p>If you're only reading the data structure, and you don't care about data race,
then you generally don't need to acquire a lock. Otherwise, if you're accessing
the data structure, even if only for reading, you should use a lock to
synchronize access and prevent data races.</p>
<h2 id="locking-for-both-read-and-write"><a class="header" href="#locking-for-both-read-and-write">Locking for both read and write</a></h2>
<p>Following shows both accesses,</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use std::sync::Arc;
use std::sync::Mutex;

// Wrap your data structure in an Arc&lt;Mutex&lt;T&gt;&gt;.
let shared_data = Arc::new(Mutex::new(MyDataStructure { /* ... */ }));

// In the processing thread, receive messages from the channel and read the data structure.
loop {
    match receiver.recv() {
        Ok(message) =&gt; {
            match message {
                Message::GetSample =&gt; {
                    // Acquire a lock on the data structure for read-only access.
                    let data = shared_data.lock().unwrap();
                    // Read the data structure as needed.
                    let sample = data.get_sample();
                    // Use the sample in the processing thread.
                    // ...
                },
                Message::ModifyDataStructure(modify_data) =&gt; {
                    // Acquire a lock on the data structure and apply the closure.
                    let mut data = shared_data.lock().unwrap();
                    modify_data(&amp;mut data);
                },
            }
        },
        Err(_) =&gt; break,
    }
}
<span class="boring">}</span></code></pre></pre>
<p>In this example, the processing thread acquires a lock on the data structure for
read-only access when it receives a message to get a sample, but acquires a lock
for write access when it receives a message to modify the data structure. This
ensures safe access to the data structure from multiple threads.</p>
<h2 id="links-to-materials-related-to-data-sharing"><a class="header" href="#links-to-materials-related-to-data-sharing">Links to materials related to data sharing</a></h2>
<ul>
<li><a href="https://youtu.be/a10JpqI-CvU">https://youtu.be/a10JpqI-CvU</a></li>
<li><a href="https://forum.juce.com/t/timur-doumler-talks-on-c-audio-sharing-data-across-threads/26311/1">https://forum.juce.com/t/timur-doumler-talks-on-c-audio-sharing-data-across-threads/26311/1</a></li>
<li><a href="https://github.com/hogliux/farbot">https://github.com/hogliux/farbot</a></li>
<li><a href="https://youtu.be/7fKxIZOyBCE">https://youtu.be/7fKxIZOyBCE</a></li>
<li><a href="https://cfsamsonbooks.gitbook.io/explaining-atomics-in-rust/">https://cfsamsonbooks.gitbook.io/explaining-atomics-in-rust/</a></li>
<li><a href="https://github.com/preshing/junction">https://github.com/preshing/junction</a></li>
<li><a href="https://preshing.com/20160726/using-quiescent-states-to-reclaim-memory/">https://preshing.com/20160726/using-quiescent-states-to-reclaim-memory/</a></li>
<li><a href="http://www.cs.toronto.edu/~tomhart/papers/tomhart_thesis.pdf">http://www.cs.toronto.edu/~tomhart/papers/tomhart_thesis.pdf</a></li>
<li><a href="https://codeandbitters.com/learning-rust-crossbeam-epoch/">https://codeandbitters.com/learning-rust-crossbeam-epoch/</a></li>
<li><a href="https://github.com/ericseppanen/epoch_playground">https://github.com/ericseppanen/epoch_playground</a></li>
<li><a href="https://aturon.github.io/blog/2015/08/27/epoch/">https://aturon.github.io/blog/2015/08/27/epoch/</a> most comprehensive explanation</li>
<li><a href="https://marabos.nl/atomics/">https://marabos.nl/atomics/</a> most comprehensive explanation</li>
<li><a href="https://www.packtpub.com/en-us/product/hands-on-concurrency-with-rust-9781788399975">https://www.packtpub.com/en-us/product/hands-on-concurrency-with-rust-9781788399975</a></li>
<li><a href="https://youtu.be/9XAx279s7gs">https://youtu.be/9XAx279s7gs</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="powershell-scripts"><a class="header" href="#powershell-scripts">Powershell Scripts</a></h1>
<h2 id="addremove-path-in-path-variable"><a class="header" href="#addremove-path-in-path-variable">Add/Remove path in path variable</a></h2>
<pre><code>Set-PathVariable {
    param (
        [string]$AddPath,
        [string]$RemovePath
    )
    $regexPaths = @()
    if ($PSBoundParameters.Keys -contains 'AddPath'){
        $regexPaths += [regex]::Escape($AddPath)
    }

    if ($PSBoundParameters.Keys -contains 'RemovePath'){
        $regexPaths += [regex]::Escape($RemovePath)
    }
    
    $arrPath = $env:Path -split ';'
    foreach ($path in $regexPaths) {
        $arrPath = $arrPath | Where-Object {$_ -notMatch "^$path\\?"}
    }
    $env:Path = ($arrPath + $addPath) -join ';'
}
</code></pre>
<h2 id="download-a-file"><a class="header" href="#download-a-file">download a file</a></h2>
<pre><code>Invoke-WebRequest -Uri &lt;source&gt; -OutFile &lt;destination&gt;
</code></pre>
<h2 id="create-directory-if-not-exist"><a class="header" href="#create-directory-if-not-exist">create directory if not exist.</a></h2>
<pre><code>New-Item -Force -ItemType directory -Path foo
</code></pre>
<h2 id="powershell-cli-installation-recipe-from-github-release"><a class="header" href="#powershell-cli-installation-recipe-from-github-release">powershell cli installation recipe from github release,</a></h2>
<pre><code>$repo = "slideshow-dist"
$binary = "slideshow-win.exe"

$curpath = [Environment]::GetEnvironmentVariable('Path', 'User')
function Set-PathVariable {
    param (
        [string]$AddPath,
        [string]$RemovePath
    )
    $regexPaths = @()
    if ($PSBoundParameters.Keys -contains 'AddPath'){
        $regexPaths += [regex]::Escape($AddPath)
    }

    if ($PSBoundParameters.Keys -contains 'RemovePath'){
        $regexPaths += [regex]::Escape($RemovePath)
    }
    
    $arrPath = $curpath -split ';'
    foreach ($path in $regexPaths) {
        $arrPath = $arrPath | Where-Object {$_ -notMatch "^$path\\?"}
    }
    $newpath = ($arrPath + $addPath) -join ';'
    [Environment]::SetEnvironmentVariable("Path", $newpath, 'User')
}

$installPath = "~\github.kkibria"
$latest = ("https://github.com/kkibria/" + $repo + "/releases/latest")

Write-Output "Preparing install directory..."
New-Item -Path $installPath -ItemType Directory -Force | Out-Null
$f = (Convert-Path $installPath)
Write-Output ("install directory '" + $f + "' created.")
Write-Output ("{"+ $binary + " install: " + $curpath + "}") &gt;&gt; ($f+"\.path.backup")
Write-Output "Backing up path variable..."
Write-Output "Updating path variable..."
Set-PathVariable $f 
$a = $latest+"/download/"+$binary
$b = $f+"\"+$binary
Write-Output "Downloading executable to install directory..."
Invoke-WebRequest -Uri $a -OutFile $b
Write-Output "Install complete."
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="python"><a class="header" href="#python">Python</a></h1>
<h2 id="virtual-environment-for-python"><a class="header" href="#virtual-environment-for-python">Virtual environment for python</a></h2>
<p>The venv module provides support for creating lightweight “virtual environments” with their own site directories, optionally isolated from system site directories. Each virtual environment has its own Python binary (which matches the version of the binary that was used to create this environment) and can have its own independent set of installed Python packages in its site directories.</p>
<ol>
<li>First find out the python
path of the version of python you need to use, for example, <code>C:/Python39/python.exe</code>.</li>
<li>Go to the root folder of the project and create virtual environment called <code>env</code> for the project.</li>
</ol>
<pre><code class="language-bash">cd my_proj
C:/Python39/python.exe -m venv .venv
</code></pre>
<ol start="3">
<li>Now activate the environment</li>
</ol>
<pre><code class="language-bash">./.venv/scripts/Activate
</code></pre>
<p>if you are developing a module then you need to have a separate staging area for the module so that we can develop and test,</p>
<pre><code class="language-bash">mkdir lib_staging
</code></pre>
<p>Now we need to add this directory to the python module search path in a the file <code>sitecustomize.py</code>
located in <code>.venv</code> directory,</p>
<p><code>.venv/sitecustomize.py</code></p>
<pre><code class="language-python">import sys, os
sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), "../lib_staging")))
</code></pre>
<p>You can place your modules in lib_staging area as a git sub-project or however the way you want to
manage development.</p>
<p>To deactivate python local environment</p>
<pre><code class="language-bash">deactivate
</code></pre>
<h2 id="venv-to-generate-requirementstxt"><a class="header" href="#venv-to-generate-requirementstxt">venv to generate requirements.txt</a></h2>
<pre><code class="language-bash">pip freeze &gt; requirements.txt
</code></pre>
<p>To load all the libraries in virtual environment</p>
<pre><code class="language-bash">pip install -r requirements.txt
</code></pre>
<h2 id="some-python-request-module-issues-with-ssl"><a class="header" href="#some-python-request-module-issues-with-ssl">some python request module issues with SSL</a></h2>
<ul>
<li><a href="https://stackoverflow.com/questions/51925384/unable-to-get-local-issuer-certificate-when-using-requests-in-python">https://stackoverflow.com/questions/51925384/unable-to-get-local-issuer-certificate-when-using-requests-in-python</a></li>
</ul>
<p>Sometimes, when you are behind a company proxy, it replaces the certificate chain with the ones of Proxy. Adding the certificates in cacert.pem used by certifi should solve the issue.</p>
<ol>
<li>Find the path where cacert.pem is located -</li>
</ol>
<blockquote>
<p>Install certifi, if you don't have. Command: <code>pip install certifi</code></p>
</blockquote>
<pre><code>import certifi
certifi.where()
C:\\Users\\[UserID]\\AppData\\Local\\Programs\\Python\\Python37-32\\lib\\site-packages\\certifi\\cacert.pem
</code></pre>
<ol start="2">
<li>Open the URL (or base URL) on a browser. Browser will download the certificates of chain of trust from the URL.
The chain looks like,</li>
</ol>
<pre><code>Root Authority (you probably already have this) 
+-- Local Authority (might be missing)
    +-- Site certificate (you don't need this)
</code></pre>
<ol start="3">
<li>
<p>You can save the whole chain as <code>.p7b</code> file, which can be opened in windows explorer. Or you can just save the Local Authority as Base64 encoded <code>.cer</code> files.</p>
</li>
<li>
<p>Now open the cacert.pem in a notepad and just add every downloaded certificate contents (<code>---Begin Certificate--- *** ---End Certificate---</code>) at the end.</p>
</li>
</ol>
<h2 id="python-image-manipulation-as-they-are-downloaded"><a class="header" href="#python-image-manipulation-as-they-are-downloaded">python image manipulation as they are downloaded</a></h2>
<pre><code class="language-python">import os
import io
import requests
from PIL import Image
import tempfile

buffer = tempfile.SpooledTemporaryFile(max_size=1e9)
r = requests.get(img_url, stream=True)
if r.status_code == 200:
    downloaded = 0
    filesize = int(r.headers['content-length'])
    for chunk in r.iter_content(chunk_size=1024):
        downloaded += len(chunk)
        buffer.write(chunk)
        print(downloaded/filesize)
    buffer.seek(0)
    i = Image.open(io.BytesIO(buffer.read()))
    i.save(os.path.join(out_dir, 'image.jpg'), quality=85)
buffer.close()
</code></pre>
<ul>
<li><a href="https://stackoverflow.com/questions/37751877/downloading-image-with-pil-and-requests">https://stackoverflow.com/questions/37751877/downloading-image-with-pil-and-requests</a></li>
<li><a href="https://www.kite.com/python/answers/how-to-read-an-image-data-from-a-url-in-python">https://www.kite.com/python/answers/how-to-read-an-image-data-from-a-url-in-python</a></li>
</ul>
<h2 id="range-header-in-python"><a class="header" href="#range-header-in-python">Range header in python</a></h2>
<p>Large downloads are sometimes interrupted. However, a good HTTP server that
supports the Range header lets you resume the download from where it was
interrupted. The standard Python module urllib lets you access this
functionality almost seamlessly. You need to add only the needed header and
intercept the error code the server sends to confirm that it will respond with a
partial file:</p>
<pre><code class="language-python">import urllib, os

class myURLOpener(urllib.FancyURLopener):
    """ Subclass to override error 206 (partial file being sent); okay for us """
    def http_error_206(self, url, fp, errcode, errmsg, headers, data=None):
        pass    # Ignore the expected "non-error" code

def getrest(dlFile, fromUrl, verbose=0):
    loop = 1
    existSize = 0
    myUrlclass = myURLOpener(  )
    if os.path.exists(dlFile):
        outputFile = open(dlFile,"ab")
        existSize = os.path.getsize(dlFile)
        # If the file exists, then download only the remainder
        myUrlclass.addheader("Range","bytes=%s-" % (existSize))
    else:
        outputFile = open(dlFile,"wb")

    webPage = myUrlclass.open(fromUrl)
    if verbose:
        for k, v in webPage.headers.items(  ):
            print k, "=", v

    # If we already have the whole file, there is no need to download it again
    numBytes = 0
    webSize = int(webPage.headers['Content-Length'])
    if webSize == existSize:
        if verbose: print "File (%s) was already downloaded from URL (%s)"%(
            dlFile, fromUrl)
    else:
        if verbose: print "Downloading %d more bytes" % (webSize-existSize)
        while 1:
            data = webPage.read(8192)
            if not data:
                break
            outputFile.write(data)
            numBytes = numBytes + len(data)

    webPage.close(  )
    outputFile.close(  )

    if verbose:
        print "downloaded", numBytes, "bytes from", webPage.url
    return numbytes
</code></pre>
<p>The HTTP Range header lets the web server know that you want only a certain
range of data to be downloaded, and this recipe takes advantage of this header.
Of course, the server needs to support the Range header, but since the header is
part of the HTTP 1.1 specification, it’s widely supported. This recipe has been
tested with Apache 1.3 as the server, but I expect no problems with other
reasonably modern servers.</p>
<p>The recipe lets <code>urllib.FancyURLopener</code> to do all the hard work of adding a new
header, as well as the normal handshaking. I had to subclass it to make it known
that the error 206 is not really an error in this case—so you can proceed
normally. I also do some extra checks to quit the download if I’ve already
downloaded the whole file.</p>
<h2 id="yaml-file"><a class="header" href="#yaml-file">yaml file</a></h2>
<ul>
<li><a href="https://pyyaml.org/wiki/PyYAMLDocumentation">https://pyyaml.org/wiki/PyYAMLDocumentation</a></li>
<li><a href="https://www.andrewvillazon.com/validate-yaml-python-schema/">https://www.andrewvillazon.com/validate-yaml-python-schema/</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="python-library"><a class="header" href="#python-library">Python library</a></h1>
<h2 id="refactoring-library"><a class="header" href="#refactoring-library">Refactoring library</a></h2>
<p>Often time we have to move library functions from files to
files to reorganize. just to make sure they all functions
are same between old set of files to new set of files
following can be used,</p>
<p><code>compare_mods.py</code></p>
<pre><code class="language-python">import importlib

a = '''
chill_test
'''

b = '''
src.test.libtest1
books.book1.ch7
books.book1.ch8
books.book1.ch2_4
books.book1.ch5_6
experiment
'''

def funcs(mods: str) -&gt; set:
    l = mods.strip().split()
    mods = map(importlib.import_module, l)
    dirs = map(dir, mods)
    return set([i for d in dirs for i in d])

sa = funcs(a)
sb = funcs(b)
print(sa)
print(sb)
print (sa ^ sb)
</code></pre>
<p>where a is the list of old python modules and b is the new
ones.</p>
<h2 id="python-object"><a class="header" href="#python-object">Python object</a></h2>
<p>it is easy to create an object and attributes.</p>
<pre><code class="language-python">obj = lambda: None
obj.exclude = 'hello'
</code></pre>
<h3 id="turning-a-dict-to-object"><a class="header" href="#turning-a-dict-to-object">Turning a dict to object</a></h3>
<pre><code class="language-python">attr = {"a" : "b", "c": "d", "e": "f"}
obj = lambda: None
obj.__dict__ = attr

print(obj.a)
print(obj.c)
print(obj.e)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="java-to-go-language"><a class="header" href="#java-to-go-language">Java to Go language</a></h1>
<p>I have written large Java projects in the past, I have used proprietary
tools to turn them into native executable. The Go language provides a nice
alternative with several important advantages. Now I am looking into some
automated way to convert may Java codes into Go with minimal manual
conversions. LLVM, antlr and other tools I am looking at. This will be a
work in progress for near future.</p>
<h2 id="links"><a class="header" href="#links">Links</a></h2>
<ul>
<li><a href="https://github.com/dglo/java2go">https://github.com/dglo/java2go</a>.</li>
<li><a href="https://github.com/andrewarrow/traot">https://github.com/andrewarrow/traot</a>.</li>
<li><a href="https://talks.golang.org/2015/go-for-java-programmers.slide">https://talks.golang.org/2015/go-for-java-programmers.slide</a>.</li>
<li><a href="https://talks.golang.org/2015/go-for-java-programmers">https://talks.golang.org/2015/go-for-java-programmers</a>.</li>
<li><a href="https://talks.golang.org">https://talks.golang.org</a>.</li>
</ul>
<h2 id="llvm"><a class="header" href="#llvm">LLVM</a></h2>
<ul>
<li><a href="https://youtu.be/a5-WaD8VV38">A Brief Introduction to LLVM</a>.</li>
<li><a href="https://youtu.be/VKIv_Bkp4pk">Introduction to LLVM Building simple program analysis tools and instrumentation</a>.</li>
</ul>
<h2 id="polyglot"><a class="header" href="#polyglot">Polyglot</a></h2>
<ul>
<li><a href="https://research.cs.cornell.edu/polyglot/">An open compiler front end framework for
building Java language extensions</a>.</li>
</ul>
<h2 id="graal"><a class="header" href="#graal">GRAAL</a></h2>
<ul>
<li><a href="https://youtu.be/14hqB7Q0I58">How to Create a New JVM Language in Under an Hour by Oleg Šelajev</a>.</li>
</ul>
<h2 id="some-info-on-go"><a class="header" href="#some-info-on-go">Some info on go</a></h2>
<ul>
<li>Default go library install path for a user in windows, <code>%UserProfile%\go</code> directory. Check <a href="https://superuser.com/questions/217504/is-there-a-list-of-windows-special-directories-shortcuts-like-temp">Windows special directories/shortcuts</a> for similar paths in windows.</li>
<li>Pigeon is a PEG based parser generator in go. We can use antlr java grammar from and convert in a Pigeon gammer file and use Pigeon to parse.
Check <a href="https://pkg.go.dev/github.com/mna/pigeon?tab=doc">Documentation</a>.</li>
</ul>
<h2 id="use-antlr-and-keep-everything-in-java-world-to-translate"><a class="header" href="#use-antlr-and-keep-everything-in-java-world-to-translate">Use antlr and keep everything in Java world to translate</a></h2>
<h2 id="use-antlr-to-generate-a-java-parser-in-with-golang"><a class="header" href="#use-antlr-to-generate-a-java-parser-in-with-golang">Use antlr to generate a java parser in with golang</a></h2>
<p>I prefer this option. This seems to be the path of lease resistance for now.</p>
<ul>
<li><a href="https://blog.gopheracademy.com/advent-2017/parsing-with-antlr4-and-go/">Parsing with ANTLR 4 and Go</a>.
The author has already created golang parsers for all available grammars in (Github)[https://github.com/bramp/antlr4-grammars.git].</li>
</ul>
<h2 id="manual-porting"><a class="header" href="#manual-porting">Manual porting</a></h2>
<ul>
<li><a href="https://blog.kowalczyk.info/article/19f2fe97f06a47c3b1f118fd06851fad/lessons-learned-porting-50k-loc-from-java-to-go.html">Lessons learned porting 50k loc from Java to Go</a></li>
</ul>
<p>Edited excerpts from the article,</p>
<h3 id="string-vs-string"><a class="header" href="#string-vs-string">String vs. string</a></h3>
<p>In Java, <code>String</code> is an object
that really is a reference (a pointer). As a result, a string can be <code>null</code>.
In Go <code>string</code> is a value type.
It can't be <code>nil</code>, only empty.</p>
<blockquote>
<p>Idea: mechanically replace <code>null</code> with <code>""</code>.</p>
</blockquote>
<h3 id="errors-vs-exceptions"><a class="header" href="#errors-vs-exceptions">Errors vs. exceptions</a></h3>
<p>Java uses exceptions to communicate errors.
Go returns values of <code>error</code>
interface.</p>
<blockquote>
<p>Idea: Change function signatures to return error values and propagate them up the call
stack.</p>
</blockquote>
<h3 id="generics"><a class="header" href="#generics">Generics</a></h3>
<p>Go doesn't have Generics.
Porting generic APIs was the biggest
challenge.</p>
<p>Here's an example of a generic method in
Java:</p>
<pre><code>public &lt;T&gt; T load(Class&lt;T&gt; clazz, String id) {
</code></pre>
<p>And the caller:</p>
<pre><code>Foo foo = load(Foo.class, "id")
</code></pre>
<p>Two strategies can be useful.</p>
<p>One is to use <code>interface{}</code>,
which combines value and its type, similar to <code>object</code> in Java. This is not preferred
approach. While it works, operating on <code>interface{}</code> is clumsy for the user of the
library.</p>
<p>The other is to use reflection
and the above code was ported as:</p>
<pre><code>func Load(result interface{}, id string) error
</code></pre>
<p>Reflection to query type of
<code>result</code> can be used to create values of that type from JSON document.</p>
<p>And the caller side:</p>
<pre><code>var result *Foo
err := Load(&amp;result, "id")
</code></pre>
<h3 id="function-overloading"><a class="header" href="#function-overloading">Function overloading</a></h3>
<p>Go doesn't have overloading.</p>
<p>Java:</p>
<pre><code>void foo(int a, String b) {}
void foo(int a) { foo(a, null); }
</code></pre>
<p>In go write 2 functions instead:</p>
<pre><code>func foo(a int) {}
func fooWithB(a int, b string) {}
</code></pre>
<p>When number of potential arguments was large
use a struct:</p>
<pre><code>type FooArgs struct {
	A int
	B string
}
func foo(args *FooArgs) { }
</code></pre>
<h3 id="inheritance"><a class="header" href="#inheritance">Inheritance</a></h3>
<p>Go is not especially object-oriented and
doesn't have inheritance.
Simple cases of inheritance can be ported
with embedding.</p>
<pre><code>class B : A { }
</code></pre>
<p>Can sometimes be ported as:</p>
<pre><code>type A struct { }
type B struct {
	A
}
</code></pre>
<p>We've embedded <code>A</code> inside
<code>B</code>, so <code>B</code> inherit all the methods and fields of <code>A</code>.</p>
<p>It doesn't work for virtual functions.
There is no good way to directly port code
that uses virtual functions.
One option to emulate virtual function is to
use embedding of structs and function pointers. This essentially re-implements virtual table
that Java gives you for free as part of <code>object</code> implementation.</p>
<p>Another option is to write a stand-alone
function that dispatches the right function for a given type by using type switch.</p>
<h3 id="interfaces"><a class="header" href="#interfaces">Interfaces</a></h3>
<p>Both Java and Go have interfaces but they
are different things. You can create a Go interface type
that replicated Java interface.</p>
<p>Or just dont use interfaces, instead use exposed concrete structs in the API.</p>
<h3 id="circular-imports-between-packages"><a class="header" href="#circular-imports-between-packages">Circular imports between packages</a></h3>
<p>Java allows circular imports between
packages.
Go does not.
As a result you will not able to replicate the
package structure of Java code. Restructuring will be needed.</p>
<h3 id="private-public-protected"><a class="header" href="#private-public-protected">Private, public, protected</a></h3>
<p>Go simplified access by only having public vs.
private and scoping access to package level.</p>
<h3 id="concurrency"><a class="header" href="#concurrency">Concurrency</a></h3>
<p>Go's concurrency is simply the best and a
built-in race detector is of great help in repelling concurrency bugs.</p>
<p>Mechanical translation will require
restructuring it to be more Go idiomatic.</p>
<h3 id="fluent-function-chaining"><a class="header" href="#fluent-function-chaining">Fluent function chaining</a></h3>
<p>Java has function chaining like this,</p>
<pre><code>List&lt;ReduceResult&gt; results = session.query(User.class)
                        .groupBy("name")
                        .selectKey()
                        .selectCount()
                        .orderByDescending("count")
                        .ofType(ReduceResult.class)
                        .toList();
</code></pre>
<p>This only works in languages that
communicate errors via exceptions. When a function additionally returns an error, it's no longer
possible to chain it like that.</p>
<p>To replicate chaining in Go,
"stateful error" approach would be useful:</p>
<pre><code>type Query struct {
	err error
}

func (q *Query) WhereEquals(field string, val interface{}) *Query {
	if q.err != nil {
		return q
	}
	// logic that might set q.err
	return q
}

func (q *Query) GroupBy(field string) *Query {
if q.err != nil {
		return q
	}
	// logic that might set q.err
	return q
}

func (q *Query) Execute(result interface{}) error {
	if q.err != nil {
		return q.err
	}
	// do logic
}
</code></pre>
<p>This can be chained:</p>
<pre><code>var result *Foo
err := NewQuery().WhereEquals("Name", "Frank").GroupBy("Age").Execute(&amp;result)
</code></pre>
<h3 id="go-code-is-shorter"><a class="header" href="#go-code-is-shorter">Go code is shorter</a></h3>
<p>This is not so much a property of Java but
the culture which dictates what is considered an idiomatic code.</p>
<p>In Java setter and getter methods are
common. As a result, Java code:</p>
<pre><code>class Foo {
	private int bar;

	public void setBar(int bar) {
		this.bar = bar;
	}

	public int getBar() {
		return this.bar;
	}
}
</code></pre>
<p>ends up in Go as:</p>
<pre><code>type Foo struct {
	Bar int
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="java-to-javascript-language"><a class="header" href="#java-to-javascript-language">Java to Javascript language</a></h1>
<h2 id="j2cl"><a class="header" href="#j2cl">j2cl</a></h2>
<p>Google transpiler <a href="https://github.com/google/j2cl">j2cl</a> transpile and uses closure to clean the produced javascript. It is written in java.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="python-to-go-language"><a class="header" href="#python-to-go-language">Python to Go language</a></h1>
<h2 id="grumpy"><a class="header" href="#grumpy">grumpy</a></h2>
<p><a href="https://github.com/google/grumpy">grumpy</a> is by google, but it supports python 2.7 only.
I am exploring my own python 3.x transpiler solution. Work in progress.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="python-to-javascript-language"><a class="header" href="#python-to-javascript-language">Python to Javascript language</a></h1>
<p>I have written large Python projects in the past, looking into converting some to javascript.</p>
<h2 id="links-1"><a class="header" href="#links-1">Links</a></h2>
<ul>
<li><a href="https://www.transcrypt.org/">https://www.transcrypt.org/</a></li>
</ul>
<h2 id="setup-transcrypt"><a class="header" href="#setup-transcrypt">setup transcrypt</a></h2>
<p>We have to use python <a href="topics/python.html#virtual-environment-for-python">virtual</a> environment for <code>transcrypt</code> to function correctly.</p>
<p>Now install <code>transcrypt</code></p>
<pre><code class="language-bash">pip install transcrypt
</code></pre>
<h2 id="converting-to-javascript"><a class="header" href="#converting-to-javascript">converting to javascript</a></h2>
<p>have a python file
<code>test-trans.py</code></p>
<pre><code class="language-python">import os
from pathlib import Path

inifile = os.path.join(Path.home(), ".imagesel", "config.ini")
print(inifile)
</code></pre>
<p>now test it with python</p>
<pre><code>py test-trans.py
</code></pre>
<p>in order to use os and pathlib we need to replace them with equivalent javascript calls
using stubs. we will create stubs in dir called <code>stubs</code>
these are special python files that can use javascript libraries.</p>
<p><code>os.py</code></p>
<pre><code class="language-python">p = require('path')

class path:
    def join(*args):
        return p.join(*args)
</code></pre>
<p><code>pathlib.py</code></p>
<pre><code class="language-python">os = require ('os')

class Path:
    def home():
        return os.homedir()
</code></pre>
<p>Now we can convert them to javascript</p>
<pre><code class="language-bash">python -m transcrypt -b -n ..\test-trans.py
</code></pre>
<p>This will produce a directory called <code>__target__</code> with all the javascript files in it.</p>
<h2 id="converting-to-a-node-bundle"><a class="header" href="#converting-to-a-node-bundle">converting to a node bundle</a></h2>
<p>Now initialize node environment and install rollup</p>
<pre><code class="language-bash">npm init // accept defaults
npm i rollup
</code></pre>
<p>Next we need to use rollup to bundle them for node,</p>
<pre><code class="language-bash">node_modules\.bin\rollup .\__target__\test-trans.js --o bundle.js --f cjs
</code></pre>
<p>Now test it with node</p>
<pre><code>node bundle.js
</code></pre>
<p>We get the same result.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="compilersparsers"><a class="header" href="#compilersparsers">Compilers/Parsers</a></h1>
<h2 id="earley-vs-peg-parsers"><a class="header" href="#earley-vs-peg-parsers">Earley v/s PEG parsers</a></h2>
<p>Earley and PEG parsers are two different parsing algorithms with some
similarities and differences.</p>
<p>Earley parser is a general-purpose parsing algorithm that can parse any
context-free grammar. It uses a dynamic programming technique to predict, scan,
and complete input tokens to construct a parse tree. Earley parser can handle
ambiguous grammars and provides the most expressive power, but it can also be
slow for large grammars or inputs.</p>
<p>PEG (Parsing Expression Grammar) parser, on the other hand, is a top-down
parsing algorithm that matches input against a set of parsing expressions, which
are similar to regular expressions but with more features. PEG parser
prioritizes parsing rules and avoids ambiguities by always choosing the first
matching rule. PEG parsers can be fast and efficient for parsing structured
text, but they may not be suitable for complex grammars that require
backtracking or lookahead.</p>
<p>Here are some key differences between Earley and PEG parsers:</p>
<ul>
<li>Earley parser can handle arbitrary context-free grammars, whereas PEG parser
can only handle a subset of context-free grammars that are deterministic and
unambiguous.</li>
<li>Earley parser uses a bottom-up parsing approach, whereas PEG parser uses a
top-down parsing approach.</li>
<li>Earley parser can handle ambiguity by constructing multiple parse trees,
whereas PEG parser resolves ambiguity by prioritizing rules and not
backtracking.</li>
</ul>
<p>In summary, Earley parser is more general and powerful but can be slower and
more memory-intensive than PEG parser. PEG parser is more limited in scope but
can be faster and easier to use for certain types of parsing tasks.</p>
<h2 id="more-on-parsing-concepts"><a class="header" href="#more-on-parsing-concepts">More on parsing concepts</a></h2>
<ul>
<li><a href="https://brilliant.org/wiki/context-free-grammars/#:~:text=Context%2Dfree%20grammars%20are%20studied,automatically%20from%20context%2Dfree%20grammars.">Context Free
Grammars</a></li>
<li><a href="https://loup-vaillant.fr/tutorials/earley-parsing/">Earley Parser</a></li>
</ul>
<h2 id="python-based-parsers"><a class="header" href="#python-based-parsers">Python based parsers</a></h2>
<ul>
<li><a href="https://github.com/lark-parser/lark">lark parser</a></li>
</ul>
<h2 id="java-based-parsers"><a class="header" href="#java-based-parsers">Java based parsers</a></h2>
<ul>
<li><a href="https://www.antlr.org/">Antlr4</a></li>
</ul>
<blockquote>
<p>todo: vscode setup for antlr.</p>
</blockquote>
<h2 id="rust-based-parsers"><a class="header" href="#rust-based-parsers">Rust based parsers</a></h2>
<ul>
<li><a href="https://rust-hosted-langs.github.io/book/">Writing Interpreters in Rust: a
Guide</a></li>
<li><a href="https://vishpat.github.io/lisp-rs/">Lisp interpreter in Rust</a></li>
<li><a href="https://github.com/TheDan64/inkwell">Wrapper for Exposing LLVM</a></li>
<li><a href="https://github.com/lalrpop/lalrpop">LR(1) parser generator for Rust</a></li>
<li>Building a compiler in Rust videos, <a href="https://youtu.be/KZokxZrghCc">part1</a> and
<a href="https://youtu.be/BmsSu_WV9Ak">part2</a></li>
<li><a href="https://createlang.rs/intro.html">Create Your Own Programming Language with
Rust</a></li>
<li><a href="https://rustc-dev-guide.rust-lang.org/">Rust Compiler Development Guide</a></li>
<li><a href="https://github.com/kevinmehall/rust-peg">PEG parser generator for Rust</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="peg-parsers"><a class="header" href="#peg-parsers">Peg Parsers</a></h1>
<h2 id="peg-and-packrat"><a class="header" href="#peg-and-packrat">PEG and Packrat</a></h2>
<p>A Packrat parser is a memoizing variant of PEG that can avoid redundant
computation by caching intermediate parsing results. This memoization helps to
handle backtracking efficiently and can also improve the performance of parsing
long input sequences.</p>
<h2 id="articles-1"><a class="header" href="#articles-1">Articles</a></h2>
<ul>
<li>Wikipedia <a href="https://en.wikipedia.org/wiki/Parsing_expression_grammar">Parsing expression
grammar</a>.</li>
<li><a href="https://medium.com/@gvanrossum_83706/peg-parsing-series-de5d41b2ed60">PEG Parsing Series
Overview</a>,
YouTube <a href="https://youtu.be/QppWTvh7_sI">"Writing a PEG parser for fun and profit" - Guido van Rossum (North
Bay Python 2019)</a>.</li>
<li><a href="https://bford.info/packrat/">Packrat Parsing</a>.</li>
</ul>
<h2 id="typescript-1"><a class="header" href="#typescript-1">Typescript</a></h2>
<ul>
<li><a href="https://vey.ie/2019/11/27/tsPEG.html">tsPEG - A Fully Featured TypeScript Parser
Generator</a>, GitHub
<a href="https://github.com/EoinDavey/tsPEG">Source</a>.</li>
</ul>
<h2 id="javascript"><a class="header" href="#javascript">Javascript</a></h2>
<ul>
<li><a href="https://pegjs.org/">https://pegjs.org/</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="earley-parsers"><a class="header" href="#earley-parsers">Earley parsers</a></h1>
<h2 id="javascript-1"><a class="header" href="#javascript-1">Javascript</a></h2>
<ul>
<li><a href="https://nearley.js.org/">https://nearley.js.org/</a>. Use it with lexer <a href="https://github.com/no-context/moo">https://github.com/no-context/moo</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="linux-from-scratch"><a class="header" href="#linux-from-scratch">Linux from scratch</a></h1>
<h2 id="projects-using-lfs"><a class="header" href="#projects-using-lfs">Projects using LFS</a></h2>
<ul>
<li><a href="https://github.com/jfdelnero/LinuxFromScratch">Linux From scratch build scripts</a></li>
<li><a href="http://www.linuxfromscratch.org/hints/downloads/files/dpkg.txt">Use dpkg (.deb) package management on LFS 6.3</a></li>
<li><a href="http://www.linuxfromscratch.org/hints/downloads/files/fakeroot.txt">Fakeroot approach for package installation</a></li>
<li><a href="https://clfs.org/view/clfs-embedded/arm/">LFS cross compile for arm</a></li>
<li><a href="https://pixelspark.nl/2019/making-your-own-linux-distribution-for-the-raspberry-pi-for-fun-and-profit-part-1">Making your own Linux distribution for the Raspberry Pi</a></li>
<li><a href="http://www.tldp.org/">The Linux Documentation Project</a></li>
<li><a href="https://www.tldp.org/HOWTO/Program-Library-HOWTO/index.html">https://www.tldp.org/HOWTO/Program-Library-HOWTO/index.html</a></li>
<li><a href="https://github.com/LeeKyuHyuk/PiCLFS">Cross Linux From Scratch (CLFS) on the Raspberry Pi</a></li>
<li><a href="https://github.com/hisham-maged10/Building-Linux-From-Scratch">someones journal of building LFS</a></li>
<li><a href="https://solarianprogrammer.com/2018/05/06/building-gcc-cross-compiler-raspberry-pi/">Building GCC as a cross compiler for Raspberry Pi</a></li>
<li><a href="https://github.com/reinterpretcat/lfs">Docker configuration for building Linux From Scratch system</a></li>
</ul>
<h2 id="lfs-with-wsl2"><a class="header" href="#lfs-with-wsl2">LFS with wsl2</a></h2>
<p>Get the <a href="http://www.linuxfromscratch.org/lfs/download.html">LFS book</a>. This book provides step by step guide to build an LFS system. Following will provide steps for chapter 1 &amp; 2.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="lfs-part-1"><a class="header" href="#lfs-part-1">LFS (Part 1)</a></h1>
<h2 id="chapter-1-and-2-setup-and-disc-image"><a class="header" href="#chapter-1-and-2-setup-and-disc-image">Chapter 1 and 2, Setup and Disc image</a></h2>
<p>We will be needing few packages that we will install if they are not installed,</p>
<pre><code class="language-bash">sudo apt-get install subversion xsltproc
</code></pre>
<p>run setup.sh which will create <code>sourceMe.sh</code> in the current folder. It will also download the book source to create other scripts and files.</p>
<pre><code class="language-bash">sh /mnt/c/Users/&lt;user&gt;/Documents/linux/LFS/lfs-scripts/setup.sh
</code></pre>
<p>Now source <code>sourceMe.sh</code> to mount the scripts</p>
<pre><code class="language-bash">$ source sourceMe.sh
Mounting /mnt/c/Users/&lt;user&gt;/Documents/linux/LFS/lfs-scripts on lfs-scripts
umount: lfs-scripts: not mounted.
sh: mount-lfs.sh: No such file or directory
</code></pre>
<p>Check the requirements for LFS,</p>
<pre><code class="language-bash">sh lfs-scripts/version-check.sh
</code></pre>
<p>Change shell to bash from dash if necessary,</p>
<pre><code class="language-bash">sh lfs-scripts/ch2bash.sh
</code></pre>
<p>Let us create an empty disk image with two partitions,</p>
<pre><code class="language-bash">sh lfs-scripts/mkdiscimg.sh
</code></pre>
<p>This will create <code>lfs.img</code> with two partitions and a script <code>mount-lfs.sh</code> to mount the image. Check the image,</p>
<pre><code class="language-bash">$ fdisk -lu lfs.img
Disk lfs.img: 10.26 GiB, 11010048000 bytes, 21504000 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0x0e0d22a7

Device     Boot  Start      End  Sectors  Size Id Type
lfs.img1          8192   532479   524288  256M  c W95 FAT32 (LBA)
lfs.img2        532480 21503999 20971520   10G 83 Linux
</code></pre>
<p>Now source <code>sourceMe.sh</code> the second time to mount the image.</p>
<p>From now on, you can source <code>sourceMe.sh</code> before you start working to have everything setup after you boot between steps if necessary.</p>
<p>We are ready to go with chapter 3.</p>
<h2 id="chapter-3-get-sources"><a class="header" href="#chapter-3-get-sources">Chapter 3, Get sources</a></h2>
<p>When we ran <code>setup.sh</code>, it downloaded the book and created,</p>
<ul>
<li><code>packages.sh</code></li>
<li><code>patches.sh</code></li>
<li><code>wget-list</code></li>
<li><code>md5sums</code>
Feel free to examine them.</li>
</ul>
<p>Lets proceed to download the sources,</p>
<pre><code class="language-bash">sudo mkdir -v $LFS/sources
sudo chmod -v a+wt $LFS/sources
wget --input-file=wget-list --continue --directory-prefix=$LFS/sources
cp md5sums $LFS/sources
pushd $LFS/sources
md5sum -c md5sums
popd
</code></pre>
<p>Note that if a download fails you have to find an alternate source by googling and then adjust <code>wget-list</code>.
At the time of this writing mpfr url had to be changed to <code>https://ftp.gnu.org/gnu/mpfr/mpfr-4.0.2.tar.xz</code>.</p>
<blockquote>
<p>Writing a makefile using <code>packages.sh</code> and <code>patches.sh</code> could be an alternative.</p>
</blockquote>
<p>We are ready to go with chapter 4.</p>
<h2 id="chapter-4-setup-user-to-build-toolchain"><a class="header" href="#chapter-4-setup-user-to-build-toolchain">Chapter 4, Setup user to build toolchain</a></h2>
<p>create user <code>lfs</code> and set permissions,</p>
<pre><code class="language-bash">sudo mkdir -v $LFS/tools
sudo ln -sv $LFS/tools /
sudo groupadd lfs
sudo useradd -s /bin/bash -g lfs -m -k /dev/null lfs
sudo passwd lfs
sudo chown -v lfs $LFS/tools
sudo chown -v lfs $LFS/sources
</code></pre>
<p>Login as <code>lfs</code>,</p>
<pre><code class="language-bash">su - lfs
</code></pre>
<p>Setup <code>lfs</code>'s environment,</p>
<pre><code class="language-bash">cat &gt; ~/.bash_profile &lt;&lt; "EOF"
exec env -i HOME=$HOME TERM=$TERM PS1='\u:\w\$ ' /bin/bash
EOF

cat &gt; ~/.bashrc &lt;&lt; "EOF"
set +h
umask 022
LFS=/mnt/lfs
LC_ALL=POSIX
LFS_TGT=$(uname -m)-lfs-linux-gnu
PATH=/tools/bin:/bin:/usr/bin
export LFS LC_ALL LFS_TGT PATH
EOF

source ~/.bash_profile
</code></pre>
<p>This concludes chapter 4. Go to <a href="topics/lfs2">Part 2</a> for next chapters.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="lfs-part-2"><a class="header" href="#lfs-part-2">LFS (Part 2)</a></h1>
<h2 id="chapter-5-build-toolchain"><a class="header" href="#chapter-5-build-toolchain">Chapter 5, Build Toolchain</a></h2>
<p>In chapter 5, prepare <code>lib</code> folders and go to <code>sources</code> folder,</p>
<pre><code class="language-bash">case $(uname -m) in
 x86_64) mkdir -v /tools/lib &amp;&amp; ln -sv lib /tools/lib64 ;;
esac
cd $LFS/sources
</code></pre>
<h3 id="build-pass-1-binutils"><a class="header" href="#build-pass-1-binutils">Build pass 1 binutils</a></h3>
<pre><code class="language-bash">tar -xvf binutils-2.34.tar.xz
pushd binutils-2.34

mkdir -v build
cd build

../config.guess
../configure --prefix=/tools \
 --with-sysroot=$LFS \
 --with-lib-path=/tools/lib \
 --target=$LFS_TGT \
 --disable-nls \
 --disable-werror

make
make install

# if everything went fine we can remove
popd
rm -rf binutils-2.34
</code></pre>
<h3 id="build-pass-1-gcc"><a class="header" href="#build-pass-1-gcc">build pass 1 gcc</a></h3>
<pre><code class="language-bash">tar -xvf gcc-9.2.0.tar.xz
pushd gcc-9.2.0

tar -xf ../mpfr-4.0.2.tar.xz
mv -v mpfr-4.0.2 mpfr
tar -xf ../gmp-6.2.0.tar.xz
mv -v gmp-6.2.0 gmp
tar -xf ../mpc-1.1.0.tar.gz
mv -v mpc-1.1.0 mpc

for file in gcc/config/{linux,i386/linux{,64}}.h
do
 cp -uv $file{,.orig}
 sed -e 's@/lib\(64\)\?\(32\)\?/ld@/tools&amp;@g' \
 -e 's@/usr@/tools@g' $file.orig &gt; $file
 echo '
#undef STANDARD_STARTFILE_PREFIX_1
#undef STANDARD_STARTFILE_PREFIX_2
#define STANDARD_STARTFILE_PREFIX_1 "/tools/lib/"
#define STANDARD_STARTFILE_PREFIX_2 ""' &gt;&gt; $file
 touch $file.orig
done

case $(uname -m) in
 x86_64)
 sed -e '/m64=/s/lib64/lib/' \
 -i.orig gcc/config/i386/t-linux64
 ;;
esac

mkdir -v build
cd build

../configure \
 --target=$LFS_TGT \
 --prefix=/tools \
 --with-glibc-version=2.11 \
 --with-sysroot=$LFS \
 --with-newlib \
 --without-headers \
 --with-local-prefix=/tools \
 --with-native-system-header-dir=/tools/include \
 --disable-nls \
 --disable-shared \
 --disable-multilib \
 --disable-decimal-float \
 --disable-threads \
 --disable-libatomic \
 --disable-libgomp \
 --disable-libquadmath \
 --disable-libssp \
 --disable-libvtv \
 --disable-libstdcxx \
 --enable-languages=c,c++

# take a cup of coffee and relax
make
make install

popd
rm -rf gcc-9.2.0
</code></pre>
<h3 id="install-linux-headers"><a class="header" href="#install-linux-headers">Install linux headers</a></h3>
<pre><code class="language-bash">tar -xvf linux-5.5.3.tar.xz
pushd linux-5.5.3

make mrproper
make headers
cp -rv usr/include/* /tools/include

popd
rm -rf linux-5.5.3
</code></pre>
<h3 id="build-glibc"><a class="header" href="#build-glibc">Build Glibc</a></h3>
<pre><code class="language-bash">tar -xvf glibc-2.31.tar.xz
pushd glibc-2.31

mkdir -v build
cd build

../configure \
 --prefix=/tools \
 --host=$LFS_TGT \
 --build=$(../scripts/config.guess) \
 --enable-kernel=3.2 \
 --with-headers=/tools/include

make
make install

popd
rm -rf glibc-2.31
</code></pre>
<p>Test the build,</p>
<pre><code class="language-bash">mkdir test
pushd test
echo 'int main(){}' &gt; dummy.c
$LFS_TGT-gcc dummy.c
readelf -l a.out | grep ': /tools'
popd
rm -rf test
</code></pre>
<p>This should produce output,</p>
<pre><code class="language-text">[Requesting program interpreter: /tools/lib64/ld-linux-x86-64.so.2]
</code></pre>
<p>Note that for 32-bit machines, the interpreter name will be /tools/lib/ld-linux.so.2.</p>
<h3 id="build-libstdc"><a class="header" href="#build-libstdc">Build Libstdc++</a></h3>
<pre><code class="language-bash">tar -xvf gcc-9.2.0.tar.xz
pushd gcc-9.2.0
mkdir -v build
cd build

../libstdc++-v3/configure \
 --host=$LFS_TGT \
 --prefix=/tools \
 --disable-multilib \
 --disable-nls \
 --disable-libstdcxx-threads \
 --disable-libstdcxx-pch \
 --with-gxx-include-dir=/tools/$LFS_TGT/include/c++/9.2.0

make
make install

popd
rm -rf gcc-9.2.0
</code></pre>
<h3 id="build-pass-2-binutils"><a class="header" href="#build-pass-2-binutils">Build pass 2 binutils</a></h3>
<pre><code class="language-bash">tar -xvf binutils-2.34.tar.xz
pushd binutils-2.34

mkdir -v build
cd build

CC=$LFS_TGT-gcc \
AR=$LFS_TGT-ar \
RANLIB=$LFS_TGT-ranlib \
../configure \
 --prefix=/tools \
 --disable-nls \
 --disable-werror \
 --with-lib-path=/tools/lib \
 --with-sysroot

make
make install

make -C ld clean
make -C ld LIB_PATH=/usr/lib:/lib
cp -v ld/ld-new /tools/bin

popd
rm -rf binutils-2.34
</code></pre>
<h3 id="build-pass-2-gcc"><a class="header" href="#build-pass-2-gcc">Build pass 2 gcc</a></h3>
<pre><code class="language-bash">tar -xvf gcc-9.2.0.tar.xz
pushd gcc-9.2.0

tar -xf ../mpfr-4.0.2.tar.xz
mv -v mpfr-4.0.2 mpfr
tar -xf ../gmp-6.2.0.tar.xz
mv -v gmp-6.2.0 gmp
tar -xf ../mpc-1.1.0.tar.gz
mv -v mpc-1.1.0 mpc

cat gcc/limitx.h gcc/glimits.h gcc/limity.h &gt; \
 `dirname $($LFS_TGT-gcc -print-libgcc-file-name)`/include-fixed/limits.h

for file in gcc/config/{linux,i386/linux{,64}}.h
do
 cp -uv $file{,.orig}
 sed -e 's@/lib\(64\)\?\(32\)\?/ld@/tools&amp;@g' \
 -e 's@/usr@/tools@g' $file.orig &gt; $file
 echo '
#undef STANDARD_STARTFILE_PREFIX_1
#undef STANDARD_STARTFILE_PREFIX_2
#define STANDARD_STARTFILE_PREFIX_1 "/tools/lib/"
#define STANDARD_STARTFILE_PREFIX_2 ""' &gt;&gt; $file
 touch $file.orig
done

case $(uname -m) in
 x86_64)
 sed -e '/m64=/s/lib64/lib/' \
 -i.orig gcc/config/i386/t-linux64
 ;;
esac

sed -e '1161 s|^|//|' \
 -i libsanitizer/sanitizer_common/sanitizer_platform_limits_posix.cc

# take a cup of coffee and relax
make
make install

ln -sv gcc /tools/bin/cc

popd
rm -rf gcc-9.2.0
</code></pre>
<p>Test the build,</p>
<pre><code class="language-bash">mkdir test
pushd test
echo 'int main(){}' &gt; dummy.c
cc dummy.c
readelf -l a.out | grep ': /tools'
popd
rm -rf test
</code></pre>
<p>This should produce output,</p>
<pre><code class="language-text">[Requesting program interpreter: /tools/lib64/ld-linux-x86-64.so.2]
</code></pre>
<p>Note that for 32-bit machines, the interpreter name will be /tools/lib/ld-linux.so.2.</p>
<h3 id="build-tcl"><a class="header" href="#build-tcl">Build Tcl</a></h3>
<pre><code class="language-bash">tar -xvf tcl8.6.10-src.tar.gz
pushd tcl8.6.10

cd unix
./configure --prefix=/tools

make
TZ=UTC make test
make install

chmod -v u+w /tools/lib/libtcl8.6.so
make install-private-headers
ln -sv tclsh8.6 /tools/bin/tclsh

popd
rm -rf tcl8.6.10
</code></pre>
<h3 id="build-expect"><a class="header" href="#build-expect">Build expect</a></h3>
<pre><code class="language-bash">tar -xvf expect5.45.4.tar.gz
pushd expect5.45.4

cp -v configure{,.orig}
sed 's:/usr/local/bin:/bin:' configure.orig &gt; configure

make
make test
make SCRIPTS="" install

popd
rm -rf expect5.45.4
</code></pre>
<h3 id="build-dejagnu"><a class="header" href="#build-dejagnu">build DejaGNU</a></h3>
<pre><code class="language-bash">tar -xvf dejagnu-1.6.2.tar.gz
pushd dejagnu-1.6.2

./configure --prefix=/tools
make install
make check

popd
rm -rf dejagnu-1.6.2
</code></pre>
<h3 id="build-m4"><a class="header" href="#build-m4">build M4</a></h3>
<pre><code class="language-bash">tar -xvf m4-1.4.18.tar.xz
pushd m4-1.4.18

sed -i 's/IO_ftrylockfile/IO_EOF_SEEN/' lib/*.c
echo "#define _IO_IN_BACKUP 0x100" &gt;&gt; lib/stdio-impl.h

./configure --prefix=/tools
make
make check
make install

popd
rm -rf m4-1.4.18
</code></pre>
<h3 id="build-ncurses"><a class="header" href="#build-ncurses">build Ncurses</a></h3>
<pre><code class="language-bash">tar -xvf ncurses-6.2.tar.gz
pushd ncurses-6.2

sed -i s/mawk// configure
./configure --prefix=/tools \
 --with-shared \
 --without-debug \
 --without-ada \
 --enable-widec \
 --enable-overwrite

make
make install
ln -s libncursesw.so /tools/lib/libncurses.so

popd
rm -rf ncurses-6.2
</code></pre>
<h3 id="build-bash"><a class="header" href="#build-bash">build bash</a></h3>
<pre><code class="language-bash">tar -xvf bash-5.0.tar.gz
pushd bash-5.0

./configure --prefix=/tools --without-bash-malloc

make
make tests
make install
ln -sv bash /tools/bin/sh

popd
rm -rf bash-5.0
</code></pre>
<h3 id="build-bison"><a class="header" href="#build-bison">build bison</a></h3>
<pre><code class="language-bash">tar -xvf bison-3.5.2.tar.xz
pushd bison-3.5.2

./configure --prefix=/tools

make
make check
make install

popd
rm -rf bison-3.5.2
</code></pre>
<h3 id="build-bzip2"><a class="header" href="#build-bzip2">build Bzip2</a></h3>
<pre><code class="language-bash">tar -xvf bzip2-1.0.8.tar.gz
pushd bzip2-1.0.8

make -f Makefile-libbz2_so
make clean
make
make PREFIX=/tools install
cp -v bzip2-shared /tools/bin/bzip2
cp -av libbz2.so* /tools/lib
ln -sv libbz2.so.1.0 /tools/lib/libbz2.so

popd
rm -rf bzip2-1.0.8
</code></pre>
<h3 id="build-coreutils"><a class="header" href="#build-coreutils">build Coreutils</a></h3>
<pre><code class="language-bash">tar -xvf coreutils-8.31.tar.xz
pushd coreutils-8.31

./configure --prefix=/tools --enable-install-program=hostname

make
make RUN_EXPENSIVE_TESTS=yes check
make install

popd
rm -rf coreutils-8.31
</code></pre>
<h3 id="build-diffutils"><a class="header" href="#build-diffutils">build Diffutils</a></h3>
<pre><code class="language-bash">tar -xvf diffutils-3.7.tar.xz
pushd diffutils-3.7

./configure --prefix=/tools

make
make check
make install

popd
rm -rf diffutils-3.7
</code></pre>
<h3 id="build-file"><a class="header" href="#build-file">build File</a></h3>
<pre><code class="language-bash">tar -xvf file-5.38.tar.gz
pushd file-5.38

./configure --prefix=/tools

make
make check
make install

popd
rm -rf file-5.38
</code></pre>
<h3 id="build-findutils"><a class="header" href="#build-findutils">build Findutils</a></h3>
<pre><code class="language-bash">tar -xvf findutils-4.7.0.tar.xz
pushd findutils-4.7.0

./configure --prefix=/tools

make
make check
make install

popd
rm -rf findutils-4.7.0
</code></pre>
<h3 id="build-gawk"><a class="header" href="#build-gawk">build gawk</a></h3>
<pre><code class="language-bash">tar -xvf gawk-5.0.1.tar.xz
pushd gawk-5.0.1

./configure --prefix=/tools

make
make check
make install

popd
rm -rf gawk-5.0.1
</code></pre>
<h3 id="build-gettext"><a class="header" href="#build-gettext">build gettext</a></h3>
<pre><code class="language-bash">tar -xvf gettext-0.20.1.tar.xz
pushd gettext-0.20.1

./configure --disable-shared

make
cp -v gettext-tools/src/{msgfmt,msgmerge,xgettext} /tools/bin

popd
rm -rf gettext-0.20.1
</code></pre>
<h3 id="build-grep"><a class="header" href="#build-grep">build grep</a></h3>
<pre><code class="language-bash">tar -xvf grep-3.4.tar.xz
pushd grep-3.4

./configure --prefix=/tools

make
make check
make install

popd
rm -rf grep-3.4
</code></pre>
<h3 id="build-gzip"><a class="header" href="#build-gzip">build gzip</a></h3>
<pre><code class="language-bash">tar -xvf gzip-1.10.tar.xz
pushd gzip-1.10

./configure --prefix=/tools

make
make check
make install

popd
rm -rf gzip-1.10
</code></pre>
<h3 id="build-make"><a class="header" href="#build-make">build make</a></h3>
<pre><code class="language-bash">tar -xvf make-4.3.tar.gz
pushd make-4.3

./configure --prefix=/tools --without-guile

make
make check
make install

popd
rm -rf make-4.3
</code></pre>
<h3 id="build-patch"><a class="header" href="#build-patch">build patch</a></h3>
<pre><code class="language-bash">tar -xvf patch-2.7.6.tar.xz
pushd patch-2.7.6

./configure --prefix=/tools

make
make check
make install

popd
rm -rf patch-2.7.6
</code></pre>
<h3 id="build-perl"><a class="header" href="#build-perl">build perl</a></h3>
<pre><code class="language-bash">tar -xvf perl-5.30.1.tar.xz
pushd perl-5.30.1

sh Configure -des -Dprefix=/tools -Dlibs=-lm -Uloclibpth -Ulocincpth

make
cp -v perl cpan/podlators/scripts/pod2man /tools/bin
mkdir -pv /tools/lib/perl5/5.30.1
cp -Rv lib/* /tools/lib/perl5/5.30.1

popd
rm -rf perl-5.30.1
</code></pre>
<h3 id="build-python"><a class="header" href="#build-python">build python</a></h3>
<pre><code class="language-bash">tar -xvf Python-3.8.1.tar.xz
pushd Python-3.8.1

sed -i '/def add_multiarch_paths/a \        return' setup.py
./configure --prefix=/tools --without-ensurepip

make
make install

popd
rm -rf Python-3.8.1
</code></pre>
<h3 id="build-sed"><a class="header" href="#build-sed">build sed</a></h3>
<pre><code class="language-bash">tar -xvf sed-4.8.tar.xz
pushd sed-4.8

./configure --prefix=/tools

make
make check
make install

popd
rm -rf sed-4.8
</code></pre>
<h3 id="build-tar"><a class="header" href="#build-tar">build tar</a></h3>
<pre><code class="language-bash">tar -xvf tar-1.32.tar.xz
pushd tar-1.32

./configure --prefix=/tools

make
make check
make install

popd
rm -rf tar-1.32
</code></pre>
<h3 id="build-texinfo"><a class="header" href="#build-texinfo">build Texinfo</a></h3>
<pre><code class="language-bash">tar -xvf texinfo-6.7.tar.xz
pushd texinfo-6.7

./configure --prefix=/tools

make
make check
make install

popd
rm -rf texinfo-6.7
</code></pre>
<h3 id="build-xz"><a class="header" href="#build-xz">build Xz</a></h3>
<pre><code class="language-bash">tar -xvf xz-5.2.4.tar.xz
pushd xz-5.2.4

./configure --prefix=/tools

make
make check
make install

popd
rm -rf xz-5.2.4
</code></pre>
<h3 id="wrap-up"><a class="header" href="#wrap-up">Wrap up</a></h3>
<p>Free 3gb space,</p>
<pre><code class="language-bash">strip --strip-debug /tools/lib/*
/usr/bin/strip --strip-unneeded /tools/{,s}bin/*

rm -rf /tools/{,share}/{info,man,doc}

find /tools/{lib,libexec} -name \*.la -delete

# go back to original login
exit
</code></pre>
<p>Back up the toolchain,</p>
<pre><code class="language-bash">sh bkuptc.sh
</code></pre>
<p>It will create <code>tools.tar.gz</code> in the <code>backup</code> folder in <code>/mnt/c/Users/&lt;user&gt;/Documents/linux/LFS</code>.</p>
<p>Change ownership to root,</p>
<pre><code class="language-bash">sudo chown -R root:root $LFS/tools
</code></pre>
<p>This concludes chapter 5. Go to <a href="topics/lfs3">Part 3</a> for next chapters.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="lfs-part-3"><a class="header" href="#lfs-part-3">LFS (Part 3)</a></h1>
<h2 id="chapter-6-build-root-filesystem"><a class="header" href="#chapter-6-build-root-filesystem">Chapter 6, Build root filesystem</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cross-compiling"><a class="header" href="#cross-compiling">Cross Compiling</a></h1>
<h2 id="cross-compile"><a class="header" href="#cross-compile">cross compile</a></h2>
<ul>
<li><a href="https://youtu.be/Pbt330zuNPc">Anatomy of Cross-Compilation Toolchains</a>.
The <a href="https://elinux.org/images/1/15/Anatomy_of_Cross-Compilation_Toolchains.pdf">slides</a>.</li>
</ul>
<h2 id="compiling-for-windows-in-linux"><a class="header" href="#compiling-for-windows-in-linux">compiling for windows in linux</a></h2>
<ul>
<li><a href="https://swarminglogic.com/article/2014_11_crosscompile">https://swarminglogic.com/article/2014_11_crosscompile</a></li>
<li><a href="https://mxe.cc/">https://mxe.cc/</a></li>
</ul>
<p>some ideas.....</p>
<p>build LFS using the scheme in <a href="https://github.com/LeeKyuHyuk/PiCLFS">https://github.com/LeeKyuHyuk/PiCLFS</a> but change the compiler using scheme in <a href="https://github.com/Pro/raspi-toolchain">https://github.com/Pro/raspi-toolchain</a></p>
<p>build missing libraries</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="custom-os"><a class="header" href="#custom-os">Custom O/S</a></h1>
<h2 id="concepts"><a class="header" href="#concepts">Concepts</a></h2>
<ul>
<li><a href="https://youtu.be/1rnA6wpF0o4">Write your own Operating System in 1 hour</a></li>
<li><a href="http:/wiki.osdev.org">http:/wiki.osdev.org</a></li>
<li><a href="http://www.lowlevel.eu">http://www.lowlevel.eu</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="using-raspberry-pi"><a class="header" href="#using-raspberry-pi">Using Raspberry Pi</a></h1>
<h2 id="pi-documentation"><a class="header" href="#pi-documentation">Pi Documentation</a></h2>
<ul>
<li><a href="https://www.raspberrypi.org/documentation/">https://www.raspberrypi.org/documentation/</a>.</li>
<li><a href="https://www.raspberrypi.org/documentation/configuration/">https://www.raspberrypi.org/documentation/configuration/</a>.</li>
<li><a href="https://pifi.imti.co/">https://pifi.imti.co/</a>.</li>
<li><a href="https://youtu.be/qeHpXVUwI08">https://youtu.be/qeHpXVUwI08</a></li>
<li><a href="https://youtu.be/RlgLIr2gZFg">https://youtu.be/RlgLIr2gZFg</a></li>
</ul>
<h2 id="iot"><a class="header" href="#iot">IOT</a></h2>
<p>If we want to make an IOT with Pi, we will need to setup a headless pi first. We will use raspberry pi zero W since it has built-in wireless which
can be used to network for development as well as connecting the device to the internet without additional hardware.</p>
<h2 id="setup-for-development"><a class="header" href="#setup-for-development">Setup for development</a></h2>
<p>We will use a PC to do code editing and run code to test during development. We will setup the wifi to connect the pi to a network that the PC is connected to.</p>
<h3 id="setup-for-headless-wifi-and-usb-networking"><a class="header" href="#setup-for-headless-wifi-and-usb-networking">Setup for headless wifi and USB networking</a></h3>
<p>First burn the minimal boot image to SD card using the PC. After the image is prepared,<br />
take out the and reinsert the SD card in the PC to make the new filesystem visible. Now go to the root directory
of the SD.</p>
<p>First we will setup the wifi networking.
Create following two files in the disk image root directory.</p>
<ol>
<li><code>wpa_supplicant.conf</code>.</li>
<li><code>ssh</code>.</li>
</ol>
<p>The <code>wpa_supplicant.conf</code> file should contain the following content,</p>
<pre><code class="language-auto">country=US
ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1
network={
	ssid="Wifi-Network-Name"
	psk="Wifi-Network-Password"
	key_mgmt=WPA-PSK
}
</code></pre>
<p>The <code>ssh</code> file should be empty. This will enable incoming ssh connections into pi.</p>
<p>These two files will setup the config during boot and then will be deleted after boot, but we will not boot it yet.</p>
<p>Next we will setup USB networking.
Use a text editor to edit <code>config.txt</code> in the same directory.
Go to the bottom and add,</p>
<pre><code class="language-auto">dtoverlay=dwc2
</code></pre>
<p>Save the <code>config.txt</code>.</p>
<p>Now edit <code>cmdline.txt</code> file and insert after <code>rootwait</code> (the last word on the first line) add a space and then <code>modules-load=dwc2,g_ether</code>. Note that this line is a very long line.</p>
<pre><code class="language-auto">... rootwait modules-load=dwc2,g_ether ...
</code></pre>
<p>Save the <code>cmdline.txt</code></p>
<p>Insert the SD in pi. Now we can use
USB networking to ssh into pi for development. First make sure that there is
<strong>no power cable is connected to the Pi</strong>. Simply plug in the Pi USB OTG port to a PC or laptop with a cable. PC will recognize the
Pi device power it thru the cable. After the boot completed, you can ssh into <code>pi@raspberrypi.local</code> using the default password <code>raspberry</code>.</p>
<p>You can also ssh thru wifi. Detach the cable from computer.
Plug in the power cable to the power port
and turn power on. After the boot completed,
we can connect to headless pi thru ssh from the computer on the wifi network.</p>
<p>You should change the default password on this first boot to something else.</p>
<h3 id="secure-the-ssh"><a class="header" href="#secure-the-ssh">Secure the ssh</a></h3>
<p>Now that you are connected to pi via ssh,
it is best to setup key-based authentication instead of using password for ssh at this point to make it more secure.
Key pairs are two cryptographically secure keys and extremely difficult to break. One is private, and one is public. These keys are stored by default in the <code>.ssh</code> folder in your home directory on the PC. The private key will be called <code>id_rsa</code> and the associated public key will be called <code>id_rsa.pub</code>. If you don't have those files already, simply use <code>ssh-keygen</code> command to generate them.</p>
<p>We will need to copy the public key to Raspberry Pi.
Run the following commands on Pi over ssh,</p>
<pre><code class="language-bash">mkdir -p ~/.ssh
echo &gt;&gt; ~/.ssh/authorized_keys
</code></pre>
<p>Next, we will put the key in <code>~/.ssh/authorized_keys</code> using nano,</p>
<pre><code class="language-bash">nano ~/.ssh/authorized_keys
</code></pre>
<p><code>id_rsa.pub</code> is just a text file, open it on your PC and copy the entire
content and paste it in nano at the end of the <code>~/.ssh/authorized_keys</code> and save.<br />
Now log in again using ssh using another terminal. If it didn't ask for password then
we have successfully set up the keys.</p>
<p>We can safely disable password logins now,
so that all authentication is done by only the key pairs without locking us out.
On pi we will change <code>/etc/ssh/sshd_config</code>,</p>
<pre><code class="language-bash">sudo nano /etc/ssh/sshd_config
</code></pre>
<p>There are three lines that need to be changed to <code>no</code>, if they are not set that way already,</p>
<pre><code class="language-auto">ChallengeResponseAuthentication no
PasswordAuthentication no
UsePAM no
</code></pre>
<p>Save the file and either restart the ssh system with <code>sudo service ssh reload</code> or reboot. Now you should be able to do ssh
into <code>pi@raspberrypi.local</code> from the authorized PC only and you will not need to enter any password.</p>
<h3 id="create-a-samba-share"><a class="header" href="#create-a-samba-share">Create a Samba share</a></h3>
<p>We will use code editor on the PC to edit files directly on the pi. We will
install Samba to do this.
Samba is available in Raspbian’s standard software repositories. We’re going to update our repository index, make sure our operating system is fully updated, and install Samba using apt-get. In ssh terminal and type:</p>
<pre><code class="language-bash">sudo apt-get update
sudo apt-get upgrade
sudo apt-get install samba samba-common-bin
</code></pre>
<p>We’re going to create a dedicated shared directory on our Pi’s SD.</p>
<pre><code>sudo mkdir -m 1777 /home/pi/devcode
</code></pre>
<p>This command sets the sticky bit (1) to help prevent the directory from being accidentally deleted and gives read/write/execute (777) permissions on it.</p>
<p>Edit Samba’s config files to make the file share visible to the Windows PCs on the network.</p>
<pre><code>sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.orig
sudo nano /etc/samba/smb.conf
</code></pre>
<p>In our example, you’ll need to add the following entry:</p>
<pre><code>[devcode]
Comment = Pi shared folder
path = /home/pi/devcode
writeable = yes
create mask = 0750
directory mask = 0750
valid users = pi 
public = no
</code></pre>
<p>Make sure that the <code>path</code> points to a folder that has read write permission for all the<code>valid users</code>.
If you want to force a user or group when you write a file in your samba share you can use following,</p>
<pre><code>[devcode]
...
force user = user1
force group = group1
</code></pre>
<p>It is also best to comment out anything that you don't need to use such <code>printers</code> or <code>home</code> sections.</p>
<p>Before we start the server, you’ll want to set a Samba password - this is not the same as your standard default password (raspberry), but there’s no harm in reusing this if you want to, as this is a low-security, local network project.</p>
<pre><code>sudo smbpasswd -a pi
</code></pre>
<p>Then set a password as prompted.</p>
<p>Finally, let’s restart Samba:</p>
<pre><code>sudo /etc/init.d/smbd restart
</code></pre>
<p>From now on, Samba will start automatically whenever you power on your Pi. From you windows PC file explorer you can connect to <code>\\raspberrypi</code> and map <code>devcode</code>
to a drive letter. You can do rest of your development using popular <code>vscode</code> or any other editor from your PC on the newly created drive.</p>
<h2 id="vscode-for-development"><a class="header" href="#vscode-for-development">vscode for development</a></h2>
<p>It is quite easy to setup. Read <a href="https://www.hanselman.com/blog/VisualStudioCodeRemoteDevelopmentOverSSHToARaspberryPiIsButter.aspx">Visual Studio Code Remote Development over SSH to a Raspberry Pi is butter</a>. Unfortunately, pi zero does not work because the microsoft's vscode remote server is not compiled for armv6 only supports armv7. I am not sure if the source code is available for one to re-compile for armv6.</p>
<p>This kind of capability has been done for atom called atom-remote what uses rmate (remote for another editor called textmate). They do the editing ove ssh. There is also rmate extension for vscode, <a href="https://github.com/rafaelmaiolla/remote-vscode">https://github.com/rafaelmaiolla/remote-vscode</a>. More reading to do for sure.</p>
<ul>
<li><a href="https://github.com/randy3k/remote-atom">https://github.com/randy3k/remote-atom</a></li>
<li><a href="https://github.com/aurora/rmate">https://github.com/aurora/rmate</a></li>
</ul>
<h2 id="configure-iot-setup-mechanism-by-user"><a class="header" href="#configure-iot-setup-mechanism-by-user">Configure IOT setup mechanism by user</a></h2>
<p>If we build IOT device, it needs to be configured. For example the user needs to setup the wifi connection information so that it can be connected to internet.
The question is, how do we set it up with a PC or cell phone and input those
setup?</p>
<p>The basic strategy is to setup up a web page that collects the configuration data. We will need to setup a web server first to produce the interface.</p>
<p>Once done, we can scan wifi networks from pi to get all the available access points. Fot instance we can following shell command to scan and return the result.</p>
<pre><code class="language-bash">sudo iw wlan0 scan
</code></pre>
<p>We can use returned info in the configuration webpage
for the user to select a
a wifi connection and provide password.</p>
<h3 id="installing-the-web-server"><a class="header" href="#installing-the-web-server">Installing the web server</a></h3>
<p>We will be using instructions from <a href="https://mike632t.wordpress.com/2013/09/21/installing-lighttpd-with-python-cgi-support/#:~:text=Lighttpd%20is%20a%20lightweight%20web,such%20as%20the%20Raspberry%20Pi.">Installing Lighttpd with Python CGI support</a>.</p>
<p>Install <code>lighttpd</code> web server</p>
<pre><code class="language-bash">sudo apt-get install lighttpd
</code></pre>
<p>Create a directory for the content</p>
<pre><code class="language-bash">mkdir -p /home/pi/devcode/httpd/cgi-bin
cp -Rv /var/www/* /home/pi/devcode/httpd
sudo chown -R www-data /home/pi/devcode/httpd
sudo chgrp -R www-data /home/pi/devcode/httpd
find /home/pi/devcode/httpd -type d -exec sudo chmod g+ws {} \;
sudo adduser pi www-data
</code></pre>
<p>We will edit <code>/etc/lighttpd/lighttpd.conf</code> with <code>nano</code> to update server configuration.</p>
<pre><code class="language-bash">sudo nano /etc/lighttpd/lighttpd.conf
</code></pre>
<p>We will change document root in <code>/etc/lighttpd/lighttpd.conf</code>,</p>
<pre><code class="language-auto">server.document-root        = "/home/pi/devcode/httpd/public"
</code></pre>
<p>We will Append following to the end of <code>/etc/lighttpd/lighttpd.conf</code> to enable cgi,</p>
<pre><code class="language-auto">server.modules += ( "mod_cgi", "mod_setenv" )
static-file.exclude-extensions += ( ".py", ".sh", )
$HTTP["url"] =~ "^/cgi-bin/" {
        alias.url = ( "/cgi-bin/" =&gt; "/home/pi/devcode/httpd/cgi-bin/" )
        cgi.assign = (
                ".py" =&gt; "/usr/bin/python3",
                ".pl"  =&gt; "/usr/bin/perl",
                ".sh"  =&gt; "/bin/sh",
        )
        setenv.set-environment = ( "PYTHONPATH" =&gt; "/home/pi/devcode/httpd/lib" )
}

server.modules += ("mod_rewrite")
url.rewrite-once = ( "^/json-api/(.*)\.json" =&gt; "/cgi-bin/$1.py" )
</code></pre>
<p>This example also will setup search path for any python custom module and any url rewrite you may need.</p>
<p>Restart the server</p>
<pre><code class="language-bash">sudo service lighttpd restart
</code></pre>
<p>Now we can put static contents in <code>httpd/html</code> directory and all the handlers
in <code>httpd/cgi-bin</code> directory. Go ahead, test the server from a web browser with some static content and cgi.</p>
<h2 id="custom-fastcgi-for-lighttpd"><a class="header" href="#custom-fastcgi-for-lighttpd">custom fastcgi for lighttpd</a></h2>
<ul>
<li><a href="https://github.com/jerryvig/lighttpd-fastcgi-c">https://github.com/jerryvig/lighttpd-fastcgi-c</a></li>
<li><a href="https://docs.rs/fastcgi/1.0.0/fastcgi/">https://docs.rs/fastcgi/1.0.0/fastcgi/</a></li>
<li><a href="https://dafyddcrosby.com/rust-dreamhost-fastcgi/">https://dafyddcrosby.com/rust-dreamhost-fastcgi/</a></li>
</ul>
<h3 id="using-privileged-commands-in-cgi"><a class="header" href="#using-privileged-commands-in-cgi">Using privileged commands in CGI</a></h3>
<p>The web server cgi scripts may need to run commands with root permission. This can be allowed by
updating sudo permission for the server for specific commands. For instance, we can scan the wifi networks using <code>/sbin/iw</code> command
running with root permission. You can edit the permission by running,</p>
<pre><code class="language-bash">sudo visudo
</code></pre>
<p>This will bring up <code>nano</code> with the permission file. Add following line at the end of file,</p>
<pre><code class="language-auto">%www-data  ALL=NOPASSWD: /sbin/iw
</code></pre>
<p>Now save the file. You can add more than one commands in comma separated paths if needed. Check documentation for <code>visudo</code>.</p>
<h3 id="idea-1-configure-via-wifi"><a class="header" href="#idea-1-configure-via-wifi"><a name="idea1"></a>Idea 1: Configure via wifi</a></h3>
<p>Set it up initially as a wifi access point on power up.
Then use it to setup up the configuration.</p>
<p>Perhaps We can run both ap and client at the same time? Or a reset switch to select the mode. Or we can use some other algorithmic way turn on the access point. We can use captive portal to show the user interface.</p>
<ul>
<li><a href="https://www.raspberrypi.org/forums/viewtopic.php?t=211542">https://www.raspberrypi.org/forums/viewtopic.php?t=211542</a>.</li>
<li><a href="https://serverfault.com/questions/869857/systemd-how-to-selectively-disable-wpa-supplicant-for-a-specific-wlan-interface">https://serverfault.com/questions/869857/systemd-how-to-selectively-disable-wpa-supplicant-for-a-specific-wlan-interface</a>.</li>
<li><a href="https://pifi.imti.co/">https://pifi.imti.co/</a>.</li>
<li><a href="https://en.wikipedia.org/wiki/Captive_portal">https://en.wikipedia.org/wiki/Captive_portal</a>.</li>
</ul>
<p>Check an <a href="topics/raspberrypi.html#idea1-impl">implementation</a>. I haven't tested this yet.</p>
<h3 id="idea-2-configure-via-bluetooth"><a class="header" href="#idea-2-configure-via-bluetooth">Idea 2: Configure via bluetooth</a></h3>
<p>make pi a bluetooth device, connect your phone to it with an app the should display user interface and send the info to the device to get it configured.</p>
<blockquote>
<p>is it possible that device will send a html page while the bt connections act as network connection? probably not a whole lot different from idea 1 if we do that.</p>
</blockquote>
<p>I haven't tested this idea yet.</p>
<ul>
<li><a href="https://hacks.mozilla.org/2017/02/headless-raspberry-pi-configuration-over-bluetooth/">https://hacks.mozilla.org/2017/02/headless-raspberry-pi-configuration-over-bluetooth/</a></li>
<li><a href="https://youtu.be/sEmjcgbmoRM">https://youtu.be/sEmjcgbmoRM</a></li>
</ul>
<h3 id="idea-3-configure-via-usb"><a class="header" href="#idea-3-configure-via-usb">Idea 3: Configure via USB</a></h3>
<p>Connect the device with a usb cable to a computer of phone, again the same concept a user interface shows up to configure.</p>
<ul>
<li><a href="https://desertbot.io/blog/headless-pi-zero-ssh-access-over-usb-windows">HEADLESS PI ZERO SSH ACCESS OVER USB (WINDOWS)</a>.</li>
<li><a href="https://github.com/raspberrypi/firmware/blob/master/boot/overlays/README">Raspberry pi boot overlays</a>.</li>
<li><a href="https://learn.adafruit.com/turning-your-raspberry-pi-zero-into-a-usb-gadget">Go Go Gadget Pi Zero</a>.</li>
<li><a href="https://www.circuitbasics.com/raspberry-pi-zero-ethernet-gadget/#:~:text=The%20Raspberry%20Pi%20Zero&#x27;s%20small,is%20shared%20over%20USB%20too.">RASPBERRY PI ZERO USB/ETHERNET GADGET TUTORIAL</a>.</li>
</ul>
<p>Note that, phone has a usb otg connector, and so is pi zero. Both will be in gadget mode. To connect to a phone we will need a special cable which is not desired but possible.</p>
<p>However, let's explore the idea of Pi as a device connected to PC or laptop host.
Pi has usb otg, means that it can be either a host or it can be a device.
We can connect them with a cable and setup Pi as a Ethernet gadget. Then the configuration webpage will be visible from PC browser. This seems to
be most straight forward way since our Pi is already setup for
USB networking.</p>
<p>Make sure that the <strong>power cable is removed from the Pi</strong>. Simply plug in the Pi USB OTG port to a PC or laptop. PC will power and recognize the
Pi device. At this point you can open a browser and browse to
<code>http://raspberrypi.local</code> and the web page will be displayed.</p>
<p>However there is one problem in this case,</p>
<ul>
<li><a href="https://learn.adafruit.com/turning-your-raspberry-pi-zero-into-a-usb-gadget/ethernet-gadget">https://learn.adafruit.com/turning-your-raspberry-pi-zero-into-a-usb-gadget/ethernet-gadget</a></li>
</ul>
<p>My desktop works fine but my laptop is treating pi as a com port as this article mentioned.
I am manually trying to install ndis driver on my windows 10, but microsoft site was no help.
Apparently a certificate is needed for the inf file they suggested. Gota research more to find
where that certificate for their inf file is located.</p>
<p>Meanwhile this post, <a href="https://forum.moddevices.com/t/rndis-driver-for-windows-10/299/7">https://forum.moddevices.com/t/rndis-driver-for-windows-10/299/7</a>
suggested a way to install a <code>rndis</code> driver from moddevice.</p>
<p>The full documentation is here, read carefully before you install the driver,</p>
<ul>
<li><a href="https://wiki.moddevices.com/wiki/Troubleshooting_Windows_Connection">https://wiki.moddevices.com/wiki/Troubleshooting_Windows_Connection</a></li>
</ul>
<p>I downloaded the zip file,
<a href="https://modclouddownloadprod.blob.core.windows.net/shared/mod-duo-rndis.zip"><code>mod-duo-rndis.zip</code></a>,
from microsoft.net site, installed it and it worked.</p>
<blockquote>
<p>I backed up the zip file <a href="topics/../files/mod-duo-rndis.zip">here</a>, just in case the above link ever stops working.</p>
</blockquote>
<h2 id="raspberry-pi-as-access-point-and-wifi-client"><a class="header" href="#raspberry-pi-as-access-point-and-wifi-client"><a name="idea1-impl"></a>Raspberry pi as Access Point and Wifi client</a></h2>
<p>This is an example of how the <a href="topics/raspberrypi.html#idea1"><em>idea 1</em></a> can be implemented. This was collected from the tutorials found on internet <a href="https://www.raspberrypi.org/forums/viewtopic.php?t=211542">https://www.raspberrypi.org/forums/viewtopic.php?t=211542</a>.</p>
<blockquote>
<p>It is based on IOT wifi's <a href="https://pifi.imti.co/">solution</a>, but I wanted to use a language other than Go to manage my wifi connections, so all changes are within the standard Raspbian Stretch OS.</p>
</blockquote>
<p>These steps are (as best as I can remember) in the order that I did them in:</p>
<h3 id="1-update-system"><a class="header" href="#1-update-system">1. Update system</a></h3>
<p>Run apt-get update and upgrade to make sure you have the latest and greatest.</p>
<pre><code>sudo apt-get update
sudo apt-get upgrade
</code></pre>
<p>This may take a while depending on connection speed.</p>
<h3 id="2-install-hostapd-and-dnsmasq"><a class="header" href="#2-install-hostapd-and-dnsmasq">2. Install hostapd and dnsmasq</a></h3>
<p>Install the hostapd access point daemon and the dnsmasq dhcp service.</p>
<pre><code class="language-bash">sudo apt-get install hostapd dnsmasq
</code></pre>
<h3 id="3-edit-configuration-files"><a class="header" href="#3-edit-configuration-files">3. Edit configuration files</a></h3>
<p>Here we need to edit the config files for dhcpcd, hostapd, and dnsmasq so that they all play nice together. We <strong>do NOT</strong>, as in past implementations, make any edits to the <code>/etc/network/interfaces</code> file. If you do it can cause problems, check tutorial notes <a href="https://raspberrypi.stackexchange.com/questions/37920/how-do-i-set-up-networking-wifi-static-ip-address/37921#37921">here</a>.</p>
<p>Edit <code>/etc/dhcpcd.conf</code></p>
<pre><code>interface uap0
	static ip_address=192.168.50.1/24
    nohook wpa_supplicant
</code></pre>
<p>This sets up a static IP address on the uap0 interface that we will set up in the startup script. The nohook line prevents the 10-wpa-supplicant hook from running wpa-supplicant on this interface.</p>
<p>Replace <code>/etc/dnsmasq.conf</code>
Move the dnsmasq original file to save a copy of the quite useful example, you may even want to use some of the RPi-specific lines at the end. I did not test my solution with those.</p>
<pre><code>sudo mv /etc/dnsmasq.conf /etc/dnsmasq.conf.orig
</code></pre>
<p>Create a new <code>/etc/dnsmasq.conf</code> and add the following to it:</p>
<pre><code>interface=lo,uap0    # Use interfaces lo and uap0
bind-interfaces      # Bind to the interfaces
server=8.8.8.8       # Forward DNS requests to Google DNS
domain-needed        # Don't forward short names
bogus-priv           # Never forward addresses in the non-routed address spaces

# Assign IP addresses between 192.168.70.50 and 192.168.70.150
# with a 12-hour lease time
dhcp-range=192.168.70.50,192.168.70.150,12h

# The above address range is totally arbitrary; use your own.
</code></pre>
<p>Create file <code>/etc/hostapd/hostapd.conf</code> and add the following:
(Feel free to delete the commented out lines)</p>
<pre><code># Set the channel (frequency) of the host access point
channel=1

# Set the SSID broadcast by your access point (replace with your own, of course)
ssid=IOT-Config

# This sets the passphrase for your access point (again, use your own)
wpa_passphrase=passwordBetween8and64charactersLong

# This is the name of the WiFi interface we configured above
interface=uap0

# Use the 2.4GHz band
# (untested: ag mode to get 5GHz band)
hw_mode=g

# Accept all MAC addresses
macaddr_acl=0

# Use WPA authentication
auth_algs=1

# Require clients to know the network name
ignore_broadcast_ssid=0

# Use WPA2
wpa=2

# Use a pre-shared key
wpa_key_mgmt=WPA-PSK
wpa_pairwise=TKIP
rsn_pairwise=CCMP
driver=nl80211

# I commented out the lines below in my implementation, but I kept them here for reference.

# Enable WMM
#wmm_enabled=1

# Enable 40MHz channels with 20ns guard interval
#ht_capab=[HT40][SHORT-GI-20][DSSS_CCK-40]
</code></pre>
<blockquote>
<p>Note: The channel written here MUST match the channel of the wifi that you connect to in client mode (via wpa-supplicant). If the channels for your AP and STA mode services do not match, then one or both of them will not run. This is because there is only one physical antenna. It cannot cover two channels at once.</p>
</blockquote>
<p>Edit file <code>/etc/default/hostapd</code> and uncomment <code>DAEMON_CONF</code> line. Add the following,</p>
<pre><code>DAEMON_CONF="/etc/hostapd/hostapd.conf"
</code></pre>
<h3 id="4-create-startup-script"><a class="header" href="#4-create-startup-script">4. Create startup script</a></h3>
<p>Add a new file <code>/usr/local/bin/wifistart</code> (or whatever name you like best), and add the following to it:</p>
<pre><code>#!/bin/bash

# Redundant stops to make sure services are not running
echo "Stopping network services (if running)..."
systemctl stop hostapd.service
systemctl stop dnsmasq.service
systemctl stop dhcpcd.service

# Make sure no uap0 interface exists (this generates an error; we could probably use an if statement to check if it exists first)
echo "Removing uap0 interface..."
iw dev uap0 del

# Add uap0 interface (this is dependent on the wireless interface being called wlan0, which it may not be in Stretch)
echo "Adding uap0 interface..."
iw dev wlan0 interface add uap0 type __ap

# Modify iptables (these can probably be saved using iptables-persistent if desired)
echo "IPV4 forwarding: setting..."
sysctl net.ipv4.ip_forward=1
echo "Editing IP tables..."
iptables -t nat -A POSTROUTING -s 192.168.70.0/24 ! -d 192.168.70.0/24 -j MASQUERADE

# Bring up uap0 interface. Commented out line may be a possible alternative to using dhcpcd.conf to set up the IP address.
#ifconfig uap0 192.168.70.1 netmask 255.255.255.0 broadcast 192.168.70.255
ifconfig uap0 up

# Start hostapd. 10-second sleep avoids some race condition, apparently. It may not need to be that long. (?) 
echo "Starting hostapd service..."
systemctl start hostapd.service
sleep 10

# Start dhcpcd. Again, a 5-second sleep
echo "Starting dhcpcd service..."
systemctl start dhcpcd.service
sleep 5

echo "Starting dnsmasq service..."
systemctl start dnsmasq.service
echo "wifistart DONE"
</code></pre>
<p>There are other and better ways of automating this startup process, which I adapted from IOT wifi's code <a href="https://github.com/cjimti/iotwifi">here</a>. This demonstrates the basic functionality in a simple script.</p>
<h3 id="5-edit-rclocal-system-script"><a class="header" href="#5-edit-rclocal-system-script">5. Edit rc.local system script</a></h3>
<p>There are other ways of doing this, including creating a daemon that can be used by systemctl, which I would recommend doing if you want something that will restart if it fails. Adafruit has a simple write-up on that <a href="https://learn.adafruit.com/running-programs-automatically-on-your-tiny-computer/systemd-writing-and-enabling-a-service">here</a>. I used <code>rc.local</code> for simplicity here.</p>
<p>Add the following to your <code>/etc/rc.local</code> script above the exit 0 line. Note the spacing between <code>/bin/bash</code> and <code>/usr/local/bin/wifistart</code>.</p>
<pre><code>/bin/bash /usr/local/bin/wifistart
</code></pre>
<h3 id="6-disable-regular-network-services"><a class="header" href="#6-disable-regular-network-services">6. Disable regular network services</a></h3>
<p>The wifistart script handles starting up network services in a certain order and time frame. Disabling them here makes sure things are not run at system startup.</p>
<pre><code>sudo systemctl stop hostapd
sudo systemctl stop dnsmasq
sudo systemctl stop dhcpcd
sudo systemctl disable hostapd
sudo systemctl disable dnsmasq
sudo systemctl disable dhcpcd
</code></pre>
<h3 id="7-reboot"><a class="header" href="#7-reboot">7. Reboot</a></h3>
<pre><code>sudo reboot
</code></pre>
<p>If you want to test the code directly and view the output, just run</p>
<pre><code>sudo /usr/local/bin/wifistart
</code></pre>
<p>from the terminal after commenting out the <code>wifistart</code> script line in <code>rc.local</code>.</p>
<h2 id="preparing-for-distribution"><a class="header" href="#preparing-for-distribution">Preparing for distribution.</a></h2>
<p>Back up the sdio image from dev SD card first.</p>
<p>Now we have to make sure the image has disabled ssh, and samba and any other services not needed on the deployed device by running some kind of shell script.
Now the SD contains the production image and ready for distribution.</p>
<pre><code class="language-bash"># list installed services
ls -la /etc/rc2.d/
# disable
sudo update-rc.d ssh disable
# enable
sudo update-rc.d ssh enable
</code></pre>
<p>Save the sdio image from dev SD card. This will be the boot image to be downloaded.</p>
<p>Alternatively, we can use a <a href="topics/embedded#raspberry-pi">image build</a> strategy to an optimized image with only necessary components, which will reduce image size.</p>
<p>If the image is too large, we can put minimal code on the SD, something similar to <code>noobs</code> (New Out of Box Software), the boot image should be downloaded and prepared after initial boot by the user during configuration.
For application where production SD image is small, there will be no benefit using <strong>NOOBS</strong> strategy.</p>
<ul>
<li>Imaging sdio source code <a href="https://github.com/raspberrypi/rpi-imager">https://github.com/raspberrypi/rpi-imager</a></li>
<li><a href="https://github.com/raspberrypi/noobs">https://github.com/raspberrypi/noobs</a></li>
</ul>
<blockquote>
<p>todo: check how to use docker container in pi</p>
</blockquote>
<h2 id="wifi-related-links"><a class="header" href="#wifi-related-links">Wifi related links</a></h2>
<ul>
<li><a href="http://w1.fi/wpa_supplicant/devel/">wpa_supplicant developers doc</a></li>
<li><a href="https://www.raspberrypi.org/forums/viewtopic.php?t=179387">Changing Wifi networks</a></li>
<li><a href="https://www.raspberrypi.org/documentation/configuration/wireless/wireless-cli.md">Setting up a wifi</a></li>
<li><a href="https://www.raspberrypi.org/forums/viewtopic.php?t=160620">Switching between known Wifi networks</a></li>
<li><a href="https://raspberrypi.stackexchange.com/questions/41020/how-do-i-use-the-command-line-to-check-which-wifi-network-i-am-connected-to">Which WiFi network I am connected to?</a></li>
<li><a href="https://www.tecmint.com/set-system-locales-in-linux/">https://www.tecmint.com/set-system-locales-in-linux/</a></li>
<li><a href="https://www.debian.org/doc/manuals/debian-reference/ch08.en.html">https://www.debian.org/doc/manuals/debian-reference/ch08.en.html</a></li>
</ul>
<h2 id="some-random-setup-stuff"><a class="header" href="#some-random-setup-stuff">Some random setup stuff</a></h2>
<ul>
<li><code>timedatectl list-timezones</code> provides list of all timezones</li>
<li><a href="https://github.com/eggert/tz">https://github.com/eggert/tz</a> all timezones</li>
<li>raspi-config <a href="https://github.com/RPi-Distro/raspi-config">https://github.com/RPi-Distro/raspi-config</a></li>
<li>list of 2 letter country codes <a href="https://www.iso.org/obp/ui/#search">https://www.iso.org/obp/ui/#search</a></li>
<li>list of flags <a href="https://github.com/lipis/flag-icon-css">https://github.com/lipis/flag-icon-css</a></li>
<li>language codes <a href="https://www.loc.gov/standards/iso639-2/php/code_list.php">https://www.loc.gov/standards/iso639-2/php/code_list.php</a></li>
<li>select from a list <a href="https://svelte.dev/tutorial/select-bindings">https://svelte.dev/tutorial/select-bindings</a></li>
</ul>
<h2 id="samba-wins-doesnt-make-is-discoverable-in-windows-10"><a class="header" href="#samba-wins-doesnt-make-is-discoverable-in-windows-10">Samba WINS doesnt make is discoverable in windows 10</a></h2>
<p>WSD is missing from samba. samba only supports netbios. This WSD server written in python will, make the device discoverable.</p>
<ul>
<li><a href="https://github.com/christgau/wsdd">https://github.com/christgau/wsdd</a></li>
</ul>
<h2 id="daemon-with-shell-script"><a class="header" href="#daemon-with-shell-script">Daemon with shell script</a></h2>
<ul>
<li>Making service daemon with shell script <a href="http://manpages.ubuntu.com/manpages/focal/en/man8/start-stop-daemon.8.html">http://manpages.ubuntu.com/manpages/focal/en/man8/start-stop-daemon.8.html</a></li>
<li>A shell Daemon <a href="https://gist.github.com/shawnrice/11076762">template</a>. This seems to have recusrion, we need to fix it if want to use it.</li>
<li><a href="https://bash.cyberciti.biz/guide/Daemons">Daemons</a>.</li>
<li><a href="https://gist.github.com/alobato/1968852">Using start-stop-daemon</a></li>
</ul>
<h2 id="debugging-python-cgi-scripts"><a class="header" href="#debugging-python-cgi-scripts">Debugging python cgi scripts</a></h2>
<p>Following will send the error message and traceback to the browser for debugging</p>
<pre><code class="language-auto">import sys
import traceback
print ("Content-Type: text/html")
print
sys.stderr = sys.stdout
try:
    ...your code here...
except:
    print ("\n\n&lt;PRE&gt;")
    traceback.print_exc()
</code></pre>
<blockquote>
<p>Remove the code after debugging is complete. Otherwise it may expose information
leading into security risk for your application. <code>post</code> requests can not be redirected,
browser turns it into a <code>get</code> request and then the request fails.</p>
</blockquote>
<h2 id="using-cython"><a class="header" href="#using-cython">Using cython</a></h2>
<p>install cython first.</p>
<pre><code class="language-bash">sudo apt-get update

# for python2
sudo apt-get install python-dev --fix-missing 
sudo apt-get install python-pip
sudo apt-get install python-distutils
sudo pip install cython

# for python3
sudo apt-get install python3-dev --fix-missing 
sudo apt-get install python3-pip
sudo apt-get install python3-distutils
sudo pip3 install cython
</code></pre>
<p>cython is really designed building modules to be used within python for speed up,
packaging as standalone executable
is tedious because of the dependency chain as all the dependencies
have to be manually compiled.</p>
<h3 id="simple-way-lets-say-our-python-version-is-37m"><a class="header" href="#simple-way-lets-say-our-python-version-is-37m">Simple way, lets say our python version is 3.7m</a></h3>
<p>compile <code>test.pyx</code> to executable</p>
<pre><code class="language-bash">cython --embed -3 test.pyx
gcc -c test.c `python3-config --cflags`
gcc -o test test.o `python3-config -ldflags`
</code></pre>
<p>check <a href="https://github.com/cython/cython/tree/master/Demos/embed">https://github.com/cython/cython/tree/master/Demos/embed</a></p>
<p>gcc to create binary python module that can be imported</p>
<pre><code class="language-bash">cython -3 test.pyx
gcc -pthread -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong \
    -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -fPIC \
    -I/usr/include/python3.7m -c test.c -o test.o
gcc -pthread -shared -Wl,-O1 -Wl,-Bsymbolic-functions -Wl,-z,relro -Wl,-z,relro -g \
    -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 \
	test.o -o test.so
</code></pre>
<p>gcc options to create executable in one step picking up include options from <code>pkg-config</code></p>
<pre><code class="language-bash">cython --embed -3 test.pyx
gcc -v -Os -lpthread -lm -lutil -ldl -lpython3.7m \
	`pkg-config --cflags python-3.7m` \
	-o test test.c  
</code></pre>
<h3 id="using-distutils-buld-system"><a class="header" href="#using-distutils-buld-system">Using distutils buld system</a></h3>
<p>This creates a <code>.so</code> library, a binaty python module</p>
<pre><code>import distutils.core
import Cython.Build
distutils.core.setup(
    ext_modules = Cython.Build.cythonize("test.pyx"))
</code></pre>
<blockquote>
<p>todo: I have yet to figure out how I can generate executablie using cython build api.</p>
</blockquote>
<ul>
<li><a href="https://blog.paperspace.com/boosting-python-scripts-cython/">Boosting Python Scripts With Cython</a></li>
<li><a href="http://masnun.rocks/2016/10/01/creating-an-executable-file-using-cython/">Creating an executable file using Cython</a></li>
<li><a href="https://stackoverflow.com/questions/22507592/making-an-executable-in-cython">Making an executable in Cython</a></li>
<li><a href="https://medium.com/@xpl/protecting-python-sources-using-cython-dcd940bb188e">Protecting Python Sources With Cython</a></li>
<li><a href="http://okigiveup.net/an-introduction-to-cython/">http://okigiveup.net/an-introduction-to-cython/</a></li>
<li><a href="https://tryexceptpass.org/article/package-python-as-executable/">https://tryexceptpass.org/article/package-python-as-executable/</a></li>
</ul>
<h2 id="setting-time-zone-from-terminal"><a class="header" href="#setting-time-zone-from-terminal">setting time zone from terminal</a></h2>
<pre><code class="language-auto">sudo timedatectl set-timezone Europe/Brussels
</code></pre>
<h2 id="setup-ssl-using-lets-encrypt"><a class="header" href="#setup-ssl-using-lets-encrypt">setup SSL using lets encrypt</a></h2>
<ul>
<li><a href="https://pimylifeup.com/raspberry-pi-ssl-lets-encrypt/">https://pimylifeup.com/raspberry-pi-ssl-lets-encrypt/</a></li>
</ul>
<h2 id="using-rust"><a class="header" href="#using-rust">Using Rust</a></h2>
<p>See <a href="topics/rust#using-rust-in-raspberry-pi">Using rust in Raspberry pi</a>.</p>
<h2 id="fastcgi"><a class="header" href="#fastcgi">fastcgi</a></h2>
<p>todo</p>
<h2 id="wpa_cli-in-daemon-mode"><a class="header" href="#wpa_cli-in-daemon-mode">wpa_cli in daemon mode</a></h2>
<ul>
<li><a href="https://unix.stackexchange.com/questions/511444/wpa-action-script-how-to-run-wpa-cli-in-daemon-mode">https://unix.stackexchange.com/questions/511444/wpa-action-script-how-to-run-wpa-cli-in-daemon-mode</a></li>
</ul>
<h2 id="setup-raspberry-pi-with-live-reload"><a class="header" href="#setup-raspberry-pi-with-live-reload">setup raspberry pi with live reload</a></h2>
<ul>
<li><a href="https://github.com/kkibria/pi-live-reload">pi-live-reload</a></li>
</ul>
<h2 id="back-up-pi"><a class="header" href="#back-up-pi">back up pi</a></h2>
<ul>
<li><a href="https://www.raspberrypi.org/forums/viewtopic.php?t=230618">Backup and recovery solution I use (recovery image)</a></li>
<li><a href="https://github.com/lzkelley/bkup_rpimage">Script to backup a Raspberry Pi disk image</a></li>
<li><a href="https://github.com/ephestione/bazidrop">Encrypted backup of linux (Raspbian) configuration data and Dropbox upload</a></li>
</ul>
<h2 id="c-library-for-controlling-gpio"><a class="header" href="#c-library-for-controlling-gpio">C library for controlling GPIO</a></h2>
<ul>
<li><a href="http://wiringpi.com/download-and-install/">Wiring Pi</a></li>
</ul>
<p>To update or install on a Raspbian-Lite system:</p>
<pre><code class="language-bash">sudo apt-get install wiringpi
</code></pre>
<p>the author has stopped developing. the code is available in github,</p>
<ul>
<li><a href="https://github.com/WiringPi/WiringPi">https://github.com/WiringPi/WiringPi</a></li>
</ul>
<p>an example of how to use the library</p>
<ul>
<li><a href="https://medium.com/@simon_prickett/gpio-access-in-c-with-raspberry-pi-traffic-lights-6b982e197d45">https://medium.com/@simon_prickett/gpio-access-in-c-with-raspberry-pi-traffic-lights-6b982e197d45</a></li>
</ul>
<p>A great resource</p>
<ul>
<li><a href="https://elinux.org/RPi_GPIO_Code_Samples">https://elinux.org/RPi_GPIO_Code_Samples</a></li>
</ul>
<h2 id="rust-gpio-for-pi-1"><a class="header" href="#rust-gpio-for-pi-1">rust GPIO for pi</a></h2>
<ul>
<li>???</li>
<li>May be a kernel module with rust?? Some <a href="topics/rust#Linux-kernel-module-with-rust">work</a> is ongoing.</li>
<li><a href="https://github.com/golemparts/rppal">RPPAL</a>.</li>
<li><a href="https://github.com/rust-embedded/rust-sysfs-gpio">https://github.com/rust-embedded/rust-sysfs-gpio</a>.</li>
</ul>
<p>Most promising seems to be <a href="https://github.com/golemparts/rppal">RPPAL</a> option.</p>
<blockquote>
<p>I will try this option and do the write up on this.</p>
</blockquote>
<h2 id="python-gpio"><a class="header" href="#python-gpio">python GPIO</a></h2>
<ul>
<li><a href="https://gpiozero.readthedocs.io/en/stable/index.html">https://gpiozero.readthedocs.io/en/stable/index.html</a></li>
</ul>
<h2 id="rpikernelhack"><a class="header" href="#rpikernelhack">rpikernelhack</a></h2>
<ul>
<li><a href="https://www.thegeekpub.com/235652/what-is-rpikernelhack/">https://www.thegeekpub.com/235652/what-is-rpikernelhack/</a></li>
</ul>
<h2 id="apt-get"><a class="header" href="#apt-get">apt-get</a></h2>
<ul>
<li><a href="https://raspberrypi.stackexchange.com/questions/93604/raspberry-pi-sudo-apt-get-update-not-working">Raspberry Pi sudo apt-get update not working</a></li>
</ul>
<h2 id="armv6-toolchain"><a class="header" href="#armv6-toolchain">armv6 toolchain</a></h2>
<ul>
<li><a href="https://github.com/Pro/raspi-toolchain">https://github.com/Pro/raspi-toolchain</a></li>
</ul>
<h2 id="booting-raspbian"><a class="header" href="#booting-raspbian">Booting Raspbian</a></h2>
<ol>
<li>GPU ROM firmware boots reads first FAT partition.</li>
<li><code>start.elf</code> from FAT partition is the bootlader which is loaded and executed by GPU.</li>
<li>Bootlader loads <code>config.txt</code> from the FAT partition to memory.</li>
<li>In <code>config.txt</code> file, <code>kernel</code> setting provides the kernel and
<code>command line</code> provides command line script.</li>
<li>Bootloader loads kernel and command line to arm memory.</li>
<li>Bootloader passes control to kernel.</li>
<li>kernle mounts ext4 partition from Command line setting <code>root=PARTUUID=6c586e13-02</code> using the UUID.</li>
<li>Finally, the kernel looks for a file called <code>/init</code> specified
in command line and executes it.</li>
</ol>
<blockquote>
<p>todo: got this from an <a href="https://pixelspark.nl/2019/making-your-own-linux-distribution-for-the-raspberry-pi-for-fun-and-profit-part-2">article</a>, need to verify.</p>
</blockquote>
<h1 id="go-lang-for-pi-0"><a class="header" href="#go-lang-for-pi-0">go lang for pi 0</a></h1>
<ul>
<li><a href="https://github.com/mark2b/wpa-connect">WPA supplicant over D-Bus using go for raspberry pi</a>.</li>
<li><a href="https://golang.org/doc/tutorial/getting-started">https://golang.org/doc/tutorial/getting-started</a></li>
</ul>
<p>use go build with following to compile for pi</p>
<pre><code>env GOOS=linux GOARCH=arm GOARM=5 go build
</code></pre>
<p>I tried with GOARM=6 and it worked too.</p>
<h2 id="some-other-stuff"><a class="header" href="#some-other-stuff">Some other stuff</a></h2>
<ul>
<li>Pair a Raspberry Pi and Android phone <a href="https://bluedot.readthedocs.io/en/latest/pairpiandroid.html">https://bluedot.readthedocs.io/en/latest/pairpiandroid.html</a></li>
</ul>
<blockquote>
<p>todo: Will this work for pi zero w?</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cross-compiling-for-pi"><a class="header" href="#cross-compiling-for-pi">Cross Compiling for Pi</a></h1>
<h2 id="cross-compile-1"><a class="header" href="#cross-compile-1">cross compile</a></h2>
<ul>
<li><a href="https://youtu.be/Pbt330zuNPc">Anatomy of Cross-Compilation Toolchains</a>. The <a href="https://elinux.org/images/1/15/Anatomy_of_Cross-Compilation_Toolchains.pdf">slides</a>.</li>
</ul>
<h2 id="go-lang-for-pi-0-1"><a class="header" href="#go-lang-for-pi-0-1">go lang for pi 0</a></h2>
<ul>
<li><a href="https://www.thepolyglotdeveloper.com/2017/04/cross-compiling-golang-applications-raspberry-pi/">Cross Compiling Golang Applications For Use On A Raspberry Pi</a>.
You tube <a href="https://youtu.be/lDvlysiMbCs">video</a>.</li>
</ul>
<h2 id="using-rust-in-raspberry-pi-1"><a class="header" href="#using-rust-in-raspberry-pi-1">Using rust in Raspberry pi</a></h2>
<ul>
<li><a href="topics/pirust.html#setup-wsl2-for-cross-compile">Cross Compile with WSL2 for the Raspberry Pi</a>.</li>
<li><a href="https://chacin.dev/blog/cross-compiling-rust-for-the-raspberry-pi/">Cross Compiling Rust for the Raspberry Pi</a>.</li>
<li><a href="https://gnutoolchains.com/raspberry/">Prebuilt Windows Toolchain for Raspberry Pi</a>. Question: who are these people? where are the sources fro these tools?</li>
<li><a href="https://medium.com/@wizofe/cross-compiling-rust-for-arm-e-g-raspberry-pi-using-any-os-11711ebfc52b">Cross compiling Rust for ARM (e.g. Raspberry Pi) using any OS!</a></li>
<li><a href="https://github.com/rust-embedded/cross">“Zero setup” cross compilation and “cross testing” of Rust crates</a></li>
<li><a href="https://www.vagrantup.com/">Vagrant, Virtual machine for cross development</a>. I really like this setup, easy to use. Plays well with virtualbox.</li>
<li><a href="https://github.com/kunerd/clerk/wiki/How-to-use-HD44780-LCD-from-Rust#setting-up-the-cross-toolchain">https://github.com/kunerd/clerk/wiki/How-to-use-HD44780-LCD-from-Rust#setting-up-the-cross-toolchain</a></li>
<li><a href="https://opensource.com/article/19/3/physical-computing-rust-raspberry-pi">https://opensource.com/article/19/3/physical-computing-rust-raspberry-pi</a></li>
<li><a href="https://github.com/japaric/rust-cross">https://github.com/japaric/rust-cross</a></li>
<li><a href="https://gist.github.com/sol-prog/94b2ba84559975c76111afe6a0499814">RPi-GCC-cross-compiler</a></li>
</ul>
<h3 id="qemu-for-library-dependencies-1"><a class="header" href="#qemu-for-library-dependencies-1">QEMU for library dependencies</a></h3>
<ul>
<li><a href="http://linux-sunxi.org/Debootstrap">Debootstrap</a></li>
<li><a href="http://logan.tw/posts/2017/01/21/introduction-to-qemu-debootstrap/">Introduction to qemu-debootstrap</a>.</li>
<li><a href="https://headmelted.com/using-qemu-to-produce-debian-filesystems-for-multiple-architectures-280df41d28eb">https://headmelted.com/using-qemu-to-produce-debian-filesystems-for-multiple-architectures-280df41d28eb</a>.</li>
<li><a href="https://youtu.be/PBY9l97-lto">Kernel Recipes 2015 - Speed up your kernel development cycle with QEMU - Stefan Hajnoczi</a>.</li>
<li><a href="https://youtu.be/L_r3z3402do">Debootstrap #1 Creating a Filesystem for Debian install Linux tutorial</a>.</li>
<li><a href="https://youtu.be/OLFH4Ov6bJQ">Creating Ubuntu and Debian container base images, the old and simple way</a>.</li>
<li><a href="https://youtu.be/xiQX0YXYuqU">Raspberry Pi Emulator for Windows 10 Full Setup Tutorial and Speed Optimization</a>.</li>
<li><a href="https://azeria-labs.com/emulate-raspberry-pi-with-qemu/">RASPBERRY PI ON QEMU</a>.</li>
<li><a href="https://stackoverflow.com/questions/60127086/run-raspberry-pi-zero-w-image-in-qemu">Run Raspberry Pi Zero W image in qemu</a>, github <a href="https://github.com/igwtech/qemu">source</a>.</li>
<li><a href="https://www.reddit.com/r/VFIO/comments/9pi2cd/how_to_set_up_qemu_30_on_ubuntu_1804/">How to set up QEMU 3.0 on Ubuntu 18.04</a>.</li>
</ul>
<h2 id="building-qemu-from-raspberri-pi-zero-in-wsl2-ubuntu"><a class="header" href="#building-qemu-from-raspberri-pi-zero-in-wsl2-ubuntu">building qemu from raspberri pi zero in wsl2 ubuntu</a></h2>
<p>It is best if you make a directory somewhere in windows for the sources. Using powershell to keep wsl2 VHD files small,</p>
<pre><code class="language-bash">cd c:\Users\&lt;user_name&gt;\Documents
mkdir qemu-build
</code></pre>
<p>Start ubuntu wsl2 instance. Now using shell,</p>
<pre><code class="language-bash">cd ~/&lt;some_dir&gt;
mkdir qemu-build
sudo mount --bind "/mnt/c/Users/&lt;user_name&gt;/Documents/qemu-build" qemu-build
cd qemu-build
</code></pre>
<p>This is where we will build qemu for raspberry pi zero.</p>
<p>Get qemu sources and dependencies,</p>
<pre><code class="language-bash">git clone https://github.com/igwtech/qemu
# do followings only if you need to modify submodule sources
# git submodule init
# git submodule update --recursive
</code></pre>
<p>We are using a forked qemu source above because the official qemu repo doesn't provide support for raspberry pi zero. Feel free to diff the code with tags from original source, which will provide valuable insight to adding another arm processor support.</p>
<p>Activate source repositories by un-commenting the <code>deb-src</code> lines in <code>/etc/apt/sources.list</code>.</p>
<p>Get qemu dependencies,</p>
<pre><code class="language-bash">sudo apt-get update
sudo apt-get build-dep qemu
</code></pre>
<p>Create a build directory</p>
<pre><code class="language-bash">mkdir build
cd build
</code></pre>
<p>Configure qemu to build all qemu binaries,</p>
<pre><code class="language-bash">../qemu/configure
</code></pre>
<p>Otherwise if you already have installed all the binaries, or only interested in <code>qemu-arm</code> and <code>qemu-system-arm</code>,
this configures to build just those,</p>
<pre><code class="language-bash">../qemu/configure --target-list=arm-softmmu,arm-linux-user
</code></pre>
<p>To find all the configuration options, run <code>configure --help</code>.</p>
<p>Build and install qemu,</p>
<pre><code class="language-bash">make
sudo make install
</code></pre>
<p>Now we can remove the mount,</p>
<pre><code class="language-bash">cd ../..
sudo umount qemu-build
</code></pre>
<p>You can remove the build directory <code>qemu-build\build</code> if you like, or keep it for later development.</p>
<p>Run qemu for raspi0,</p>
<pre><code class="language-bash">qemu-system-arm -machine raspi0 -serial stdio  -dtb bcm2708-rpi-zero-w.dtb -kernel kernel.img -append 'printk.time=0 earlycon=pl011,0x20201000 console=ttyAMA0'
</code></pre>
<p>qemu-kvm has problems in wsl2, currently it does not work properly.</p>
<h2 id="raspbian-apt-sources"><a class="header" href="#raspbian-apt-sources">Raspbian apt sources</a></h2>
<p><code>/etc/apt/sources.list</code>,</p>
<pre><code>deb http://raspbian.raspberrypi.org/raspbian/ buster main contrib non-free rpi
# Uncomment line below then 'apt-get update' to enable 'apt-get source'
#deb-src http://raspbian.raspberrypi.org/raspbian/ buster main contrib non-free rpi
</code></pre>
<p><code>/etc/apt/sources.list.d/raspi.list</code>,</p>
<pre><code>deb http://archive.raspberrypi.org/debian/ buster main
# Uncomment line below then 'apt-get update' to enable 'apt-get source'
#deb-src http://archive.raspberrypi.org/debian/ buster main
</code></pre>
<h2 id="install-the-cross-compiler"><a class="header" href="#install-the-cross-compiler">install the cross compiler</a></h2>
<p>check <a href="https://github.com/Pro/raspi-toolchain">https://github.com/Pro/raspi-toolchain</a> to use their prebuilt toolchain in wsl2</p>
<pre><code># Download the toolchain:
wget https://github.com/Pro/raspi-toolchain/releases/latest/download/raspi-toolchain.tar.gz
# The toolchain has to be in /opt/cross-pi-gcc since it's not location independent.
sudo tar xfz raspi-toolchain.tar.gz --strip-components=1 -C /opt
</code></pre>
<h2 id="raspbian-filesystem"><a class="header" href="#raspbian-filesystem">raspbian filesystem</a></h2>
<p><code>/etc/fstab</code>,</p>
<pre><code>proc            /proc           proc    defaults          0       0
PARTUUID=288695f5-01  /boot           vfat    defaults          0       2
PARTUUID=288695f5-02  /               ext4    defaults,noatime  0       1
# a swapfile is not a swap partition, no line here
#   use  dphys-swapfile swap[on|off]  for that
</code></pre>
<p><code>pi-sd-2/etc/ld.so.preload</code>,</p>
<pre><code>/usr/lib/arm-linux-gnueabihf/libarmmem-${PLATFORM}.so
</code></pre>
<h3 id="installing-library-dependencies-in-a-image"><a class="header" href="#installing-library-dependencies-in-a-image">Installing library dependencies in a image</a></h3>
<p>If there is a dependency on additional libraries, we should install those
in the raspberry pi SD. Then we can save an image of the SD using <code>Win32DiskImage</code>
in a <code>.img</code> file. Now we can mount the image and copy the
necessary libraries to the toolchain sysroot we installed earlier.</p>
<pre><code class="language-bash">$ fdisk -lu /mnt/d/pi_images/pi-sd.img
Disk /mnt/d/pi_images/pi-sd.img: 28.97 GiB, 31086084096 bytes, 60715008 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0x288695f5

Device                      Boot  Start      End  Sectors  Size Id Type
/mnt/d/pi_images/pi-sd.img1        8192   532479   524288  256M  c W95 FAT32 (LBA)
/mnt/d/pi_images/pi-sd.img2      532480 60715007 60182528 28.7G 83 Linux
</code></pre>
<p>The <code>fat32</code> partition is the first one. The offset is 8192*512=4194304 and
size is 524288*512=268435456 in bytes.</p>
<p>The <code>ext4</code> partition is the second one. The offset is 512*532480=272629760 and size is 512*60182528=30813454336 in bytes.</p>
<p>Now you can mount them,</p>
<pre><code class="language-bash">mkdir /home/pi/pi-sd-1
mkdir /home/pi/pi-sd-2

mount -o loop,offset=4194304,sizelimit=268435456 /mnt/d/pi-images/pi-sd.img /home/pi/pi-sd-1
mount -o loop,offset=272629760 /mnt/d/pi_images/pi-sd.img /home/pi/pi-sd-2

ls -la /home/pi/pi-sd-1
ls -la /home/pi/pi-sd-2
</code></pre>
<p>There is no need to specify size for the last partition.
At this point we can edit the image to get it ready for emulation.</p>
<p>to cross compile copy all libraries</p>
<pre><code>rsync -vR --progress -rl --delete-after --safe-links /home/pi/pi-sd-2/{lib,usr,etc/ld.so.conf.d,opt/vc/lib} $HOME/rpi/rootfs
</code></pre>
<p>(TODO)
Now you can copy appropriate libraries to
<code>/opt/rpi_tools/arm-bcm2708/arm-linux-gnueabihf/arm-linux-gnueabihf/sysroot</code>.</p>
<h2 id="qemu-rpi-kernel-todo"><a class="header" href="#qemu-rpi-kernel-todo">qemu rpi kernel (TODO)</a></h2>
<ul>
<li><a href="https://github.com/dhruvvyas90/qemu-rpi-kernel">https://github.com/dhruvvyas90/qemu-rpi-kernel</a> this claims some adjustment on rpi kernel for qemu need to investigate what this adjustment is and is it  relevant any more.</li>
</ul>
<h2 id="disk-images"><a class="header" href="#disk-images">disk images</a></h2>
<ul>
<li><a href="https://askubuntu.com/questions/667291/create-blank-disk-image-for-file-storage">Create blank disk image for file storage</a></li>
<li><a href="https://superuser.com/questions/693158/can-i-expand-the-size-of-a-file-based-disk-image/693162">Can I expand the size of a file based disk image?</a></li>
</ul>
<h2 id="utilities"><a class="header" href="#utilities">utilities</a></h2>
<ul>
<li><a href="https://github.com/johnlane/rpi-utils">Raspberry-Pi Utilities</a>.
A very nice place to learn how to chroot and get emulation going.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rust-in-raspberry-pi"><a class="header" href="#rust-in-raspberry-pi">Rust in Raspberry Pi</a></h1>
<h2 id="notes-1"><a class="header" href="#notes-1">Notes</a></h2>
<ul>
<li><a href="https://github.com/diwic/dbus-rs/blob/master/libdbus-sys/cross_compile.md">https://github.com/diwic/dbus-rs/blob/master/libdbus-sys/cross_compile.md</a></li>
<li><a href="https://github.com/diwic/dbus-rs/issues/184#issuecomment-520228758">https://github.com/diwic/dbus-rs/issues/184#issuecomment-520228758</a></li>
</ul>
<h2 id="setup-wsl2-for-cross-compile"><a class="header" href="#setup-wsl2-for-cross-compile">Setup wsl2 for cross compile</a></h2>
<p>First install cross compile toolchain from <a href="https://github.com/kkibria/raspi-toolchain">https://github.com/kkibria/raspi-toolchain</a> in wsl2.
The toolchain install will create a temporary download area, which will contain the Raspbian image file.
Save the file image file or save the download area. We will need the image to install additional
libraries if required.</p>
<h2 id="setup-wsl2-for-rust"><a class="header" href="#setup-wsl2-for-rust">Setup wsl2 for rust</a></h2>
<p>Now install rust and setup rust,</p>
<pre><code>curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
. ~/.bashrc
rustc --version
rustup target add arm-unknown-linux-gnueabihf
</code></pre>
<p>We need to add our build target to <code>~/.cargo/config</code> by adding the following lines, so that rust knows which linker to use.</p>
<pre><code>[build]
# Specifies that the default target is ARM.
target = "arm-unknown-linux-gnueabihf"
rustflags = ["-L", "/lib/arm-linux-gnueabihf"]

[target.arm-unknown-linux-gnueabihf]
linker = "arm-linux-gnueabihf-gcc"
</code></pre>
<p>Now you have a working Rust cross-compilation toolchain set up.</p>
<h2 id="rust-projects-requiring-native-library"><a class="header" href="#rust-projects-requiring-native-library">rust projects requiring native library</a></h2>
<p>If you are building the native library yourself then you know what you are doing.
However, what if you are using a library that is available from raspbian apt
repository?</p>
<p>This might be the case for your project, One such example project is building
something that uses dbus. The same technique can be applied on other projects
needing to use native libraries. So we will explore the dbus case.</p>
<h2 id="pi-dbus-tooling-for-rust"><a class="header" href="#pi-dbus-tooling-for-rust">Pi Dbus tooling for rust</a></h2>
<p>We need to configure the DBus crate for cross compilation.
The DBus crate uses a build script that uses pkg_config to locate
the native dbus libraries.</p>
<p><code>cargo:rustc-link-search</code>, which is the library search path.
<code>cargo:rust-link-lib</code>, which is the name of a library to link.</p>
<p>For, this we need to add Dbus libraries to <code>~/.cargo/config</code>.</p>
<pre><code>[target.arm-unknown-linux-gnueabihf.dbus]
# Specifies the library search paths.
rustc-link-search = [
    # we will have to add the path
    # when we know where the libraries are installed.
]

# Specifies the names of the native libraries that are required to build DBus.
rustc-link-lib = [
    "dbus-1",
    "gcrypt",
    "gpg-error",
    "lz4",
    "lzma",
    "pcre",
    "selinux",
    "systemd",
]
</code></pre>
<h2 id="use-libget-to-get-the-required-libraries"><a class="header" href="#use-libget-to-get-the-required-libraries">Use <strong>libget</strong> to get the required libraries</a></h2>
<p>when you installed the toolchain in wsl2, it also installed <code>libget</code>. This automates everything
we need to do and install the libraries in <code>~/rootfs</code>.</p>
<p>We can add the libraries to our root file system from ~/rootfs using <code>rsync</code></p>
<pre><code>pushd ~/rootfs
rsync -vR --progress -rl --delete-after --safe-links {etc,lib,sbin,usr,var} $HOME/rpi/rootfs
popd
</code></pre>
<h2 id="use-liblink-to-make-links-to-library-for-rust"><a class="header" href="#use-liblink-to-make-links-to-library-for-rust">Use <strong>liblink</strong> to make links to library for rust</a></h2>
<p>When you installed the toolchain in wsl2, it also installed <code>liblink</code>. This automates everything
we need to do and install the links in <code>~/liblink</code> folder.</p>
<pre><code>liblink dbus-1 gcrypt gpg-error lz4 pcre lzma pthread dl selinux systemd
</code></pre>
<h2 id="add-the-library-search-path-for-dbus-libraries"><a class="header" href="#add-the-library-search-path-for-dbus-libraries">Add the library search path for dbus libraries</a></h2>
<p><code>~/liblink</code> we created is
not inside the rust project folder. Therefore, we can simply make
rust use this folder for linking. In such case, we will specify
the absolute path of <code>~/liblink</code>
in <code>~/.cargo/config</code> search link section, <code>rustc-link-search</code>.</p>
<p><code>~/.cargo/config</code>.</p>
<pre><code>[target.arm-unknown-linux-gnueabihf.dbus]
# Specifies the library search paths.
rustc-link-search = [
    # absolute path of ~/liblink
    /home/username/liblink
]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="native-library-for-rust-in-raspberry-pi"><a class="header" href="#native-library-for-rust-in-raspberry-pi">Native library for Rust in Raspberry Pi</a></h1>
<p>We will look into problems that we face in getting native library for cross compiling
rust for pi here. This will clear your understanding of how the wsl cross compile tool
helps us dealing with those. As we mentioned before dbus based project will be a good
case study to shed light
into rust cross compiling issues related to using native library in raspberry pi.</p>
<h2 id="a-simple-dbus-project-for-testing"><a class="header" href="#a-simple-dbus-project-for-testing">A simple dbus project for testing</a></h2>
<p>To see how to set up the DBus crate for cross compilation,
we will create a new project for it. Create an empty directory somewhere
run the following,</p>
<p>Bash</p>
<pre><code># Initialize a new Rust project in the current folder.
cargo init
</code></pre>
<p>this produces following layout</p>
<pre><code>.
├── Cargo.toml
├── build.rs
└── src
    └── main.rs
</code></pre>
<p>The crate's build script is specified in Cargo.toml and is normally executed at every build.</p>
<p>Change the contents of main.rs to the following. This is just so that we actually use something
from the DBus crate, otherwise there would be no reference to it in the final executable and nothing for the linker to do.</p>
<p><code>main.rs</code></p>
<pre><code>use dbus::{BusType, Connection, Interface, Member};
use std::error::Error;

fn main() -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt; {
    let conn = Connection::get_private(BusType::System)?;
    let obj = conn.with_path("org.freedesktop.DBus", "/", 5000);
    let msg = obj.method_call_with_args(
        &amp;Interface::from(&amp;"org.freedesktop.DBus".to_owned()),
        &amp;Member::from(&amp;"ListNames".to_owned()),
        |_| (),
    )?;
    let names: Vec&lt;String&gt; = msg.get1().unwrap_or(Vec::new());
    for name in names {
        println!("{}", name);
    }
    Ok(())
}
</code></pre>
<p>Next, add the DBus crate as an dependency by editing Cargo.toml.</p>
<p>Cargo.toml</p>
<pre><code>[dependencies]
dbus = "0.6"
</code></pre>
<p>If you try building the project at this point, you will an error
message indicating linking failure. We have to find find and download
the native arm libraries required by DBus.</p>
<h2 id="problem-statement-1-details-on-getting-missing-libraries"><a class="header" href="#problem-statement-1-details-on-getting-missing-libraries">Problem statement 1: Details on getting missing libraries</a></h2>
<p>How do you even find out which of the native packages are required?
If you take a look at this line in the DBus build script, you see that
it is looking for "dbus-1", which means libdbus-1.</p>
<p>OK, now which version of libdbus-1 is required? If you have your target system at hand,
you can connect to it and run apt show libdbus-1* on it, which should show something like this.</p>
<p>libdbus-1 Information</p>
<pre><code>Package: libdbus-1-3
Version: 1.12.16-1
...
Depends: libc6 (&gt;= 2.28), libsystemd0
...
</code></pre>
<p>If you do not have the target system at hand, there is still a way:
If you are using the Raspbian release based on Debian buster, head to
this link (this is a huge file!) and search for Package: libdbus-1 inside there.
You should see the same information.</p>
<p>Now we know that we have to download libdbus1-3 version 1.12.16-1 and it
depends on libc6 (which is provided by the cross compilation toolchain)
and libsystemd0 (which is not and which we also have to download).</p>
<p>In total, you have to download the following packages (the .deb files).
This list contains the versions for the Raspbian release based on Debian buster.
They may have changed since, check the versions installed on your target system.
Click each of the package names below and download the correct file.</p>
<pre><code>libdbus-1-3 is at version 1.12.16-1
libgcrypt20 is at version 1.8.4-5
libgpg-error0 is at version 1.35-1
liblz4-1 is at version 1.8.3-1
liblzma5 is at version 5.2.4-1
libpcre3 is at version 2:8.39-12
libselinux1 is at version 2.8-1+b1
libsystemd0 is at version 241-5+rpi1
</code></pre>
<p>Next, you have to extract each of these downloaded .deb files separately into an empty folder.</p>
<p>Bash</p>
<pre><code>dpkg-deb -x /path/to/package.deb /path/to/empty/folder
</code></pre>
<p><strong>Solution: See <a href="topics/pirust.html#use-libget-to-get-the-required-libraries">Use <strong>libget</strong> to get the required libraries</a></strong>.</p>
<h2 id="problem-statement-2-links-to-library-for-rust"><a class="header" href="#problem-statement-2-links-to-library-for-rust">Problem statement 2: Links to library for rust</a></h2>
<p>Enter the folder you have extracted the package into and take a look at the files.
The folder structure can be ./lib/arm-linux-gnueabihf or even
./usr/lib/arm-linux-gnueabihf inside this folder.
The relevant files are the .so files. Some libraries however have another
number after the .so, for example library.so.3. In this case, you have to add
a symlink to library.so because that's where the GCC linker will look for it.
The symlink must be in the same directory as the file it points to.
To create a symlink called library.so that points to library.so.3,
you would use the following command.</p>
<pre><code class="language-bash">ln -s library.so.3 library.so
</code></pre>
<p>in our case,
for dbus, we will create links</p>
<pre><code>pushd /lib/arm-linux-gnueabihf
ln -sf libdbus-1.so.3 libdbus-1.so
ln -sf libgcrypt.so.20 libgcrypt.so
ln -sf libgpg-error.so.0 libgpg-error.so
ln -sf liblz4.so.1 liblz4.so
ln -sf libpcre.so.3 libpcre.so
ln -sf liblzma.so.5 liblzma.so
ln -sf libpthread.so.0 libpthread.so
ln -sf libdl.so.2 libdl.so
ln -sf libselinux.so.1 libselinux.so
ln -sf libsystemd.so.0 libsystemd.so
popd
</code></pre>
<p>Then take all the contents of the folder you extracted the package into and move them into another folder called libraries, which you create at the root of your Rust project. This is the location we directed the GCC linker to look for the libraries.</p>
<p>Repeat the extraction, symlinking and moving for all the other libraries.</p>
<p>Finally, after all this is done, your libraries folder should look something like this (the version numbers may differ):</p>
<pre><code>./lib/arm-linux-gnueabihf/libdbus-1.so
./lib/arm-linux-gnueabihf/libdbus-1.so.3
./lib/arm-linux-gnueabihf/libdbus-1.so.3.14.15
./lib/arm-linux-gnueabihf/libgcrypt.so
...
./usr/lib/arm-linux-gnueabihf/liblz4.so
./usr/lib/arm-linux-gnueabihf/liblz4.so.1
...
</code></pre>
<p><strong>Solution: See <a href="topics/pirust.html#use-liblink-to-make-links-to-library-for-rust">Use <strong>liblink</strong> to make links to library for rust</a></strong>.</p>
<h2 id="problem-statement-3-specifying-library-search-path"><a class="header" href="#problem-statement-3-specifying-library-search-path">Problem statement 3: Specifying library search path</a></h2>
<p>We have to provide the <code>cargo:rustc-link-search</code> key to
make sure all the needed libraries are found.</p>
<p>There are two ways we can provide any key to Cargo:</p>
<ul>
<li>In a Cargo config file.</li>
<li>In our own build script.</li>
</ul>
<p>We need to know how Cargo handles relative paths
in rustc-link-search:
They are resolved relative to the location of the extracted crate,
not relative to a project.</p>
<p>So the takeaway is, we would have to specify the absolute library search paths if we
don't want a crate relative path. How do we provide project relative search path
if thats what we need?
In such case, we can use build script
to convert project relative paths to absolute library search paths.</p>
<p>Following is an example when we have native libraries
inside a "libraries" folder within the project,
<code>build.rs</code></p>
<pre><code>use std::env::var;

fn main() {
    // The manifest dir points to the root of the project containing this file.
    let manifest_dir = var("CARGO_MANIFEST_DIR").unwrap();
    // We tell Cargo that our native libraries are inside a "libraries" folder.
    println!("cargo:rustc-link-search={}/libraries/lib/arm-linux-gnueabihf", manifest_dir);
    println!("cargo:rustc-link-search={}/libraries/usr/lib/arm-linux-gnueabihf", manifest_dir);
}
</code></pre>
<p>Anyways, accessing dbus crate needed native libraries from a fixed location is what we need
in this case to keep thing simple and reusable.
This way we can simply use an absolute path in <code>~/.cargo/config</code> without depending
on the build script to provide search path.</p>
<p><strong>Solution: See <a href="topics/pirust.html#add-the-library-search-path-for-dbus-libraries">Add the library search path for dbus libraries</a></strong>.</p>
<h2 id="cross-compile-2"><a class="header" href="#cross-compile-2">Cross compile</a></h2>
<p>Finally, you will be able to cross compile the test project without error messages.</p>
<p>Bash</p>
<pre><code>cargo build
#    Should print something like: 
# Finished dev [unoptimized + debuginfo] target(s) in 0.57s
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="using-dbus-in-pi"><a class="header" href="#using-dbus-in-pi">Using dbus in pi</a></h1>
<h2 id="note-on-getting-dbus-interfaces"><a class="header" href="#note-on-getting-dbus-interfaces">Note on getting dbus interfaces</a></h2>
<blockquote>
<p>Lot of the followings have been actually updated, check <a href="https://github.com/kkibria/dbus-dev">https://github.com/kkibria/dbus-dev</a></p>
</blockquote>
<p>the xml files were generated in raspberry pi</p>
<pre><code class="language-bash">dbus-send --system --dest=fi.w1.wpa_supplicant1 \
  --type=method_call --print-reply=literal /fi/w1/wpa_supplicant1 \
  org.freedesktop.DBus.Introspectable.Introspect &gt; wpa.xml

dbus-send --system --dest=org.freedesktop.timedate1 \
  --type=method_call --print-reply=literal /org/freedesktop/timedate1 \
  org.freedesktop.DBus.Introspectable.Introspect &gt; timedate.xml
</code></pre>
<p>and copied in the project.</p>
<p>then on wsl we can use the xml files</p>
<pre><code class="language-bash">dbus-codegen-rust -s -f org.freedesktop.timedate1 &lt; timedate.xml &gt; src/timedate.rs
dbus-codegen-rust -s -f fi.w1.wpa_supplicant1 &lt; wpa.xml &gt; src/wpa.rs
</code></pre>
<p>alternatively we can use dbus-codegen-rust on pi to generate rust files directly and copy to rust project</p>
<p>put it all together in <code>get-pi-rs.sh</code></p>
<pre><code class="language-bash">#assuming RPI is already exported in .bashrc
ssh $RPI 'bash -s' &lt;&lt;-"EOF"
 export PATH=$HOME/.cargo/bin:$PATH
 rm -rf temp-wsl
 mkdir temp-wsl
 pushd temp-wsl
 dbus-codegen-rust -s -d org.freedesktop.timedate1 -p "/org/freedesktop/timedate1" -f org.freedesktop.timedate1 &gt; timedate.rs
 dbus-codegen-rust -s -d fi.w1.wpa_supplicant1 -p "/fi/w1/wpa_supplicant1" -f fi.w1.wpa_supplicant1 &gt; wpa.rs
 popd
EOF
rcp $RPI:temp-wsl/*.rs src
</code></pre>
<h2 id="python-example-for-dbus"><a class="header" href="#python-example-for-dbus">Python example for dbus</a></h2>
<ul>
<li><a href="https://android.googlesource.com/platform/external/wpa_supplicant_8/+/master/wpa_supplicant/examples/wpas-dbus-new.py">wpas-dbus-new.py</a></li>
</ul>
<h2 id="setting-up-dbus-for-interacting-with-wpa_supplicant"><a class="header" href="#setting-up-dbus-for-interacting-with-wpa_supplicant">Setting up dbus for interacting with WPA_SUPPLICANT</a></h2>
<p>I was trying to write some code that is to use dbus api to access wpa_supplicant. My understanding from reading various posts that wpa_supplicant must be started with <code>-u</code> flag to fully expose it's apis to dbus. So I edited, <code>/lib/dhcpcd/dhcpcd-hooks/10-wpa_supplicant</code> to by adding the <code>-u</code> flag to the invocation of the <code>wpa_supplicant</code> daemon in the <code>wpa_supplicant_start()</code>.</p>
<p>At this point I couldn't use wpa_cli to connect to <code>wlan0</code> anymore. I checked the processes with <code>ps</code> and got,</p>
<pre><code>pi@raspi:~ $ ps -aux | grep wpa_sup
root       306  0.0  1.0  10724  4732 ?        Ss   21:21   0:00 /sbin/wpa_supplicant -u -s -O /run/wpa_supplicant
</code></pre>
<p>So, I edited <code>/lib/dhcpcd/dhcpcd-hooks/10-wpa_supplicant</code> again to remove <code>-u</code> flag, rebooted etc. and again checked the processes. This time I got,</p>
<pre><code>pi@raspi:~ $ ps -aux | grep wpa_sup
root       260  0.3  1.0  10724  4640 ?        Ss   21:25   0:00 /sbin/wpa_supplicant -u -s -O /run/wpa_supplicant
root       350  0.1  0.9  10988  4052 ?        Ss   21:25   0:00 wpa_supplicant -B -c/etc/wpa_supplicant/wpa_supplicant.conf -iwlan0 -Dnl80211,wext
</code></pre>
<p>and now I can use wpa_cli to connect to <code>wlan0</code>.</p>
<p>This is confusing to me. I am not sure why.</p>
<p>After some digging, it appears that <code>wpa_supplicant.service</code> should be disabled as it was preventing <code>wpa_cli</code> from connecting to <code>wlan0</code>.</p>
<p>After doing,</p>
<pre><code class="language-bash">sudo systemctl disable wpa_supplicant
sudo reboot
</code></pre>
<p>I was able to connect.</p>
<p>I am still not sure why.</p>
<p><a href="https://raspberrypi.stackexchange.com/questions/132998/confusing-wpa-supplicant-processes-while-trying-to-use-dbus-api">https://raspberrypi.stackexchange.com/questions/132998/confusing-wpa-supplicant-processes-while-trying-to-use-dbus-api</a></p>
<p>this has an explanation. <a href="https://github.com/mark2b/wpa-connect">https://github.com/mark2b/wpa-connect</a></p>
<h2 id="cross-compile-dbus-1"><a class="header" href="#cross-compile-dbus-1">cross compile dbus</a></h2>
<ul>
<li><a href="https://github.com/diwic/dbus-rs/blob/master/libdbus-sys/cross_compile.md">https://github.com/diwic/dbus-rs/blob/master/libdbus-sys/cross_compile.md</a></li>
<li><a href="https://serverfault.com/questions/892465/starting-systemd-services-sharing-a-session-d-bus-on-headless-system">https://serverfault.com/questions/892465/starting-systemd-services-sharing-a-session-d-bus-on-headless-system</a> headless dbus.</li>
<li><a href="https://raspberrypi.stackexchange.com/questions/114739/how-to-install-pi-libraries-to-cross-compile-for-pi-zero-in-wsl2">https://raspberrypi.stackexchange.com/questions/114739/how-to-install-pi-libraries-to-cross-compile-for-pi-zero-in-wsl2</a>.</li>
<li><a href="https://airtower.wordpress.com/2010/07/20/using-gvariant-tuples/">https://airtower.wordpress.com/2010/07/20/using-gvariant-tuples/</a></li>
<li><a href="https://fosdem.org/2020/schedule/event/rust_dbus_library/">https://fosdem.org/2020/schedule/event/rust_dbus_library/</a></li>
</ul>
<h2 id="working-with-dbus"><a class="header" href="#working-with-dbus">Working with dbus</a></h2>
<h3 id="how-do-i-get-properties-using-dbus"><a class="header" href="#how-do-i-get-properties-using-dbus">How do I get properties using dbus</a></h3>
<p>I have listed the properties that I am interested in using <code>timedatectl</code> which uses <code>systemd</code> dbus,</p>
<pre><code>$ timedatectl
               Local time: Tue 2020-07-28 19:37:00 PDT
           Universal time: Wed 2020-07-29 02:37:00 UTC
                 RTC time: n/a
                Time zone: America/Los_Angeles (PDT, -0700)
System clock synchronized: yes
              NTP service: active
          RTC in local TZ: no
</code></pre>
<p>Next, I checked <code>timedatectl.c</code> in <code>systemd</code> <a href="https://github.com/systemd/systemd">source code</a> to get bus endpoint and method using which I went ahead and introspected,</p>
<pre><code>$ dbus-send --system --dest=org.freedesktop.timedate1 --type=method_call --print-reply /org/freedesktop/timedate1 org.freedesktop.DBus.Introspectable.Introspect

method return time=1595997538.869702 sender=:1.30 -&gt; destination=:1.29 serial=3 reply_serial=2
   string "&lt;!DOCTYPE node PUBLIC "-//freedesktop//DTD D-BUS Object Introspection 1.0//EN"
"http://www.freedesktop.org/standards/dbus/1.0/introspect.dtd"&gt;
&lt;node&gt;
 ...
 &lt;interface name="org.freedesktop.DBus.Properties"&gt;
  ...
  &lt;method name="GetAll"&gt;
   &lt;arg name="interface" direction="in" type="s"/&gt;
   &lt;arg name="properties" direction="out" type="a{sv}"/&gt;
  &lt;/method&gt;
  ... 
 &lt;/interface&gt;
 &lt;interface name="org.freedesktop.timedate1"&gt;
  &lt;property name="Timezone" type="s" access="read"&gt;
  &lt;/property&gt;
  &lt;property name="LocalRTC" type="b" access="read"&gt;
  &lt;/property&gt;
  ...
 &lt;/interface&gt;
&lt;/node&gt;
"
</code></pre>
<p>Next I tried to use the method <code>GetAll</code>,</p>
<pre><code>$ dbus-send --system --dest=org.freedesktop.timedate1 --type=method_call --print-reply /org/freedesktop/timedate1 org.freedesktop.DBus.Properties.GetAll string:org.freedesktop.timedate1

method return time=1595997688.111555 sender=:1.33 -&gt; destination=:1.32 serial=4 reply_serial=2
   array [
      dict entry(
         string "Timezone"
         variant             string "America/Los_Angeles"
      )
      dict entry(
         string "LocalRTC"
         variant             boolean false
      )
      dict entry(
         string "CanNTP"
         variant             boolean true
      )
      dict entry(
         string "NTP"
         variant             boolean true
      )
      dict entry(
         string "NTPSynchronized"
         variant             boolean true
      )
      dict entry(
         string "TimeUSec"
         variant             uint64 1595997688110070
      )
      dict entry(
         string "RTCTimeUSec"
         variant             uint64 0
      )
   ]
</code></pre>
<p>and we get our desired result same as <code>timedatectl</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="building-embedded-system"><a class="header" href="#building-embedded-system">Building Embedded System</a></h1>
<p>There are two build systems that can be used to build images embedded systems using linux.</p>
<ul>
<li><a href="https://www.yoctoproject.org/">Yocto</a>.</li>
<li><a href="https://buildroot.org/">Buildroot</a>.</li>
</ul>
<p>Tool to help the build</p>
<ul>
<li><a href="https://youtu.be/CiD7rB35CRE">Using Devtool to Streamline Your Yocto Project Workflow - Tim Orling, Intel</a></li>
</ul>
<h2 id="raspberry-pi"><a class="header" href="#raspberry-pi">Raspberry pi</a></h2>
<p>The official raspbian o/s is built with Buildroot, but there is also Yocto based builds available,</p>
<ul>
<li><a href="https://jumpnowtek.com/rpi/Raspberry-Pi-Systems-with-Yocto.html">Building 32-bit Raspberry Pi Systems with Yocto</a>.</li>
<li><a href="https://jumpnowtek.com/rpi/Raspberry-Pi-4-64bit-Systems-with-Yocto.html">Building 64-bit Systems for Raspberry Pi 4 with Yocto</a></li>
<li><a href="https://youtu.be/zVLKPtGCtN4">Building embedded GNU/Linux distribution for Raspberry Pi using the Yocto Project</a>.</li>
</ul>
<p>If you want to switch init system, you can check existing init system by using <code>sudo stat /sbin/init</code>.</p>
<h2 id="cross-compile-raspbian"><a class="header" href="#cross-compile-raspbian">Cross compile raspbian</a></h2>
<ul>
<li><a href="https://medium.com/@zw3rk/making-a-raspbian-cross-compilation-sdk-830fe56d75ba">Making a Raspbian Cross Compilation SDK</a></li>
<li><a href="https://www.raspberrypi.org/documentation/linux/kernel/building.md">Kernel building</a>.</li>
<li><a href="https://mjoldfield.com/atelier/2017/03/rpi-devicetree.html">Devicetree on the Raspberry Pi</a>.</li>
</ul>
<h2 id="yocto-with-wsl2"><a class="header" href="#yocto-with-wsl2">Yocto with wsl2</a></h2>
<ul>
<li><a href="https://github.com/microsoft/WSL/issues/5108">WSL2 file permission issues cause Buildroot and Yocto build failures</a>.</li>
<li><a href="https://github.com/microsoft/WSL/issues/4166#issuecomment-602191299">WSL2 ram usage problem workaround</a>.</li>
<li><a href="https://github.com/microsoft/WSL/issues/4166#issuecomment-609497693">WSL2 ram usage</a>.</li>
<li><a href="https://github.com/microsoft/WSL/issues/4166#issuecomment-604707989">WSL2 ram usage</a>.</li>
<li><a href="https://docs.microsoft.com/en-us/windows/wsl/wsl-config#configure-global-options-with-wslconfig">WSL2 global options</a>.</li>
<li><a href="https://www.yoctoproject.org/docs/3.1.1/mega-manual/mega-manual.html">Yocto mega manual</a></li>
</ul>
<h2 id="wsl2-for-cross-compile"><a class="header" href="#wsl2-for-cross-compile">wsl2 for cross compile</a></h2>
<p>the default mounts for wsl2 ubuntu ext4 is <code>C:\Users\&lt;username&gt;\AppData\Local\Packages\Canonical*\LocalState\ext4.vhdx</code>.
Often time we require multiple instances to work on separate ext4 mount on a different drive for disk space or other reasons.</p>
<p>First check the distro name.</p>
<pre><code>C:\&gt; wsl -l -v
  NAME            STATE           VERSION
* Ubuntu-20.04    Running         2
</code></pre>
<p>The distro name is <code>Ubuntu-20.04</code>.</p>
<p>Now we need to set the default user via editing <code>/etc/wsl.conf</code>.</p>
<pre><code>[user]
default=&lt;username&gt; 
</code></pre>
<p>Now we will create another image which is a copy of the <code>Ubuntu-20.04</code>.</p>
<pre><code>PS C:\&gt; wsl --shutdown
PS C:\&gt; wsl -l -v
  NAME            STATE           VERSION
* Ubuntu-20.04    Stopped         2
PS C:\&gt; cd d:\
PS D:\&gt; mkdir my_wsl
PS D:\&gt; cd my_wsl
PS D:\my_wsl&gt; wsl --export Ubuntu-20.04 my_distro.tar
PS D:\my_wsl&gt; wsl --import my_distro my_distro my_distro.tar
PS D:\my_wsl&gt; wsl -l -v
  NAME            STATE           VERSION
* Ubuntu-20.04    Stopped         2
  my_distro       Stopped         2
</code></pre>
<p>Now we have distro on D drive.</p>
<blockquote>
<p>We can create a VHDX file using windows 10 Computer Management tool. The we can detach it. We have to figure out a way to initialize the file as ext4 and mount
to a wsl2 linux distro.</p>
</blockquote>
<h2 id="manually-download-wsl2-distro"><a class="header" href="#manually-download-wsl2-distro">Manually download wsl2 distro</a></h2>
<p>Use <a href="https://docs.microsoft.com/en-us/windows/wsl/install-manual">download</a> page to get distro. It downloads a .appx file which can be opened by 7zip and extract
<code>install.tar.gz</code>.
now we can use wsl command to install it,</p>
<pre><code>wsl --import my_distro my_distro install.tar.gz
</code></pre>
<h2 id="yocto-devtool"><a class="header" href="#yocto-devtool">yocto devtool</a></h2>
<ul>
<li><a href="https://youtu.be/YE2YjP6Fwlo">Yocto Project® devtool Overviewand Hands-On</a>, <a href="https://wiki.yoctoproject.org/wiki/images/f/f3/DD9_Devtool_NA20.pdf">slides</a>.</li>
<li><a href="https://youtu.be/CiD7rB35CRE">Using Devtool to Streamline Your Yocto Project Workflow - Tim Orling, Intel</a>.</li>
<li><a href="https://youtu.be/d3xanDJuXRA">Yocto Project Extensible SDK: Simplifying the Workflow for Application Developers</a>.</li>
<li><a href="https://youtu.be/tZACGS5nQxw">Working with the Linux Kernel in the Yocto Project</a>.</li>
</ul>
<h2 id="yocto-tutorials"><a class="header" href="#yocto-tutorials">yocto tutorials</a></h2>
<ul>
<li><a href="https://www.youtube.com/playlist?list=PLD4M5FoHz-TxMfBFrDKfIS_GLY25Qsfyj">Live Coding with Yocto Project</a>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ubuntu"><a class="header" href="#ubuntu">Ubuntu</a></h1>
<h2 id="mount-a-usb-stick"><a class="header" href="#mount-a-usb-stick">Mount a USB stick</a></h2>
<p>Insert the USB stick. First get the device path of the usb stick by running <code>lsblk</code>.</p>
<p>It will look something like, assuming that it has only one partition.</p>
<pre><code class="language-text">sdb      8:16   1  14.9G  0 disk 
└─sdb1   8:17   1   1.6G  0 part
</code></pre>
<p>Get the filesystem type of the partition by running <code>blkid</code>,</p>
<pre><code>sudo blkid /dev/sdb1
/dev/sdb1: UUID="...." TYPE="fat"
</code></pre>
<p>Now assuming that path <code>/media</code> exists, mount the partition.</p>
<pre><code>sudo mount -t &lt;type&gt; /dev/sdb1 /media
</code></pre>
<p>it will mount the usb drive it to path <code>/media</code>.</p>
<blockquote>
<p>Note: Default type is <code>fat</code>.</p>
</blockquote>
<p>When done with the USB stick, unmount,</p>
<pre><code>sudo umount /dev/sdb1
</code></pre>
<p>and remove the stick.</p>
<h2 id="debugging-kernel-or-system-program-crash"><a class="header" href="#debugging-kernel-or-system-program-crash">Debugging kernel or system program crash</a></h2>
<ul>
<li><a href="https://ruffell.nz/programming/writeups/2019/02/22/beginning-kernel-crash-debugging-on-ubuntu-18-10.html">Beginning Kernel Crash Debugging on Ubuntu 18.10</a>.</li>
<li><a href="https://askubuntu.com/questions/92946/cannot-boot-because-kernel-panic-not-syncing-attempted-to-kill-init">Kernel panic - not syncing: Attempted to kill init!</a>.</li>
<li>Regarding Annoying crash report- <a href="https://itsfoss.com/how-to-fix-system-program-problem-detected-ubuntu/">How To Fix System Program Problem Detected In Ubuntu</a>.</li>
</ul>
<h2 id="file-system-check"><a class="header" href="#file-system-check">File system check</a></h2>
<p>The simplest way to force <code>fsck</code> filesystem check on a root partition
eg. <code>/dev/sda1</code> is to create an empty file called forcefsck in the
partition's root directory.</p>
<pre><code class="language-bash">sudo touch /forcefsck
</code></pre>
<p>This empty file will temporarily override any other settings and force
<code>fsck</code> to check the filesystem on the next system reboot. Once the
filesystem is checked the <code>forcefsck</code> file will be removed thus next time
you reboot your filesystem will NOT be checked again. Once boot completes,
the result of <code>fsck</code> will be available in <code>/var/log/boot.log</code>. Also
the ram filesystem used during boot will log it in
<code>/run/initramfs/fsck.log</code>. This file will be lost as soon as the system
is shut down since the ram filesystem is volatile.</p>
<h2 id="security"><a class="header" href="#security">Security</a></h2>
<ul>
<li><a href="https://www.howtogeek.com/118222/htg-explains-what-apparmor-is-and-how-it-secures-your-ubuntu-system/">What Is AppArmor, and How Does It Keep Ubuntu Secure?</a></li>
</ul>
<h2 id="setting-up-ubuntu-server-with-lubuntu-desktop-in-a-virtualbox-vm"><a class="header" href="#setting-up-ubuntu-server-with-lubuntu-desktop-in-a-virtualbox-vm">Setting up ubuntu server with lubuntu desktop in a VirtualBox VM</a></h2>
<h3 id="set-up-the-vm-with"><a class="header" href="#set-up-the-vm-with">Set up the VM with,</a></h3>
<ul>
<li>4G memeory.</li>
<li>32G vdi disk.</li>
<li>Network: NAT / Host only</li>
<li>Clipboard: bidirectional.</li>
</ul>
<h3 id="setup-linux"><a class="header" href="#setup-linux">Setup linux</a></h3>
<p>Install ubuntu server from server.iso using a USB drive.</p>
<p>Now setup the desktop,</p>
<pre><code class="language-bash">sudo apt-get update
# Install lubuntu desktop
sudo apt-get install lubuntu-desktop
# get guest addition
sudo apt-get install virtualbox-guest-x11
</code></pre>
<p>Now go to <code>Start &gt; Preferences &gt; Monitor settings</code> and select a resolution of your choice.</p>
<h3 id="custom-resolution"><a class="header" href="#custom-resolution">Custom Resolution</a></h3>
<p>First we need to find out what display outputs are available.</p>
<pre><code class="language-bash">$ xrandr -q
Screen 0: minimum 640 x 400, current 1600 x 1200, maximum 1600 x 1200
Virtual1 connected 1600x1200+0+0 0mm x 0mm
   1600x1200       0.0* 
   1280x1024       0.0  
   640x480         0.0  
...
</code></pre>
<p>This means <code>Virtual1</code> is the first output device, there might be more listed. Find which output you want the monitor to connect to.</p>
<p>Lets say we want a monitor resolution of 960 x 600 @ 60Hz.</p>
<pre><code class="language-bash"># get a Modeline 
gtf 960 600 60
</code></pre>
<p>Lets say output will look like:</p>
<pre><code class="language-txt"># 960x600 @ 60.00 Hz (GTF) hsync: 37.32 kHz; pclk: 45.98 MHz
Modeline "960x600_60.00"  45.98  960 1000 1096 1232  600 601 604 622  -HSync +Vsync
</code></pre>
<p>The string <code>960x600_60.00</code> is just an identifier proposed. For the following you can substitute it to anything more meaningful.</p>
<p>Now we will use this Modeline content to set our configuration,</p>
<pre><code class="language-bash"># define a mode
xrandr --newmode "960x600_60.00"  45.98  960 1000 1096 1232  600 601 604 622  -HSync +Vsync
# map this mode to a output
xrandr --addmode Virtual1 "960x600_60.00"
</code></pre>
<p>At this point you can switch to the new resolution by
going to <code>Start &gt; Preferences &gt; Monitor settings</code> and Selecting the resolution added.
Alternatively you can switch mode for the output from the terminal,</p>
<pre><code class="language-bash">xrandr --output Virtual1 --mode "960x600_60.00"
</code></pre>
<p>The whole thing can be turned into a bash script,</p>
<pre><code class="language-bash">#!/bin/bash

# get the modeline for the following resolution
RESOLUTION="960 600 60"
# extract modeline settings
SETTINGS=$( gtf $RESOLUTION | grep Modeline | cut -d ' ' -f4-16 )
# define the mode
xrandr --newmode $SETTINGS
# get name of mode from settings
MODE=$( echo $SETTINGS | cut -d ' ' -f1 )
# get the first connected output device
DEVICE=$( xrandr -q | grep "connected" | head -1 | cut -d ' ' -f1 )
# map this mode to the device
xrandr --addmode $DEVICE $MODE
# switch to the new mode
xrandr --output $DEVICE --mode $MODE
</code></pre>
<h3 id="changing-the-cursor-size"><a class="header" href="#changing-the-cursor-size">Changing the cursor size</a></h3>
<p>To change the size of your mouse cursor,
open the desktop configuration file <code>~/.config/lxsession/lubuntu/desktop.conf</code>,
find the key <code>iGtk/CursorThemeSize</code> and update the value to the desired size.</p>
<h2 id="converting-virtualbox-vdi-or-vmdk-to-a-iso"><a class="header" href="#converting-virtualbox-vdi-or-vmdk-to-a-iso">Converting VirtualBox VDI (or VMDK) to a ISO</a></h2>
<ul>
<li>Inspired by the article, <a href="https://www.turnkeylinux.org/blog/convert-vm-iso">Converting a virtual disk image: VDI or VMDK to an ISO you can distribute</a>.</li>
<li><a href="https://www.turnkeylinux.org/docs/tklpatch">TKLPatch - a simple appliance customization mechanism</a>. Source in <a href="https://github.com/turnkeylinux/tklpatch">github</a>.</li>
<li><a href="https://forums.virtualbox.org/viewtopic.php?t=8046">All about VDIs</a></li>
</ul>
<p>create raw image</p>
<pre><code class="language-bash">VBoxManage clonemedium turnkey-core.vdi turnkey-core.raw --format RAW
</code></pre>
<p>Next, mount the raw disk as a loopback device.</p>
<pre><code class="language-bash">mkdir turnkey-core.mount
mount -o loop turnkey-core.raw turnkey-core.mount
</code></pre>
<p>GOTCHA 1: If your VM has partitions, it's a little tricker. You'll need to setup the loop device, partition mappings and finally mount the rootfs partition. You will need kpartx to setup the mappings.</p>
<pre><code class="language-bash">loopdev=$(losetup -s -f turnkey-core.raw)

apt-get install kpartx
kpartx -a $loopdev

# p1 refers to the first partition (rootfs)
mkdir turnkey-core.mount
mount /dev/mapper/$(basename $loopdev)p1 turnkey-core.mount
</code></pre>
<p>Extract root filesystem and tweak for ISO configuration
Now, make a copy of the root filesystem and unmount the loopback.</p>
<pre><code class="language-bash">mkdir turnkey-core.rootfs
rsync -a -t -r -S -I turnkey-core.mount/ turnkey-core.rootfs

umount -d turnkey-core.mount

# If your VM had partitions (GOTCHA 1):
kpartx -d $loopdev
losetup -d $loopdev

</code></pre>
<p>Because the VM is an installed system as opposed to the ISO, the file system table needs to be updated.</p>
<pre><code class="language-bash">cat&gt;turnkey-core.rootfs/etc/fstab&lt;&lt;EOF
aufs / aufs rw 0 0
tmpfs /tmp tmpfs nosuid,nodev 0 0
EOF
</code></pre>
<p>GOTCHA 2: If your VM uses a kernel optimized for virtualization (like the one included in the TurnKey VM builds), you need to replace it with a generic kernel, and also remove vmware-tools if installed.
You can remove any other unneeded packages.</p>
<pre><code class="language-bash">tklpatch-chroot turnkey-core.rootfs

# inside the chroot
apt-get update
apt-get install linux-image-generic
dpkg --purge $(dpkg-query --showformat='${Package}\n' -W 'vmware-tools*')
dpkg --purge $(dpkg-query --showformat='${Package}\n' -W '*-virtual')

exit
</code></pre>
<p>Generate the ISO
Finally, prepare the cdroot and generate the ISO.</p>
<pre><code class="language-bash">tklpatch-prepare-cdroot turnkey-core.rootfs/
tklpatch-geniso turnkey-core.cdroot/
</code></pre>
<p>this will create my_system.iso</p>
<p>Thats it!</p>
<p>burn it to usb</p>
<ul>
<li><a href="https://askubuntu.com/questions/372607/how-to-create-a-bootable-ubuntu-usb-flash-drive-from-terminal">How to create a bootable Ubuntu USB flash drive from terminal?</a></li>
</ul>
<p>You can use <code>dd</code>.</p>
<p>usb partition looks like <code>/dev/sd&lt;?&gt;&lt;?&gt;</code> where <code>&lt;?&gt;&lt;?&gt;</code> is a letter followed by a number.</p>
<p>Look usb disk up first by running <code>lsblk</code>.
It will look something like,</p>
<pre><code class="language-text">sdb      8:16   1  14.9G  0 disk 
├─sdb1   8:17   1   1.6G  0 part /media/username/usb volume name
└─sdb2   8:18   1   2.4M  0 part 
</code></pre>
<p>Now you can unmount the usb as following,</p>
<pre><code class="language-bash"> sudo umount /dev/sdb1  
</code></pre>
<p>Then, next (this is a destructive command and wipes the entire USB drive with the contents of the iso, so be careful):</p>
<pre><code class="language-bash"> sudo dd bs=4M if=path/to/my_system.iso of=/dev/sdb1 conv=fdatasync  status=progress
</code></pre>
<p>Where <code>my_system.iso</code> is the input file, and <code>/dev/sdb1</code> is the USB device you're writing to.</p>
<h2 id="reset-password"><a class="header" href="#reset-password">Reset password</a></h2>
<ul>
<li><a href="https://askubuntu.com/questions/24006/how-do-i-reset-a-lost-administrative-password">https://askubuntu.com/questions/24006/how-do-i-reset-a-lost-administrative-password</a></li>
</ul>
<h2 id="ssh-keys"><a class="header" href="#ssh-keys">SSH keys</a></h2>
<ul>
<li><a href="https://www.freecodecamp.org/news/how-to-manage-multiple-ssh-keys/">https://www.freecodecamp.org/news/how-to-manage-multiple-ssh-keys/</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="artificial-intelligence"><a class="header" href="#artificial-intelligence">Artificial Intelligence</a></h1>
<ul>
<li><a href="https://medium.com/ai-society/gans-from-scratch-1-a-deep-introduction-with-code-in-pytorch-and-tensorflow-cb03cdcdba0f">GANs from Scratch 1: A deep introduction. With code in PyTorch and TensorFlow</a></li>
<li><a href="https://ondrejtexler.github.io/patch-based_training/">Interactive Video Stylization Using Few-Shot Patch-Based Training</a></li>
<li><a href="https://wandb.ai/cayush/pytorchlightning/reports/Use-Pytorch-Lightning-with-Weights-Biases--Vmlldzo2NjQ1Mw">Use Pytorch Lightning with Weights &amp; Biases</a></li>
<li><a href="https://phillipi.github.io/pix2pix/">Image-to-Image Translation with Conditional Adversarial Nets</a></li>
</ul>
<h2 id="courses"><a class="header" href="#courses">courses</a></h2>
<ul>
<li><a href="https://lightning.ai/courses/deep-learning-fundamentals/">https://lightning.ai/courses/deep-learning-fundamentals/</a></li>
</ul>
<h2 id="stable-diffusion"><a class="header" href="#stable-diffusion">stable diffusion</a></h2>
<ul>
<li>Original SD paper -- <a href="https://arxiv.org/abs/2112.10752">High-Resolution Image Synthesis with Latent Diffusion Models</a></li>
<li>ControlNet paper -- <a href="https://arxiv.org/abs/2302.05543">Adding Conditional Control to Text-to-Image Diffusion Models</a></li>
<li>SDXL paper -- <a href="https://arxiv.org/abs/2307.01952">SDXL: Improving Latent Diffusion Models for High-Resolution Image Synthesis</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="developing-3d-models"><a class="header" href="#developing-3d-models">Developing 3D models</a></h1>
<h2 id="3d-modelling"><a class="header" href="#3d-modelling">3d modelling</a></h2>
<ul>
<li><a href="https://dust3d.org/">dust3d</a></li>
<li><a href="https://youtu.be/MytN8t4guuM">https://youtu.be/MytN8t4guuM</a></li>
</ul>
<h2 id="3d-math"><a class="header" href="#3d-math">3d math</a></h2>
<ul>
<li><a href="https://www.cgal.org/">https://www.cgal.org/</a></li>
<li><a href="https://threejs.org/">https://threejs.org/</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cloth-simulation"><a class="header" href="#cloth-simulation">Cloth Simulation</a></h1>
<ul>
<li><a href="http://andrew.wang-hoyer.com/experiments/cloth/">http://andrew.wang-hoyer.com/experiments/cloth/</a></li>
<li><a href="https://github.com/ndrwhr/cloth-simulation">https://github.com/ndrwhr/cloth-simulation</a></li>
<li><a href="http://web.archive.org/web/20070610223835/http://www.teknikus.dk/tj/gdc2001.htm">http://web.archive.org/web/20070610223835/http://www.teknikus.dk/tj/gdc2001.htm</a></li>
<li><a href="https://en.wikipedia.org/wiki/Methods_of_computing_square_roots">https://en.wikipedia.org/wiki/Methods_of_computing_square_roots</a></li>
<li><a href="https://github.com/ThomasLengeling/traerphysics">https://github.com/ThomasLengeling/traerphysics</a></li>
<li><a href="https://github.com/bitcraftlab/traer-physics">https://github.com/bitcraftlab/traer-physics</a></li>
<li><a href="http://jrc313.com/projects/processing/cloth/index.html">http://jrc313.com/projects/processing/cloth/index.html</a></li>
<li><a href="https://www.processing.org/">https://www.processing.org/</a></li>
<li><a href="https://github.com/schteppe/p2.js/">https://github.com/schteppe/p2.js/</a></li>
<li><a href="https://youtu.be/gqdXsw_Q_as">https://youtu.be/gqdXsw_Q_as</a> playlist <a href="https://www.youtube.com/playlist?list=PL9_jI1bdZmz2emSh0UQ5iOdT2xRHFHL7E">https://www.youtube.com/playlist?list=PL9_jI1bdZmz2emSh0UQ5iOdT2xRHFHL7E</a></li>
<li><a href="http://web.archive.org/web/20070609220647/http://www.cs.cmu.edu/~baraff/sigcourse/index.html">http://web.archive.org/web/20070609220647/http://www.cs.cmu.edu/~baraff/sigcourse/index.html</a> or <a href="https://www.cs.cmu.edu/~baraff/sigcourse/">https://www.cs.cmu.edu/~baraff/sigcourse/</a></li>
</ul>
<p><code>processing</code> source code for cloth sim,</p>
<pre><code class="language-cpp">import traer.physics.*;

ParticleSystem physics;

Particle[][] particles;
Particle[] anchors;
Particle anchor;

int screenWidth = 400;
int screenHeight = 400;

int gridSize = 10;
float springStrength = 1.0;
float springDamping = 0.1;
float particleMass = 0.1;
float physicsStep = 0.2;
float bounce = 0.8;

float xBoundsMin = 10.0;
float xBoundsMax = screenWidth - 10.0;
float yBoundsMin = 10.0;
float yBoundsMax = screenHeight - 10.0;

void setup()
{
    size(screenWidth, screenHeight);
    smooth();
    fill(0);
    framerate(60);

    physics = new ParticleSystem(0.2, 0.005);

    particles = new Particle[gridSize][gridSize];

    float gridStepX = (float) ((width / 2) / gridSize);
    float gridStepY = (float) ((height / 2) / gridSize);

    for (int i = 0; i &lt; gridSize; i++)
    {
        for (int j = 0; j &lt; gridSize; j++)
        {
            particles[i][j] = physics.makeParticle(0.1, j * gridStepX + (width / 4), i * gridStepY + 20, 0.0);
            if (j &gt; 0)
            {
                Particle p1 = particles[i][j - 1];
                Particle p2 = particles[i][j];
                physics.makeSpring(p1, p2, springStrength, springDamping, gridStepY);
            }
            if (i &gt; 0)
            {
                Particle p1 = particles[i - 1][j];
                Particle p2 = particles[i][j];
                physics.makeSpring(p1, p2, springStrength, springDamping, gridStepY);
            }
        }
    }

    particles[0][0].makeFixed();
    particles[0][gridSize - 1].makeFixed();

    anchors = new Particle[4];
    anchors[0] = particles[0][0];
    anchors[1] = particles[0][gridSize - 1];
    anchors[2] = particles[gridSize - 1][0];
    anchors[3] = particles[gridSize - 1][gridSize - 1];
}

void draw()
{
    physics.advanceTime(physicsStep);

    if (mousePressed)
    {
        anchor.moveTo(mouseX, mouseY, 0);
        anchor.velocity().clear();
    }

    background(255);

    for (int i = 0; i &lt; gridSize; i++)
    {
        for (int j = 0; j &lt; gridSize; j++)
        {
            Particle p = particles[i][j];
            float px = p.position().x();
            float py = p.position().y();
            float vx = p.velocity().x();
            float vy = p.velocity().y();

            if (px &lt; xBoundsMin)
            {
                vx *= -bounce;
                p.moveTo(xBoundsMin, py, 0);
                p.setVelocity(vx, vy, 0);
            }
            else if (px &gt; xBoundsMax)
            {
                vx *= -bounce;
                p.moveTo(xBoundsMax, py, 0);
                p.setVelocity(vx, vy, 0);
            }
            if (py &lt; yBoundsMin)
            {
                vy *= -bounce;
                p.moveTo(px, yBoundsMin, 0);
                p.setVelocity(vx, vy, 0);
            }
            else if (py &gt; yBoundsMax)
            {
                vy *= -bounce;
                p.moveTo(px, yBoundsMax, 0);
                p.setVelocity(vx, vy, 0);
            }
        }
    }

    for (int i = 0; i &lt; gridSize; i++)
    {
        beginShape( LINE_STRIP );
        curveVertex(particles[i][0].position().x(), particles[i][0].position().y());
        for (int j = 0; j &lt; gridSize; j++)
        {
            curveVertex(particles[i][j].position().x(), particles[i][j].position().y());
        }
        curveVertex(particles[i][gridSize - 1].position().x(), particles[i][gridSize - 1].position().y());
        endShape();
    }
    for (int j = 0; j &lt; gridSize; j++)
    {
        beginShape( LINE_STRIP );
        curveVertex(particles[0][j].position().x(), particles[0][j].position().y());
        for (int i = 0; i &lt; gridSize; i++)
        {
            curveVertex(particles[i][j].position().x(), particles[i][j].position().y());
        }
        curveVertex(particles[gridSize - 1][j].position().x(), particles[gridSize - 1][j].position().y());
        endShape();
    }

}

void mousePressed()
{
    int mx = mouseX;
    int my = mouseY;
    float d = -1.0;

    for (int i = 0; i &lt; gridSize; i++)
    {
        for (int j = 0; j &lt; gridSize; j++)
        {
            float dTemp = distance(mx, my, particles[i][j].position().x(), particles[i][j].position().y());
            if (dTemp &lt; d || d &lt; 0)
            {
                d = dTemp;
                anchor = particles[i][j];
            }
        }
    }
}

void mouseReleased()
{
    if (keyPressed)
    {
        if (key == ' ')
        {
            anchor.makeFixed();
        }
    }
    else
    {
        anchor.makeFree();
    }
    anchor = null;
}

float distance(float x1, float y1, float x2, float y2)
{
    float dx = x2 - x1;
    float dy = y2 - y1;
    return sqrt((dx * dx) + (dy * dy));
}


</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="audio-processing"><a class="header" href="#audio-processing">Audio Processing</a></h1>
<h2 id="dsp"><a class="header" href="#dsp">DSP</a></h2>
<ul>
<li><a href="http://www.dspguide.com/">The Scientist and Engineer's Guide to Digital Signal Processing</a></li>
<li><a href="https://faust.grame.fr/">Faust (Functional Audio Stream) programming language</a></li>
</ul>
<h2 id="vst3-with-mingw"><a class="header" href="#vst3-with-mingw">vst3 with MINGW</a></h2>
<ul>
<li><a href="https://forum.juce.com/t/is-vst3-sdk-compatible-with-mingw/12385">https://forum.juce.com/t/is-vst3-sdk-compatible-with-mingw/12385</a></li>
<li><a href="http://kxstudio.sourceforge.net/Paste/repo/GMOVw">http://kxstudio.sourceforge.net/Paste/repo/GMOVw</a></li>
<li><a href="https://github.com/steinbergmedia/vst3sdk/issues/8">https://github.com/steinbergmedia/vst3sdk/issues/8</a></li>
<li><a href="http://www.martin-finke.de/blog/tags/making_audio_plugins.html">http://www.martin-finke.de/blog/tags/making_audio_plugins.html</a></li>
<li><a href="https://ccrma.stanford.edu/~jos/fp/Generating_VST_Plugin_Faust.html">Generating a VST Plugin via Faust</a>.</li>
<li><a href="https://cycling74.com/">MAX</a>.</li>
<li><a href="https://juce.com/">https://juce.com/</a></li>
</ul>
<h2 id="vst-framework"><a class="header" href="#vst-framework">VST framework</a></h2>
<ul>
<li><a href="https://github.com/DISTRHO/DPF">https://github.com/DISTRHO/DPF</a></li>
</ul>
<h2 id="open-source-synths"><a class="header" href="#open-source-synths">open source synths</a></h2>
<ul>
<li><a href="https://github.com/TheWaveWarden/odin2">https://github.com/TheWaveWarden/odin2</a></li>
<li><a href="https://github.com/zynaddsubfx/zynaddsubfx">https://github.com/zynaddsubfx/zynaddsubfx</a></li>
</ul>
<h2 id="reason-livestreams"><a class="header" href="#reason-livestreams">reason livestreams</a></h2>
<ul>
<li><a href="https://www.reasonstudios.com/blog/reason-livestream">https://www.reasonstudios.com/blog/reason-livestream</a></li>
</ul>
<h2 id="physical-synthesis-libraries-papers"><a class="header" href="#physical-synthesis-libraries-papers">physical synthesis libraries/ papers</a></h2>
<ul>
<li><a href="https://github.com/thestk/stk">https://github.com/thestk/stk</a> Perry R. Cook and Gary P. Scavone.</li>
<li><a href="https://ccrma.stanford.edu/~jos/jnmr/jnmr.pdf">https://ccrma.stanford.edu/~jos/jnmr/jnmr.pdf</a></li>
<li><a href="https://ccrma.stanford.edu/~jos/wgj/wgj.pdf">https://ccrma.stanford.edu/~jos/wgj/wgj.pdf</a></li>
<li><a href="https://www.osar.fr/notes/waveguides/">https://www.osar.fr/notes/waveguides/</a></li>
<li><a href="https://ccrma.stanford.edu/~jos/wg.html">https://ccrma.stanford.edu/~jos/wg.html</a></li>
<li><a href="https://ccrma.stanford.edu/~jos/pasp/pasp.html">https://ccrma.stanford.edu/~jos/pasp/pasp.html</a></li>
<li><a href="https://github.com/mi-creative/mi-gen">https://github.com/mi-creative/mi-gen</a></li>
<li><a href="https://github.com/mi-creative/miPhysics_Processing">https://github.com/mi-creative/miPhysics_Processing</a></li>
<li><a href="https://youtu.be/sxt5rxF_PdI">Martin Shuppius - Physical modelling of guitar strings (ADC'17)</a></li>
<li><a href="https://drive.google.com/drive/folders/1URgFdMjBttXfwUdbf_C2p-XacsSe6hEQ?usp=sharing">Some pdf papers</a></li>
</ul>
<h2 id="audiomidi-interface-libraries"><a class="header" href="#audiomidi-interface-libraries">audio/midi interface libraries</a></h2>
<ul>
<li><a href="https://wiki.linuxaudio.org/wiki/programming_libraries">https://wiki.linuxaudio.org/wiki/programming_libraries</a></li>
<li><a href="http://www.portaudio.com/">http://www.portaudio.com/</a>. Audacity uses this.</li>
<li><a href="https://github.com/AuLib/AuLib">https://github.com/AuLib/AuLib</a></li>
</ul>
<h2 id="daw-golang-in-audio"><a class="header" href="#daw-golang-in-audio">DAW golang in audio</a></h2>
<ul>
<li><a href="https://github.com/dskinner/snd">https://github.com/dskinner/snd</a></li>
</ul>
<h2 id="headless-daw"><a class="header" href="#headless-daw">headless DAW</a></h2>
<ul>
<li><a href="https://github.com/hq9000/py_headless_daw">https://github.com/hq9000/py_headless_daw</a></li>
</ul>
<h2 id="hls-audio-streaming"><a class="header" href="#hls-audio-streaming">HLS audio streaming</a></h2>
<pre><code>ffmpeg -i song1.mp3 -map 0 -map 0 -c:a aac -b:a:0 320k -b:a:1 128k -var_stream_map "a:0,name:320k a:1,name:128k" -master_pl_name song1_manifest.m3u8 -f hls -hls_flags single_file -hls_playlist_type vod -hls_segment_filename "song1_%v/classroom.ts" song1_%v/index.m3u8
</code></pre>
<h1 id="speaker-frequency-response"><a class="header" href="#speaker-frequency-response">speaker frequency response</a></h1>
<ul>
<li><a href="https://blog.audiokinetic.com/en/loudness-and-frequency-response-on-popular-smart-phones/">https://blog.audiokinetic.com/en/loudness-and-frequency-response-on-popular-smart-phones/</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="understanding-soundfont-synthesis"><a class="header" href="#understanding-soundfont-synthesis">Understanding Soundfont Synthesis</a></h1>
<p>I took RustySynth as an example from github <a href="https://github.com/sinshu/rustysynth">https://github.com/sinshu/rustysynth</a>, which is written in <code>rust</code>.</p>
<p>Below is an overview of how the various pieces of RustySynth fit together—both
in terms of “who depends on whom” (module/dependency structure) and in terms of
the main runtime call‐hierarchy (what calls what at runtime).</p>
<hr />
<h2 id="1-high-level-cargoworkspace-layout"><a class="header" href="#1-high-level-cargoworkspace-layout">1. High-Level Cargo/Workspace Layout</a></h2>
<p>At the top level, the repository has three main sub-directories (workspace members):</p>
<ul>
<li>
<p><strong><code>rustysynth/</code></strong>
The core synthesizer library (this is where all of the SoundFont parsing, voice management, sample generation, and effects live).</p>
</li>
<li>
<p><strong><code>rustysynth_test/</code></strong>
A small crate for running unit/integration tests against the core library.</p>
</li>
<li>
<p><strong><code>example/</code></strong>
One or more example programs (showing how to load a SoundFont, create a <code>Synthesizer</code>, play a MIDI file, etc.).</p>
</li>
</ul>
<p>For our purposes, everything we care about is in <code>rustysynth/src/</code>. Below is a
rough sketch of the files you’ll find there (names taken from docs.rs and a
GitHub directory listing) :</p>
<pre><code>rustysynth/
├─ Cargo.toml
└─ src/
   ├─ error.rs
   ├─ midi_file.rs
   ├─ midi_file_sequencer.rs
   ├─ sound_font.rs
   ├─ synthesizer_settings.rs
   ├─ synthesizer.rs
   ├─ voice.rs
   ├─ oscillator.rs
   ├─ envelope.rs
   ├─ comb_filter.rs
   ├─ all_pass_filter.rs
   ├─ reverb.rs
   ├─ chorus.rs
   └─ … (possibly a few small helpers, but these are the main pieces)
</code></pre>
<p>Each of the <code>.rs</code> files corresponds to a <code>mod</code> in <code>lib.rs</code>, and together they
form the library’s public/exported API (plus internal helpers).</p>
<hr />
<h2 id="2-moduledependency-structure"><a class="header" href="#2-moduledependency-structure">2. Module/Dependency Structure</a></h2>
<p>Below is a simplified “dependency graph” of modules—i.e. which <code>mod</code> files refer
to which other modules. Arrows (→) mean “depends on / uses functionality from.”</p>
<pre><code> ┌─────────────────┐
 │   error.rs      │   ←── defines `MidiFileError`, `SoundFontError`, `SynthesizerError` 
 └─────────────────┘
          ▲
          │
 ┌─────────────────┐
 │   sound_font.rs │  ←── uses `error::SoundFontError`, plus low‐level I/O traits (`Read`, `Seek`)
 └─────────────────┘
          ▲
          │
 ┌────────────────────────────┐
 │   midi_file.rs             │  ←── uses `error::MidiFileError`
 └────────────────────────────┘
          ▲
          │
 ┌──────────────────────────────────────┐
 │   midi_file_sequencer.rs             │  ←── uses `MidiFile` (from midi_file.rs)  
 │                                      |      and `Synthesizer` (from synthesizer.rs)  
 └──────────────────────────────────────┘
          ▲
          │
 ┌──────────────────────────────┐
 │  synthesizer_settings.rs     │  ←── trivial: only holds numeric fields (sample_rate, block_size, max_polyphony)  
 └──────────────────────────────┘
          ▲
          │
 ┌──────────────────────────────┐
 │   synthesizer.rs             │  ←── uses:  
 │                              │        • `SynthesizerSettings`  
 │                              │        • `SoundFont`  
 │                              │        • `Voice` (from voice.rs)  
 │                              │        • DSP buffers (Vec&lt;f32&gt;)  
 │                              │        • Effects (`Reverb`, `Chorus`)  
 └──────────────────────────────┘
          ▲
          │
 ┌──────────────────────────────┐
 │   voice.rs                   │  ←── uses:  
 │                              │        • `Oscillator` (from oscillator.rs)  
 │                              │        • `Envelope` (from envelope.rs)  
 │                              │        • `CombFilter`, `AllPassFilter` (from their own modules)  
 └──────────────────────────────┘
          ▲
          │
 ┌──────────────────────────────┐
 │   oscillator.rs              │  (no dependencies except `std::f32::consts::PI`)  
 └──────────────────────────────┘

 ┌──────────────────────────────┐
 │   envelope.rs                │  (no dependencies beyond basic math)  
 └──────────────────────────────┘

 ┌──────────────────────────────┐
 │   comb_filter.rs             │  (no external dependencies—just a buffer and feedback logic)  
 └──────────────────────────────┘

 ┌──────────────────────────────┐
 │   all_pass_filter.rs         │  (stateless/all-pass filter logic only)  
 └──────────────────────────────┘

 ┌──────────────────────────────┐
 │   reverb.rs                  │  ←── uses `CombFilter` and `AllPassFilter`  
 └──────────────────────────────┘

 ┌──────────────────────────────┐
 │   chorus.rs                  │  (similar: uses one or more LFOs + delay lines; no other cross‐deps)  
 └──────────────────────────────┘
</code></pre>
<ul>
<li>
<p><strong><code>error.rs</code></strong> defines the crate’s error types (<code>MidiFileError</code>, <code>SoundFontError</code>, <code>SynthesizerError</code>). Other modules simply import these via <code>pub use error::…;</code>.</p>
</li>
<li>
<p><strong><code>sound_font.rs</code></strong> is responsible for parsing an SF2 file (<code>SoundFont::new(...)</code>) and exposing types like <code>Preset</code>, <code>SampleHeader</code>, etc. It only depends on I/O traits (<code>Read</code>, <code>Seek</code>) and <code>error::SoundFontError</code>.</p>
</li>
<li>
<p><strong><code>midi_file.rs</code></strong> parses a standard MIDI file and exposes <code>MidiFile</code> and its associated data structures (tracks, events). It depends on <code>error::MidiFileError</code>.</p>
</li>
<li>
<p><strong><code>midi_file_sequencer.rs</code></strong> drives playback of a <code>MidiFile</code> through a <code>Synthesizer</code>. Internally, it calls methods on <code>Synthesizer</code> (e.g. <code>note_on</code>, <code>note_off</code>, <code>render</code>).</p>
</li>
<li>
<p><strong><code>synthesizer_settings.rs</code></strong> is trivial—just a small struct holding <code>sample_rate</code>, <code>block_size</code>, <code>maximum_polyphony</code>.</p>
</li>
<li>
<p><strong><code>synthesizer.rs</code></strong> is the heart of the real-time (or block‐based) engine. It:</p>
<ol>
<li>
<p>Holds an <code>Arc&lt;SoundFont&gt;</code> (so multiple threads can share the same SoundFont safely).</p>
</li>
<li>
<p>Keeps a <code>Vec&lt;Voice&gt;</code> (one slot per possible voice).</p>
</li>
<li>
<p>Keeps per-channel state (<code>channels: Vec&lt;ChannelState&gt;</code>).</p>
</li>
<li>
<p>Manages effect units (<code>Reverb</code>, <code>Chorus</code>).</p>
</li>
<li>
<p>Exposes methods like</p>
<ul>
<li><code>fn new(sound_font: &amp;Arc&lt;SoundFont&gt;, settings: &amp;SynthesizerSettings) -&gt; Result&lt;Self, SynthesizerError&gt;</code></li>
<li><code>fn note_on(&amp;mut self, channel: u8, key: u8, velocity: u8)</code></li>
<li><code>fn note_off(&amp;mut self, channel: u8, key: u8, velocity: u8)</code></li>
<li><code>fn render(&amp;mut self, left: &amp;mut [f32], right: &amp;mut [f32])</code></li>
</ul>
</li>
</ol>
</li>
<li>
<p><strong><code>voice.rs</code></strong> represents a single active note (“voice”). Each voice holds:</p>
<ol>
<li>An <code>Oscillator</code> (for waveform generation).</li>
<li>An <code>Envelope</code> (for ADSR or similar amplitude shaping).</li>
<li>A small bank of <code>CombFilter</code>s and <code>AllPassFilter</code>s (for per-voice filtering).</li>
<li>A reference to the <code>SampleHeader</code> (so it knows which PCM data to read).</li>
<li>Methods like <code>fn new(…)</code> to create a voice from a given <code>InstrumentRegion</code> or <code>PresetRegion</code>, and <code>fn process_block(&amp;mut self, left: &amp;mut [f32], right: &amp;mut [f32])</code> to generate its output into the provided audio block.</li>
</ol>
</li>
<li>
<p><strong><code>oscillator.rs</code></strong> implements low-level math for, e.g., generating a sine wave, a square wave, or reading a PCM sample from memory. It does not depend on any other module except <code>std::f32::consts</code>.</p>
</li>
<li>
<p><strong><code>envelope.rs</code></strong> implements standard envelope generators (ADSR). No cross-deps.</p>
</li>
<li>
<p><strong><code>comb_filter.rs</code></strong> and <strong><code>all_pass_filter.rs</code></strong> implement the two basic filter types used both in each voice (for “filter per voice”) and inside the main reverb unit (for “global reverb”).</p>
</li>
<li>
<p><strong><code>reverb.rs</code></strong> builds on <code>CombFilter</code> + <code>AllPassFilter</code> to implement a stereo reverb effect.</p>
</li>
<li>
<p><strong><code>chorus.rs</code></strong> implements a stereo chorus effect (no further dependencies).</p>
</li>
<li>
<p>Finally, <strong><code>lib.rs</code></strong> has lines like:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>mod error;
mod sound_font;
mod midi_file;
mod midi_file_sequencer;
mod synthesizer_settings;
mod synthesizer;
mod voice;
mod oscillator;
mod envelope;
mod comb_filter;
mod all_pass_filter;
mod reverb;
mod chorus;

pub use error::{MidiFileError, SoundFontError, SynthesizerError};
pub use sound_font::SoundFont;
pub use midi_file::{MidiFile, MidiEvent};
pub use midi_file_sequencer::MidiFileSequencer;
pub use synthesizer_settings::SynthesizerSettings;
pub use synthesizer::Synthesizer;
<span class="boring">}</span></code></pre></pre>
<p>so that downstream users can write:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use rustysynth::SoundFont;
use rustysynth::Synthesizer;
use rustysynth::MidiFile;
use rustysynth::MidiFileSequencer;
<span class="boring">}</span></code></pre></pre>
<p>without needing to know the internal module structure.</p>
</li>
</ul>
<hr />
<h2 id="3-runtime-call-hierarchy-what-happens-when-you-synthesize"><a class="header" href="#3-runtime-call-hierarchy-what-happens-when-you-synthesize">3. Runtime Call-Hierarchy (What Happens When You Synthesize)</a></h2>
<p>Below is the typical sequence of calls, from loading a SoundFont to generating
audio. You can think of this as a “dynamic call graph” that shows how, at
runtime, each component invokes the next.</p>
<pre><code>(1) User code: 
      let mut sf2_file = File::open("SomeSoundFont.sf2")?;
      let sound_font = Arc::new(SoundFont::new(&amp;mut sf2_file)?);
      let settings = SynthesizerSettings::new(44100);
      let mut synth = Synthesizer::new(&amp;sound_font, &amp;settings)?;

  └──▶ SoundFont::new(...) parses the SF2 file, building:
         • a list of Presets
         • for each Preset, a Vec&lt;PresetRegion&gt;
         • each PresetRegion refers to one or more InstrumentRegion
         • each InstrumentRegion points to SampleHeader and bank parameters
         • (Internally, sound_font.rs may also build a “preset_lookup” table, etc.)

(2) User code (optional): 
      // If you want to play a standalone MIDI file:
      let mut midi_file = File::open("SomeSong.mid")?;
      let midi = Arc::new(MidiFile::new(&amp;mut midi_file)?);
      let mut sequencer = MidiFileSequencer::new(synth);

  └──▶ MidiFile::new(...) parses all tracks, tempo maps, events (note on/off, CC, etc.)

  └──▶ MidiFileSequencer::new(...) stores the `Synthesizer` inside itself (by move or by value).

(3) User code: 
      // In a real‐time context, you might spawn an audio thread that repeatedly does:
      //    loop {
      //      sequencer.render(&amp;mut left_buf, &amp;mut right_buf);
      //      send to audio output device
      //    }
      // In an offline context:
      sequencer.play(&amp;midi, /* loop = false */);
      let total_samples = (settings.sample_rate as f64 * midi.get_length()) as usize;
      let mut left  = vec![0.0_f32; total_samples];
      let mut right = vec![0.0_f32; total_samples];
      sequencer.render(&amp;mut left[..], &amp;mut right[..]);

  └──▶ MidiFileSequencer::play(...)  // sets an internal “start_time = 0” or similar

  └──▶ MidiFileSequencer::render(left, right):
        ├── updates internal “current_timestamp” based on block size or realtime clock  
        ├── calls `Synthesizer::note_on/off(...)` for any MIDI events whose timestamps fall in this block  
        └── calls `Synthesizer::render(left, right)`

(4) Synthesizer::note_on(channel, key, velocity):
        ├── Look up which **PresetRegion** should respond (based on channel’s current bank/program).  
        ├── For that PresetRegion, find the matching **InstrumentRegion**(s) for that key &amp; velocity.  
        ├── For each matching InstrumentRegion:
        │     ├── Find a free voice slot (`self.voices[i]` where `i &lt; maximum_polyphony` and voice isn’t already in use).  
        │     ├── Call `Voice::new( instrument_region, sample_rate )` to create a brand-new `Voice` struct.  
        │     ├── Initialize that voice’s fields (oscillator frequencies, envelope ADSR parameters, filter coefficients, etc.).  
        │     └── Store the new `Voice` (or a handle to it) in `self.voices[i]`.  
        └── Return, now that voice is “active.”

(5) Synthesizer::note_off(channel, key, velocity):
        ├── Search through `self.voices` for any voice whose channel/key match this note.  
        ├── For each such voice, call `voice.note_off()` (which typically sets the envelope into its “release” stage).  
        └── Return (voice remains “active” until its envelope fully dies out, at which point Synthesizer may garbage-collect it next block).

(6) Synthesizer::render(left: &amp;mut [f32], right: &amp;mut [f32]):
        ├── Zero out `left[]` and `right[]` for this block.  
        ├── For each active `voice` in `self.voices`:
        │     └── Call `voice.process_block(&amp;mut voice_buf_l, &amp;mut voice_buf_r)`.  
        │           • Inside `Voice::process_block(...)`:  
        │             ├── For each sample index `n` in the block:  
        │             │     ├── `osc_sample = self.oscillator.next_sample()`  
        │             │     ├── `amp_envelope = self.envelope.next_amplitude()`  
        │             │     └── `mixed = osc_sample * amp_envelope`  
        │             │           (optionally: apply per-voice LFO mod, filters, etc.)  
        │             │  
        │             ├── Once the raw waveform is generated, run it through per-voice filters:  
        │             │     • e.g. `comb_out = comb_filter.process(mixed)`  
        │             │     • e.g. `all_pass_out = all_pass_filter.process(comb_out)`  
        │             │     • …repeat for each filter in `self.comb_filters` and `self.all_pass_filters`.  
        │             └── Write the final result into `voice_buf_l[n]` and/or `voice_buf_r[n]`.  
        ├── Accumulate each voice’s output into the master block:  
        │     • `left[n]  += voice_buf_l[n]`  
        │     • `right[n] += voice_buf_r[n]`  
        ├── Once all voices have contributed, apply **global effects** in this order (by default):  
        │     1. `self.reverb.process(&amp;mut left, &amp;mut right)`  
        │     2. `self.chorus.process(&amp;mut left, &amp;mut right)`  
        ├── Multiply each sample in `left[]` and `right[]` by `self.master_volume`.  
        └── Return from `render(…)`—the caller (sequencer or user code) now has a filled audio buffer.

</code></pre>
<h2 id="4-summary-of-who-calls-whom"><a class="header" href="#4-summary-of-who-calls-whom">4. Summary of “Who Calls Whom”</a></h2>
<p>Below is a compact list of “call edges” at runtime, annotated with which module implements which function:</p>
<ol>
<li>
<p><strong>User → <code>SoundFont::new(&amp;mut R: Read + Seek) : Result&lt;SoundFont, SoundFontError&gt;</code></strong><br />
(in <code>sound_font.rs</code>)</p>
</li>
<li>
<p><strong>User → <code>MidiFile::new(&amp;mut R: Read + Seek) : Result&lt;MidiFile, MidiFileError&gt;</code></strong><br />
(in <code>midi_file.rs</code>)</p>
</li>
<li>
<p><strong>User → <code>Synthesizer::new(&amp;Arc&lt;SoundFont&gt;, &amp;SynthesizerSettings) : Result&lt;Synthesizer, SynthesizerError&gt;</code></strong><br />
(in <code>synthesizer.rs</code>)<br />
• inside this constructor, it calls:<br />
  – <code>preset_lookup = SoundFont::build_preset_lookup()</code> (in <code>sound_font.rs</code>)<br />
  – allocates <code>Vec&lt;Voice&gt;</code> slots (initially all “inactive”)<br />
  – constructs <code>Vec&lt;ChannelState&gt;</code> for 16 MIDI channels<br />
  – creates <code>Reverb::new(sample_rate)</code> (in <code>reverb.rs</code>) and <code>Chorus::new(sample_rate)</code> (in <code>chorus.rs</code>)<br />
  – stores <code>block_left = Vec::with_capacity(block_size)</code>, <code>block_right = Vec::with_capacity(block_size)</code>, etc.</p>
</li>
<li>
<p><strong>User → <code>MidiFileSequencer::new(synth: Synthesizer) : MidiFileSequencer</code></strong><br />
(in <code>midi_file_sequencer.rs</code>)<br />
• stores <code>synth</code> internally, sets internal “cursor = 0,” no audio generated yet.</p>
</li>
<li>
<p><strong>User → <code>MidiFileSequencer::play(&amp;MidiFile, loop_flag: bool)</code></strong><br />
(in <code>midi_file_sequencer.rs</code>)<br />
• resets time to zero, sets up internal event iterator from the <code>MidiFile</code>.</p>
</li>
<li>
<p><strong>Caller (sequencer or user) → <code>MidiFileSequencer::render(left, right)</code></strong><br />
(in <code>midi_file_sequencer.rs</code>)<br />
• computes which MIDI events fall into this block’s timestamp range, and for each event:<br />
  – If <code>NoteOn</code>, calls <code>synth.note_on(channel, key, velocity)</code>.<br />
  – If <code>NoteOff</code>, calls <code>synth.note_off(channel, key, velocity)</code>.<br />
• after processing all events, calls <code>synth.render(left, right)</code>.</p>
</li>
<li>
<p><strong>Sequencer → <code>Synthesizer::note_on(channel, key, velocity)</code></strong><br />
(in <code>synthesizer.rs</code>)<br />
• looks up the appropriate <code>PresetRegion</code> via a hash map built at construction.<br />
• calls <code>Voice::new( preset_region, sample_rate )</code><br />
• stores that <code>Voice</code> in the first free slot of <code>self.voices</code>.</p>
</li>
<li>
<p><strong>Sequencer → <code>Synthesizer::note_off(channel, key, velocity)</code></strong><br />
(in <code>synthesizer.rs</code>)<br />
• finds matching voice(s), calls <code>voice.note_off()</code>. (Voice will enter its release phase.)</p>
</li>
<li>
<p><strong>Sequencer or user → <code>Synthesizer::render(left, right)</code></strong><br />
(in <code>synthesizer.rs</code>)<br />
• zeroes out both <code>left</code> and <code>right</code> buffers.<br />
• loops over every active <code>Voice</code> in <code>self.voices</code> and calls <code>voice.process_block(voice_buf_l, voice_buf_r)</code>.<br />
• inside each <code>voice.process_block(...)</code> (in <code>voice.rs</code>):<br />
  – calls <code>Oscillator::next_sample()</code> repeatedly (in <code>oscillator.rs</code>).<br />
  – calls <code>Envelope::next_amplitude()</code> for amplitude shaping (in <code>envelope.rs</code>).<br />
  – sends the raw sample through each <code>CombFilter::process(sample)</code> (in <code>comb_filter.rs</code>).<br />
  – then through each <code>AllPassFilter::process(sample)</code> (in <code>all_pass_filter.rs</code>).<br />
  – writes the final per-voice sample into <code>voice_buf_l[n]</code> and <code>voice_buf_r[n]</code>.<br />
• the synth accumulates each <code>voice_buf_l</code>/<code>voice_buf_r</code> into the master <code>left</code>/<code>right</code> block.<br />
• after all voices are done, calls:<br />
  – <code>Reverb::process(left, right)</code> (in <code>reverb.rs</code>), which internally runs a bank of <code>CombFilter</code>s and <code>AllPassFilter</code>s to produce a stereo reverb tail.<br />
  – <code>Chorus::process(left, right)</code> (in <code>chorus.rs</code>), which applies a short, modulated delay to thicken the sound.<br />
  – scales <code>left[]</code> and <code>right[]</code> by <code>self.master_volume</code>.<br />
• returns.</p>
</li>
</ol>
<hr />
<h2 id="5-who-depends-on-whom-recap"><a class="header" href="#5-who-depends-on-whom-recap">5. “Who Depends on Whom” Recap</a></h2>
<p>Below is a summary list of the modules (in descending dependency order), reiterating what we already sketched above:</p>
<ol>
<li>
<p><strong><code>error.rs</code></strong></p>
<ul>
<li>Defines <code>MidiFileError</code>, <code>SoundFontError</code>, <code>SynthesizerError</code>.</li>
<li>No dependencies on other crate modules (beyond core/std).</li>
</ul>
</li>
<li>
<p><strong><code>sound_font.rs</code></strong></p>
<ul>
<li>Depends on <code>error::SoundFontError</code> and <code>std::io::{Read, Seek}</code>.</li>
<li>Exposes types like <code>SoundFont</code>, <code>Preset</code>, <code>InstrumentRegion</code>, <code>SampleHeader</code>.</li>
</ul>
</li>
<li>
<p><strong><code>midi_file.rs</code></strong></p>
<ul>
<li>Depends on <code>error::MidiFileError</code> and core I/O traits.</li>
<li>Exposes <code>MidiFile</code>, <code>MidiEvent</code>, etc.</li>
</ul>
</li>
<li>
<p><strong><code>midi_file_sequencer.rs</code></strong></p>
<ul>
<li>Depends on <code>midi_file::MidiFile</code> + <code>MidiEvent</code>.</li>
<li>Depends on <code>synthesizer::Synthesizer</code> (calls its <code>note_on</code>, <code>note_off</code>, <code>render</code>).</li>
</ul>
</li>
<li>
<p><strong><code>synthesizer_settings.rs</code></strong></p>
<ul>
<li>No cross‐deps (just holds basic numeric fields).</li>
</ul>
</li>
<li>
<p><strong><code>synthesizer.rs</code></strong></p>
<ul>
<li>Depends on:
<ul>
<li><code>sound_font::SoundFont</code></li>
<li><code>synthesizer_settings::SynthesizerSettings</code></li>
<li><code>voice::Voice</code></li>
<li><code>reverb::Reverb</code></li>
<li><code>chorus::Chorus</code></li>
<li>Basic containers (<code>Vec</code>, <code>Arc</code>, etc.)</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong><code>voice.rs</code></strong></p>
<ul>
<li>Depends on:
<ul>
<li><code>oscillator::Oscillator</code></li>
<li><code>envelope::Envelope</code></li>
<li><code>comb_filter::CombFilter</code></li>
<li><code>all_pass_filter::AllPassFilter</code></li>
</ul>
</li>
<li>Also references some of the data structures from <code>sound_font</code> (e.g. the <code>SampleHeader</code> inside an <code>InstrumentRegion</code>).</li>
</ul>
</li>
<li>
<p><strong><code>oscillator.rs</code></strong>, <strong><code>envelope.rs</code></strong>, <strong><code>comb_filter.rs</code></strong>, <strong><code>all_pass_filter.rs</code></strong></p>
<ul>
<li>These are leaf modules. They do not depend on any other RustySynth module. They implement low-level DSP building blocks (waveform generation, ADSR envelopes, comb/all-pass filters).</li>
</ul>
</li>
<li>
<p><strong><code>reverb.rs</code></strong></p>
<ul>
<li>Depends on <code>comb_filter::CombFilter</code> and <code>all_pass_filter::AllPassFilter</code>.</li>
<li>Implements a stereo reverb by chaining eight comb filters + four all-pass filters per channel.</li>
</ul>
</li>
<li>
<p><strong><code>chorus.rs</code></strong></p>
<ul>
<li>Typically implements a simple stereo chorus (delay lines + LFO).</li>
<li>No further cross-deps (just basic numeric math).</li>
</ul>
</li>
</ol>
<hr />
<h2 id="6-putting-it-all-together"><a class="header" href="#6-putting-it-all-together">6. Putting It All Together</a></h2>
<ol>
<li>
<p><strong>Build-time/compile-time structure</strong></p>
<ul>
<li>At compile time, Cargo’s feature resolver v2 (see <code>resolver = "2"</code> in <code>Cargo.toml</code>) wires up all these modules into one library.</li>
<li>The <code>lib.rs</code> (in <code>rustysynth/src/lib.rs</code>) has lines like:
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>mod error;
mod sound_font;
mod midi_file;
mod midi_file_sequencer;
mod synthesizer_settings;
mod synthesizer;
mod voice;
mod oscillator;
mod envelope;
mod comb_filter;
mod all_pass_filter;
mod reverb;
mod chorus;

pub use error::{MidiFileError, SoundFontError, SynthesizerError};
pub use sound_font::SoundFont;
pub use midi_file::{MidiFile, MidiEvent};
pub use midi_file_sequencer::MidiFileSequencer;
pub use synthesizer_settings::SynthesizerSettings;
pub use synthesizer::Synthesizer;
<span class="boring">}</span></code></pre></pre>
</li>
<li>This exports exactly the high-level types a user needs:<br />
• <code>SoundFont</code> (plus associated errors)<br />
• <code>MidiFile</code> (plus associated errors)<br />
• <code>SynthesizerSettings</code><br />
• <code>Synthesizer</code> (and its methods: <code>note_on</code>, <code>note_off</code>, <code>render</code>)<br />
• <code>MidiFileSequencer</code> (and its methods: <code>play</code>, <code>render</code>)</li>
</ul>
</li>
<li>
<p><strong>Run-time call graph</strong></p>
<ul>
<li>The user first loads a SoundFont (calling into <code>sound_font::SoundFont::new(...)</code>).</li>
<li>Then they construct a <code>Synthesizer</code>, which in turn calls into <code>reverb::Reverb::new</code>, <code>chorus::Chorus::new</code>, and sets up the voice‐pool (<code>Vec&lt;Voice&gt;</code>) inside <code>voice.rs</code>.</li>
<li>Each time <code>note_on</code> is invoked, <code>synthesizer::Synthesizer</code> instantiates a <code>Voice</code> by calling <code>voice::Voice::new(...)</code>. That in turn calls constructors in <code>oscillator</code>, <code>envelope</code>, <code>comb_filter</code>, and <code>all_pass_filter</code>.</li>
<li>On every audio block, <code>Synthesizer::render</code> loops over voices and calls <code>Voice::process_block</code>, which in turn calls:
<ul>
<li><code>Oscillator::next_sample</code> (in <code>oscillator.rs</code>)</li>
<li><code>Envelope::next_amplitude</code> (in <code>envelope.rs</code>)</li>
<li><code>CombFilter::process</code> (in <code>comb_filter.rs</code>)</li>
<li><code>AllPassFilter::process</code> (in <code>all_pass_filter.rs</code>)</li>
</ul>
</li>
<li>The block of per-voice samples is summed into a master buffer, then handed to <code>Reverb::process</code> (in <code>reverb.rs</code>) and <code>Chorus::process</code> (in <code>chorus.rs</code>), and finally scaled by <code>master_volume</code>.</li>
</ul>
</li>
<li>
<p><strong>Sequencer integration</strong></p>
<ul>
<li>If the user wants to play a MIDI file, they first call <code>MidiFile::new(...)</code> (in <code>midi_file.rs</code>) to parse tracks/events.</li>
<li>They then create a <code>MidiFileSequencer</code> (in <code>midi_file_sequencer.rs</code>), passing in the <code>Synthesizer</code>.</li>
<li>Each time they call <code>sequencer.render(...)</code>, the sequencer:
<ol>
<li>Advances its internal time cursor by <code>block_size</code> samples.</li>
<li>Emits any scheduled <code>NoteOn</code>/<code>NoteOff</code> events via <code>Synthesizer::note_on/ note_off</code>.</li>
<li>Calls <code>Synthesizer::render(...)</code> to fill the next block of audio.</li>
</ol>
</li>
</ul>
</li>
</ol>
<hr />
<h3 id="in-a-nutshell"><a class="header" href="#in-a-nutshell">In a Nutshell</a></h3>
<ul>
<li><strong>“Structure dependency”</strong> (compile-time):</li>
</ul>
<pre><code>error.rs
↑
sound_font.rs       midi_file.rs
↑                    ↑
synthesizer_settings.rs
↑
synthesizer.rs ←─ voice.rs ←─ (oscillator.rs, envelope.rs, comb_filter.rs, all_pass_filter.rs)
↑                                     ↑
midi_file_sequencer.rs                └─ reverb.rs (also depends on comb &amp; all_pass)
└─ chorus.rs
</code></pre>
<ul>
<li><strong>“Call hierarchy”</strong> (run-time):</li>
</ul>
<ol>
<li>User → <code>SoundFont::new</code> (parses SF2)</li>
<li>User → <code>Synthesizer::new</code> (builds voice pool, effect units)</li>
<li>(Optional) User → <code>MidiFile::new</code> (parses MIDI file)</li>
<li>(Optional) User → <code>MidiFileSequencer::new(synth)</code></li>
<li>Each audio block →
<ul>
<li>Sequencer → <code>note_on</code>/<code>note_off</code> on <code>Synthesizer</code> for timed events</li>
<li>Sequencer (or user-thread) → <code>Synthesizer::render(left, right)</code><br />
• <code>Synthesizer::render</code> → calls each <code>Voice::process_block</code><br />
• <code>Voice::process_block</code> → <code>Oscillator::next_sample</code> → <code>Envelope::next_amplitude</code> → <code>CombFilter::process</code> → <code>AllPassFilter::process</code><br />
• After all voices are summed, <code>Synthesizer::render</code> → <code>Reverb::process</code> → <code>Chorus::process</code> → scale by master volume.</li>
</ul>
</li>
</ol>
<p>This should give you a clear picture of (a) how the modules depend on one another in the source tree, and (b) how, at run time, each call eventually fans out into the low-level DSP building blocks. We will explore any particular module more deeply—e.g. the exact algorithm inside <code>CombFilter::process</code> or how <code>PresetRegion</code> data flows into <code>Voice::new</code> next as needed.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="broadcasting"><a class="header" href="#broadcasting">Broadcasting</a></h1>
<h2 id="internet-broadcasting"><a class="header" href="#internet-broadcasting">Internet broadcasting</a></h2>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/Audio_and_video_delivery/Live_streaming_web_audio_and_video">Live streaming web audio and video</a></li>
<li><a href="https://www.sourcefabric.org/en/airtime/">https://www.sourcefabric.org/en/airtime/</a>, <a href="https://github.com/sourcefabric/airtime">https://github.com/sourcefabric/airtime</a>, <a href="http://sourcefabric.booktype.pro/airtime-25-for-broadcasters/what-is-airtime/">manual</a></li>
<li><a href="https://www.liquidsoap.info/">https://www.liquidsoap.info/</a>, <a href="https://youtu.be/GmMUuKyy6hY">tutorial</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="movie-production-tools"><a class="header" href="#movie-production-tools">Movie production tools</a></h1>
<h2 id="storyboarding"><a class="header" href="#storyboarding">Storyboarding</a></h2>
<ul>
<li>Krita</li>
<li>Opentoonz</li>
<li>Tahoma fork</li>
<li>Laidout</li>
<li>Gegl-qt binding</li>
<li><a href="https://github.com/imgflo/imgflo">https://github.com/imgflo/imgflo</a> ui for gegl</li>
<li><a href="https://youtu.be/FVpho_UiDAY">https://youtu.be/FVpho_UiDAY</a></li>
</ul>
<blockquote>
<p>We will have bunch of loose topics here, later to be organized.</p>
</blockquote>
<h3 id="notes-2"><a class="header" href="#notes-2">Notes</a></h3>
<p>initial storyboarding thoughts. I will use pyqt.... all the speed critical operation will be in qt and c++ world, python binding will be used on top of that.</p>
<p>prototyping will be easy???
other option is to build the whole thing in c++, qt
build the app in rust using qt-rust binding.
how do we incorporate,</p>
<ul>
<li>gegl ??</li>
<li>brush engine ??</li>
</ul>
<h2 id="sfx"><a class="header" href="#sfx">sfx</a></h2>
<ul>
<li><a href="https://youtu.be/RxD6H3ri8RI">https://youtu.be/RxD6H3ri8RI</a></li>
</ul>
<h2 id="pdf"><a class="header" href="#pdf">pdf</a></h2>
<ul>
<li><a href="https://github.com/foliojs/pdfkit">https://github.com/foliojs/pdfkit</a></li>
</ul>
<h2 id="fountain-tools"><a class="header" href="#fountain-tools">fountain tools</a></h2>
<ul>
<li><a href="https://github.com/ifrost/afterwriting-labs">https://github.com/ifrost/afterwriting-labs</a></li>
</ul>
<h2 id="3d-modelling-1"><a class="header" href="#3d-modelling-1">3d modelling</a></h2>
<ul>
<li><a href="https://dust3d.org/">dust3d</a></li>
<li><a href="https://youtu.be/MytN8t4guuM">https://youtu.be/MytN8t4guuM</a></li>
</ul>
<h2 id="color-grading"><a class="header" href="#color-grading">color grading</a></h2>
<ul>
<li><a href="https://youtu.be/Bo3BvhGdaUo">https://youtu.be/Bo3BvhGdaUo</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="animation"><a class="header" href="#animation">Animation</a></h1>
<h2 id="ai-generated-physics-based-animation"><a class="header" href="#ai-generated-physics-based-animation">AI generated physics based animation</a></h2>
<ul>
<li><a href="https://github.com/sebastianstarke/AI4Animation">https://github.com/sebastianstarke/AI4Animation</a></li>
<li><a href="https://cascadeur.com/">https://cascadeur.com/</a> Commercial tool</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="music"><a class="header" href="#music">Music</a></h1>
<h2 id="drum-patterns"><a class="header" href="#drum-patterns">Drum patterns</a></h2>
<ul>
<li><a href="https://cecm.indiana.edu/361/drumpatterns.html">https://cecm.indiana.edu/361/drumpatterns.html</a></li>
</ul>
<h2 id="rust-midi-library"><a class="header" href="#rust-midi-library">rust midi library</a></h2>
<ul>
<li><a href="https://docs.rs/midly/latest/midly/">https://docs.rs/midly/latest/midly/</a></li>
<li><a href="https://tauri.studio">https://tauri.studio</a></li>
<li><a href="https://crates.io/crates/serde_json">https://crates.io/crates/serde_json</a></li>
</ul>
<p>We can load midi file in a rust based tauri app. Use svelte for for the app logic.
We can try functions in rust to do even midi processing at native speed.
or we can use wasm library using rust <a href="https://developer.mozilla.org/en-US/docs/WebAssembly/Rust_to_wasm">https://developer.mozilla.org/en-US/docs/WebAssembly/Rust_to_wasm</a>. Although I cant really see much of a benefit with wasm over native rust function in tauri for all practical uses. We can use plain javascript for all the processing if we really need
in browser processing.</p>
<p>The plan is to convert the midi structure to json and send to browser and then convert back to midi
before saving.</p>
<h2 id="rust-based-daw"><a class="header" href="#rust-based-daw">rust based DAW</a></h2>
<p>This is an interesting possibility, may be a tauri based user interface and backend in rust.
We can probably utilize a pure rust cross platform audio library,</p>
<ul>
<li><a href="https://github.com/RustAudio/cpal">https://github.com/RustAudio/cpal</a></li>
<li><a href="https://github.com/MeadowlarkDAW/Meadowlark">https://github.com/MeadowlarkDAW/Meadowlark</a></li>
<li><a href="https://youtu.be/Z4P5f6ZJ_nE">https://youtu.be/Z4P5f6ZJ_nE</a></li>
<li><a href="https://youtu.be/Yom9E-67bdI">https://youtu.be/Yom9E-67bdI</a></li>
<li><a href="https://github.com/SolarLiner/nih-reverb">https://github.com/SolarLiner/nih-reverb</a></li>
<li><a href="https://github.com/vizia/vizia">https://github.com/vizia/vizia</a> for gui</li>
<li><a href="https://github.com/Auritia/Auritia">https://github.com/Auritia/Auritia</a></li>
<li><a href="https://npm.io/package/svelte-tauri-filedrop">https://npm.io/package/svelte-tauri-filedrop</a> This will allow file drop in on DAW</li>
<li><a href="https://github.com/emilyskidsister/oxygen">https://github.com/emilyskidsister/oxygen</a> audio recording and playback using cpal</li>
</ul>
<h2 id="audio-and-vst3-with-rust"><a class="header" href="#audio-and-vst3-with-rust">audio and vst3 with rust</a></h2>
<ul>
<li><a href="https://github.com/RustAudio/vst3-sys">https://github.com/RustAudio/vst3-sys</a></li>
<li><a href="https://github.com/t-sin/rust-vst3-example">https://github.com/t-sin/rust-vst3-example</a></li>
</ul>
<h2 id="open-source-plugins"><a class="header" href="#open-source-plugins">open source plugins</a></h2>
<ul>
<li><a href="https://github.com/TheWaveWarden/odin2">https://github.com/TheWaveWarden/odin2</a></li>
<li><a href="https://github.com/surge-synthesizer/surge">https://github.com/surge-synthesizer/surge</a></li>
<li><a href="https://github.com/zynaddsubfx/zynaddsubfx">https://github.com/zynaddsubfx/zynaddsubfx</a></li>
<li><a href="https://github.com/surge-synthesizer/stochas">https://github.com/surge-synthesizer/stochas</a></li>
<li><a href="https://github.com/trummerschlunk/master_me">https://github.com/trummerschlunk/master_me</a> for mastering</li>
</ul>
<h2 id="karaoke"><a class="header" href="#karaoke">karaoke</a></h2>
<ul>
<li><a href="https://github.com/gyunaev/spivak">https://github.com/gyunaev/spivak</a></li>
<li><a href="https://github.com/magic-akari/lrc-maker">https://github.com/magic-akari/lrc-maker</a> it also is a player react app.</li>
<li><a href="https://github.com/outloudvi/lrcedit.js">https://github.com/outloudvi/lrcedit.js</a> a simple example using
web audio api for lrc edit</li>
</ul>
<h2 id="rust-soundfont-and-synthesis"><a class="header" href="#rust-soundfont-and-synthesis">rust soundfont and synthesis</a></h2>
<ul>
<li><a href="https://github.com/sinshu/rustysynth">https://github.com/sinshu/rustysynth</a></li>
<li><a href="https://github.com/PolyMeilex/OxiSynth">https://github.com/PolyMeilex/OxiSynth</a> fluidsynth in rust</li>
<li><a href="https://github.com/ameobea/web-synth">https://github.com/ameobea/web-synth</a> fm synthesis</li>
<li><a href="https://www.youtube.com/watch?v=v0Qp7eWVyes">https://www.youtube.com/watch?v=v0Qp7eWVyes</a> wavetable synthesis</li>
<li><a href="https://rustrepo.com/repo/geom3trik-tuix_audio_synth">https://rustrepo.com/repo/geom3trik-tuix_audio_synth</a></li>
<li><a href="https://github.com/geom3trik/vizia-audio-synth">https://github.com/geom3trik/vizia-audio-synth</a></li>
</ul>
<h2 id="rust-libraries-1"><a class="header" href="#rust-libraries-1">rust libraries</a></h2>
<ul>
<li><a href="https://github.com/RazrFalcon/resvg">https://github.com/RazrFalcon/resvg</a> svg rendering</li>
<li><a href="https://github.com/servo/servo">https://github.com/servo/servo</a> browser</li>
</ul>
<h2 id="yamaha-style-file"><a class="header" href="#yamaha-style-file">yamaha style file</a></h2>
<ul>
<li><a href="topics/../files/StyleFileDescription_v21.pdf">Style file specification (archived)</a></li>
<li><a href="https://github.com/bures/sff2-tools">https://github.com/bures/sff2-tools</a></li>
<li><a href="https://wierzba.homepage.t-online.de/StyleFileDescription_v21.pdf">https://wierzba.homepage.t-online.de/StyleFileDescription_v21.pdf</a></li>
<li><a href="https://www.jjazzlab.com/en/">https://www.jjazzlab.com/en/</a></li>
<li><a href="https://psrtutorial.com/index.html">https://psrtutorial.com/index.html</a></li>
<li><a href="https://youtu.be/be_0JnhI-Wc">https://youtu.be/be_0JnhI-Wc</a></li>
<li><a href="https://youtu.be/gEGd__2ZQc0">https://youtu.be/gEGd__2ZQc0</a></li>
</ul>
<h2 id="python-libraries"><a class="header" href="#python-libraries">python libraries</a></h2>
<ul>
<li>style (sff2) files api <a href="https://github.com/bures/sff2-tools">https://github.com/bures/sff2-tools</a></li>
<li><a href="https://github.com/bspaans/python-mingus">https://github.com/bspaans/python-mingus</a></li>
<li>SCAMP <a href="https://pypi.org/project/scamp/">https://pypi.org/project/scamp/</a>. doc <a href="http://scamp.marcevanstein.com/">http://scamp.marcevanstein.com/</a></li>
</ul>
<h2 id="ai-datasets"><a class="header" href="#ai-datasets">AI datasets</a></h2>
<ul>
<li><a href="https://github.com/bytedance/GiantMIDI-Piano">https://github.com/bytedance/GiantMIDI-Piano</a></li>
</ul>
<h2 id="tool-for-representing-music-for-ai"><a class="header" href="#tool-for-representing-music-for-ai">tool for representing music for AI</a></h2>
<ul>
<li><a href="https://github.com/CPJKU/partitura">https://github.com/CPJKU/partitura</a></li>
</ul>
<h2 id="rust-audio-player"><a class="header" href="#rust-audio-player">Rust Audio player</a></h2>
<ul>
<li><a href="https://github.com/pdeljanov/Symphonia">https://github.com/pdeljanov/Symphonia</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="converting-old-dvdscd-into-mp4mp3"><a class="header" href="#converting-old-dvdscd-into-mp4mp3">Converting old DVDs/cd into mp4/mp3</a></h1>
<h1 id="dvds"><a class="header" href="#dvds">DVDs</a></h1>
<p>Old DVDs take space and bulky. I have tons of those that I accumulated over the years and running out of space in my cabinet. This will be an ongoing project for me to turn them into mp4 so that I can store them in a hard drive and view them from my TV.</p>
<p>You will need first install the following software before ripping a DVD:</p>
<ul>
<li><a href="https://handbrake.fr/">Handbrake</a></li>
<li><a href="https://www.lifewire.com/manage-fonts-in-linux-4176886">Ubuntu Restricted Extras</a></li>
<li>Libdvd-pkg</li>
</ul>
<p>You can find Handbrake in the default Ubuntu repositories, but there's a decent chance that the package will be fairly outdated. Thankfully, the Handbrake developers maintain an <a href="https://www.lifewire.com/updated-software-for-ubuntu-with-ppas-2202103">official Ubuntu PPA</a>.</p>
<p>Begin by opening a terminal window and typing the following command to add the PPA to your system.</p>
<pre><code class="language-bash">sudo add-apt-repository ppa:stebbins/handbrake-releases
</code></pre>
<p>Now, update your package database, and install Handbrake.</p>
<pre><code class="language-bash">sudo apt update
sudo apt install handbrake-gtk
</code></pre>
<p>This will install the video decoding software for converting DVDs to MP4.</p>
<p>Next, type the following command at the terminal prompt to install the restricted extras package. This will install a collection of codecs:</p>
<pre><code class="language-bash">sudo apt install ubuntu-restricted-extras
</code></pre>
<p>During the installation, a blue screen will appear with a license agreement. Press Tab to highlight the option to accept the agreement, and press Enter.</p>
<p>Finally, install the libdvd-pkg to install a library that will let you play DVDs within Ubuntu by entering the following command:</p>
<pre><code class="language-bash">sudo apt install libdvd-pkg
</code></pre>
<p>At the end of the process, you may get a message saying you need to run another apt-get command to continue installing the package. If you get this message, type the following command:</p>
<pre><code class="language-bash">sudo dpkg-reconfigure libdvd-pkg
</code></pre>
<h2 id="converting-to-iso-first-and-then-use-handbrake"><a class="header" href="#converting-to-iso-first-and-then-use-handbrake">converting to ISO first and then use handbrake</a></h2>
<p>The old linux machine which has a DVD drive is slow. My other machine is fast but there is no DVD drive. So I decided to rip the DVDs to ISO image first and then use the faster machine to turn into mp4.</p>
<p>Create an ISO disk image from a CD-ROM, DVD or Blu-ray disk.
First get block count. I am using <code>/dev/dvd</code>. In your machine it could be <code>/dev/sr0</code>. Make sure you are using the right device name for your machine.</p>
<pre><code class="language-bash">isosize -d 2048 /dev/dvd
</code></pre>
<p>Now run dd command and display progress bar while using dd command:</p>
<pre><code class="language-bash">$ sudo dd if=/dev/dvd of=output.iso bs=2048 count=&lt;blocks&gt; status=progress
</code></pre>
<p>Combining both in the same script,</p>
<pre><code class="language-bash">blocks=$(isosize -d 2048 /dev/dvd)
dd if=/dev/sr0 of=isoimage.iso bs=2048 count=$blocks status=progress
</code></pre>
<p>Now you can use output.iso for hard disk installation or as a backup copy of CD/DVD media. Please note that dd command is standard UNIX command and you should able to create backup/iso image under any UNIX like operating system.</p>
<p>FYI, you can restore hard disk drive from a previously generated ISO image using the dd command itself using,</p>
<pre><code class="language-bash">$ sudo dd if=output.iso of=/dev/dvd bs=4096 conv=noerror
</code></pre>
<h2 id="windows-platform-dvd-decoding-in-handbrake"><a class="header" href="#windows-platform-dvd-decoding-in-handbrake">Windows platform DVD decoding in Handbrake</a></h2>
<p>Windows distribution lacks video decoder for some DVDs. You will see choppy output in such case. Download <a href="http://download.videolan.org/pub/libdvdcss/1.2.12/">libdvdcss-2.dll file from VLC</a> and copy into HandBrake directory. It should resolve the decoder issue.</p>
<blockquote>
<p>I got these instructions from following sources. Read for more details.</p>
<ul>
<li><a href="https://www.lifewire.com/how-to-use-ubuntu-to-convert-dvds-to-mp4-4111375">how-to-use-ubuntu-to-convert-dvds-to-mp4</a>.</li>
<li><a href="https://www.cyberciti.biz/tips/linux-creating-cd-rom-iso-image.html">linux-creating-cd-rom-iso-image</a>.</li>
<li><a href="https://en.wikipedia.org/wiki/Dd_(Unix)">wikipedia dd</a>.</li>
</ul>
</blockquote>
<h1 id="audio-cds"><a class="header" href="#audio-cds">Audio CDs</a></h1>
<p>This <a href="https://www.cyberciti.biz/faq/linux-ripping-and-encoding-audio-files/">recipe</a> worked pretty good.
install <code>cdparanoia</code> and <code>lame</code></p>
<pre><code class="language-bash">cdparanoia -vsQ
</code></pre>
<p>lists all the tracks.</p>
<pre><code class="language-bash">cdparanoia -B
</code></pre>
<p>converts all the tracks in <code>.wav</code> format. If the CD has bad tracks and you don't want those tracks then <code>-X</code>
option will not output those tracks.</p>
<pre><code class="language-bash">cdparanoia -BX
</code></pre>
<p>Following python snippet will convert all the files tp mp3 using <code>lame</code>.</p>
<pre><code class="language-python">#!/usr/bin/env python3
import os
from pathlib import Path

for path in Path('.').rglob('*.wav'):
    newpath = path.with_name(path.stem.replace(' ', '-') +'.mp3')
    cmd = "lame -V2 '{0}' '{1}';rm '{0}';".format(str(path), str(newpath))
    print(cmd)
    returned_value = os.system(cmd)
    print(returned_value)
    
</code></pre>
<h2 id="concat-ts-files"><a class="header" href="#concat-ts-files">concat ts files</a></h2>
<pre><code>C:\ffmpeg\bin\ffmpeg.exe -f concat -safe 0 -i mylist.txt -c copy xyz.mp4
</code></pre>
<p>mylist.txt file (UTF-8),</p>
<pre><code>file 'abc.ts'
file 'def.ts'
...
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="text-to-speech"><a class="header" href="#text-to-speech">Text to Speech</a></h1>
<h2 id="common-models"><a class="header" href="#common-models">Common models</a></h2>
<p>Theses are all based on common models and forked from each other.</p>
<ul>
<li><a href="https://github.com/coqui-ai/TTS">https://github.com/coqui-ai/TTS</a>  Has low end, Sounds good for theatrical use. Based on following two.</li>
<li><a href="https://github.com/mozilla/TTS">https://github.com/mozilla/TTS</a>    Nice, lacks low end. Sounds natural for musical use.</li>
<li><a href="https://github.com/erogol/WaveRNN">https://github.com/erogol/WaveRNN</a></li>
<li><a href="https://github.com/rhasspy/piper">https://github.com/rhasspy/piper</a></li>
</ul>
<p>I used coqui tts in colab and tried different models and vocoder combinations they have and produced
a zip file consisting of all the audio clips it produced. You can obtain the zip file
<a href="topics/../files/tts_gen.zip">here</a>, if you are interested to take a listen to the audio clips.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
